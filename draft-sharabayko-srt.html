<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The SRT Protocol</title>
<meta content="Maxim Sharabayko" name="author">
<meta content="Maria Sharabayko" name="author">
<meta content="Jean Dube" name="author">
<meta content="Jeongseok Kim" name="author">
<meta content="Joonwoong Kim" name="author">
<meta content="
       This document specifies Secure Reliable Transport (SRT) protocol.
SRT is a user-level protocol over User Datagram Protocol and provides
reliability and security optimized for low latency live video streaming,
as well as generic bulk data transfer. For this, SRT introduces control
packet extension, improved flow control, enhanced congestion control
and a mechanism for data encryption. 
    " name="description">
<meta content="xml2rfc 3.18.2" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-sharabayko-srt-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.11.6
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.1.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.12
-->
<link href="draft-sharabayko-srt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SRT</td>
<td class="right">December 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Sharabayko, et al.</td>
<td class="center">Expires 14 June 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-sharabayko-srt-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-12-12" class="published">12 December 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-06-14">14 June 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. P. Sharabayko</div>
<div class="org">Haivision Network Video, GmbH</div>
</div>
<div class="author">
      <div class="author-name">M. A. Sharabayko</div>
<div class="org">Haivision Network Video, GmbH</div>
</div>
<div class="author">
      <div class="author-name">J. Dube</div>
<div class="org">Haivision Systems, Inc.</div>
</div>
<div class="author">
      <div class="author-name">JS Kim</div>
<div class="org">SK Telecom Co., Ltd.</div>
</div>
<div class="author">
      <div class="author-name">JW Kim</div>
<div class="org">SK Telecom Co., Ltd.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The SRT Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies Secure Reliable Transport (SRT) protocol.
SRT is a user-level protocol over User Datagram Protocol and provides
reliability and security optimized for low latency live video streaming,
as well as generic bulk data transfer. For this, SRT introduces control
packet extension, improved flow control, enhanced congestion control
and a mechanism for data encryption.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/haivision/srt-rfc">https://github.com/haivision/srt-rfc</a>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 14 June 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-motivation" class="internal xref">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-secure-reliable-transport-p" class="internal xref">Secure Reliable Transport Protocol</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terms-and-definitions" class="internal xref">Terms and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-packet-structure" class="internal xref">Packet Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-data-packets" class="internal xref">Data Packets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-control-packets" class="internal xref">Control Packets</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-handshake" class="internal xref">Handshake</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-key-material" class="internal xref">Key Material</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-keep-alive" class="internal xref">Keep-Alive</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="auto internal xref">3.2.4</a>.  <a href="#name-ack-acknowledgment" class="internal xref">ACK (Acknowledgment)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#section-3.2.5" class="auto internal xref">3.2.5</a>.  <a href="#name-nak-negative-acknowledgemen" class="internal xref">NAK (Negative Acknowledgement or Loss Report)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.6">
                    <p id="section-toc.1-1.3.2.2.2.6.1"><a href="#section-3.2.6" class="auto internal xref">3.2.6</a>.  <a href="#name-congestion-warning" class="internal xref">Congestion Warning</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.7">
                    <p id="section-toc.1-1.3.2.2.2.7.1"><a href="#section-3.2.7" class="auto internal xref">3.2.7</a>.  <a href="#name-shutdown" class="internal xref">Shutdown</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.8">
                    <p id="section-toc.1-1.3.2.2.2.8.1"><a href="#section-3.2.8" class="auto internal xref">3.2.8</a>.  <a href="#name-ackack-acknowledgement-of-a" class="internal xref">ACKACK (Acknowledgement of Acknowledgement)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.9">
                    <p id="section-toc.1-1.3.2.2.2.9.1"><a href="#section-3.2.9" class="auto internal xref">3.2.9</a>.  <a href="#name-message-drop-request" class="internal xref">Message Drop Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.10">
                    <p id="section-toc.1-1.3.2.2.2.10.1"><a href="#section-3.2.10" class="auto internal xref">3.2.10</a>. <a href="#name-peer-error" class="internal xref">Peer Error</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-srt-data-transmission-and-c" class="internal xref">SRT Data Transmission and Control</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-stream-multiplexing" class="internal xref">Stream Multiplexing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-data-transmission-modes" class="internal xref">Data Transmission Modes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-message-mode" class="internal xref">Message Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-buffer-mode" class="internal xref">Buffer Mode</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-handshake-messages" class="internal xref">Handshake Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-caller-listener-handshake" class="internal xref">Caller-Listener Handshake</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-rendezvous-handshake" class="internal xref">Rendezvous Handshake</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-srt-buffer-latency" class="internal xref">SRT Buffer Latency</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-timestamp-based-packet-deli" class="internal xref">Timestamp-Based Packet Delivery</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-packet-delivery-time" class="internal xref">Packet Delivery Time</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-too-late-packet-drop" class="internal xref">Too-Late Packet Drop</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-drift-management" class="internal xref">Drift Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-acknowledgement-and-lost-pa" class="internal xref">Acknowledgement and Lost Packet Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.1">
                    <p id="section-toc.1-1.4.2.8.2.1.1"><a href="#section-4.8.1" class="auto internal xref">4.8.1</a>.  <a href="#name-packet-acknowledgement-acks" class="internal xref">Packet Acknowledgement (ACKs, ACKACKs)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.2">
                    <p id="section-toc.1-1.4.2.8.2.2.1"><a href="#section-4.8.2" class="auto internal xref">4.8.2</a>.  <a href="#name-packet-retransmission-naks" class="internal xref">Packet Retransmission (NAKs)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="auto internal xref">4.9</a>.  <a href="#name-bidirectional-transmission-" class="internal xref">Bidirectional Transmission Queues</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="auto internal xref">4.10</a>. <a href="#name-round-trip-time-estimation" class="internal xref">Round-Trip Time Estimation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-srt-packet-pacing-and-conge" class="internal xref">SRT Packet Pacing and Congestion Control</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-srt-packet-pacing-and-live-" class="internal xref">SRT Packet Pacing and Live Congestion Control (LiveCC)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-configuring-maximum-bandwid" class="internal xref">Configuring Maximum Bandwidth</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-srts-default-livecc-algorit" class="internal xref">SRT's Default LiveCC Algorithm</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-file-transfer-congestion-co" class="internal xref">File Transfer Congestion Control (FileCC)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-srts-default-filecc-algorit" class="internal xref">SRT's Default FileCC Algorithm</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-encryption" class="internal xref">Encryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-encryption-scope" class="internal xref">Encryption Scope</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-aes-counter" class="internal xref">AES Counter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-stream-encrypting-key-sek" class="internal xref">Stream Encrypting Key (SEK)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4">
                    <p id="section-toc.1-1.6.2.1.2.4.1"><a href="#section-6.1.4" class="auto internal xref">6.1.4</a>.  <a href="#name-key-encrypting-key-kek" class="internal xref">Key Encrypting Key (KEK)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.5">
                    <p id="section-toc.1-1.6.2.1.2.5.1"><a href="#section-6.1.5" class="auto internal xref">6.1.5</a>.  <a href="#name-key-material-exchange" class="internal xref">Key Material Exchange</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.6">
                    <p id="section-toc.1-1.6.2.1.2.6.1"><a href="#section-6.1.6" class="auto internal xref">6.1.6</a>.  <a href="#name-km-refresh" class="internal xref">KM Refresh</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-encryption-process" class="internal xref">Encryption Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-generating-the-stream-encry" class="internal xref">Generating the Stream Encrypting Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-encrypting-the-payload" class="internal xref">Encrypting the Payload</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-decryption-process" class="internal xref">Decryption Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-restoring-the-stream-encryp" class="internal xref">Restoring the Stream Encrypting Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="auto internal xref">6.3.2</a>.  <a href="#name-decrypting-the-payload" class="internal xref">Decrypting the Payload</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-best-practices-and-configur" class="internal xref">Best Practices and Configuration Tips for Data Transmission via SRT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-live-streaming" class="internal xref">Live Streaming</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-file-transmission" class="internal xref">File Transmission</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-file-transmission-in-buffer" class="internal xref">File Transmission in Buffer Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-file-transmission-in-messag" class="internal xref">File Transmission in Message Mode</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref"></a><a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-packet-sequence-list-coding" class="internal xref">Packet Sequence List Coding</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-srt-access-control" class="internal xref">SRT Access Control</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-general-syntax" class="internal xref">General Syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-standard-keys" class="internal xref">Standard Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-changelog" class="internal xref">Changelog</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-since-draft-sharabayko-mops" class="internal xref">Since draft-sharabayko-mops-srt-00</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-since-draft-sharabayko-mops-" class="internal xref">Since draft-sharabayko-mops-srt-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-since-draft-sharabayko-srt-" class="internal xref">Since draft-sharabayko-srt-00</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-since-draft-sharabayko-srt-0" class="internal xref">Since draft-sharabayko-srt-01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="motivation">
<section id="section-1.1">
        <h3 id="name-motivation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-1.1-1">The demand for live video streaming has been increasing steadily for many years. With
the emergence of cloud technologies, many video processing pipeline components have
transitioned from on-premises appliances to software running on cloud instances. While
real-time streaming over TCP-based protocols like RTMP <span>[<a href="#RTMP" class="cite xref">RTMP</a>]</span> is possible at low bitrates and
on a small scale, the exponential growth of the streaming market has created a need for
more powerful solutions.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">To improve scalability on the delivery side, content delivery networks (CDNs) at one
point transitioned to segmentation-based technologies like HLS (HTTP Live Streaming) <span>[<a href="#RFC8216" class="cite xref">RFC8216</a>]</span>
and DASH (Dynamic Adaptive Streaming over HTTP) <span>[<a href="#ISO23009" class="cite xref">ISO23009</a>]</span>. This move increased the end-to-end
latency of live streaming to over few tens of seconds, which makes it unattractive for specific
use cases where real-time is important. Over time, the industry optimized these delivery methods, bringing the
latency down to few seconds.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">While the delivery side scaled up, improvements to video transcoding became a necessity.
Viewers watch video streams on a variety of different devices, connected over different
types of networks. Since upload bandwidth from on-premises locations is often limited,
video transcoding moved to the cloud.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">RTMP became the de facto standard for contribution over the public Internet. But there
are limitations for the payload to be transmitted, since RTMP as a media specific
protocol only supports two audio channels and a restricted set of audio and video codecs,
lacking support for newer formats such as HEVC <span>[<a href="#H.265" class="cite xref">H.265</a>]</span>,
VP9 <span>[<a href="#VP9" class="cite xref">VP9</a>]</span>, or AV1 <span>[<a href="#AV1" class="cite xref">AV1</a>]</span>.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">Since RTMP, HLS and DASH rely on TCP, these protocols can only guarantee acceptable
reliability over connections with low RTTs, and can not use the bandwidth of network
connections to their full extent due to limitations imposed by congestion control.
Notably, QUIC <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span> has been designed to address these problems with HTTP-based delivery
protocols in HTTP/3 <span>[<a href="#RFC9114" class="cite xref">RFC9114</a>]</span>. Like QUIC, SRT <span>[<a href="#SRTSRC" class="cite xref">SRTSRC</a>]</span> uses UDP instead of the TCP transport protocol,
but assures more reliable delivery using Automatic Repeat Request (ARQ), packet acknowledgments,
end-to-end latency management, etc.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secure-reliable-transport-protocol">
<section id="section-1.2">
        <h3 id="name-secure-reliable-transport-p">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-secure-reliable-transport-p" class="section-name selfRef">Secure Reliable Transport Protocol</a>
        </h3>
<p id="section-1.2-1">Low latency video transmissions across reliable (usually local) IP based networks
typically take the form of MPEG-TS <span>[<a href="#ISO13818-1" class="cite xref">ISO13818-1</a>]</span> unicast or multicast streams using the UDP/RTP
protocol, where any packet loss can be mitigated by enabling forward error correction
(FEC). Achieving the same low latency between sites in different cities, countries or
even continents is more challenging. While it is possible with satellite links or
dedicated MPLS <span>[<a href="#RFC3031" class="cite xref">RFC3031</a>]</span> networks, these are expensive solutions. The use of public Internet
connectivity, while less expensive, imposes significant bandwidth overhead to achieve
the necessary level of packet loss recovery. Introducing selective packet retransmission
(reliable UDP) to recover from packet loss removes those limitations.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Derived from the UDP-based Data Transfer (UDT) protocol <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span>, SRT is a user-level protocol
that retains most of the core concepts and mechanisms while introducing several
refinements and enhancements, including control packet modifications, improved flow
control for handling live streaming, enhanced congestion control, and a mechanism for
encrypting packets.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">SRT is a transport protocol that enables the secure, reliable transport of data across
unpredictable networks, such as the Internet. While any data type can be transferred
via SRT, it is ideal for low latency (sub-second) video streaming. SRT provides
improved bandwidth utilization compared to RTMP, allowing much higher
contribution bitrates over long distance connections.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">As packets are streamed from source to destination, SRT detects and adapts to the
real-time network conditions between the two endpoints, and helps compensate for
jitter and bandwidth fluctuations due to congestion over noisy networks. Its error
recovery mechanism minimizes the packet loss typical of Internet connections.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">To achieve low latency streaming, SRT had to address timing issues. The characteristics
of a stream from a source network are completely changed by transmission over the public
Internet, which introduces delays, jitter, and packet loss. This, in turn, leads to
problems with decoding, as the audio and video decoders do not receive packets at the
expected times. The use of large buffers helps, but latency is increased.
SRT includes a mechanism to keep a constant end-to-end latency, thus recreating
the signal characteristics on the receiver side, and reducing the need for buffering.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">Like TCP, SRT employs a listener/caller model. The data flow is bi-directional and
independent of the connection initiation - either the sender or receiver can operate
as listener or caller to initiate a connection. The protocol provides an internal
multiplexing mechanism, allowing multiple SRT connections to share the same UDP port,
providing access control functionality to identify the caller on the listener side.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<p id="section-1.2-7">Supporting forward error correction (FEC) and selective packet retransmission (ARQ),
SRT provides the flexibility to use either of the two mechanisms or both combined,
allowing for use cases ranging from the lowest possible latency to the highest possible
reliability.<a href="#section-1.2-7" class="pilcrow">¶</a></p>
<p id="section-1.2-8">SRT maintains the ability for fast file transfers introduced in UDT, and adds support
for AES encryption.<a href="#section-1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terms-and-definitions">
<section id="section-2">
      <h2 id="name-terms-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terms-and-definitions" class="section-name selfRef">Terms and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">SRT:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.2">
          <p id="section-2-2.2.1">The Secure Reliable Transport protocol described by this document.<a href="#section-2-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">PRNG:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.4">
          <p id="section-2-2.4.1">Pseudo-Random Number Generator.<a href="#section-2-2.4.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="packet-structure">
<section id="section-3">
      <h2 id="name-packet-structure">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-packet-structure" class="section-name selfRef">Packet Structure</a>
      </h2>
<p id="section-3-1">SRT packets are transmitted as UDP payload <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>. Every UDP packet carrying SRT
traffic contains an SRT header immediately after the UDP header (<a href="#srt-in-udp" class="auto internal xref">Figure 1</a>).<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-srt-packet-as-udp-payload"></span><div id="srt-in-udp">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-3-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            SrcPort            |            DstPort            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              Len              |            ChkSum             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                          SRT Packet                           +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-srt-packet-as-udp-payload" class="selfRef">SRT packet as UDP payload</a>
        </figcaption></figure>
</div>
<p id="section-3-3">SRT has two types of packets distinguished by the Packet Type Flag:
data packet and control packet.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The structure of the SRT packet is shown in <a href="#srtpacket" class="auto internal xref">Figure 2</a>.<a href="#section-3-4" class="pilcrow">¶</a></p>
<span id="name-srt-packet-structure"></span><div id="srtpacket">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-3-5.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|F|        (Field meaning depends on the packet type)           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          (Field meaning depends on the packet type)           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Destination SRT Socket ID                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                        Packet Contents                        |
|                  (depends on the packet type)                 +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-srt-packet-structure" class="selfRef">SRT packet structure</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3-6">
        <dt id="section-3-6.1">F: 1 bit.</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.2">
          <p id="section-3-6.2.1">Packet Type Flag. The control packet has this flag set to "1".
The data packet has this flag set to "0".<a href="#section-3-6.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.3">Timestamp: 32 bits.</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.4">
          <p id="section-3-6.4.1">The timestamp of the packet, in microseconds.
The value is relative to the time the SRT connection was established.
Depending on the transmission mode (<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>),
the field stores the packet send time or the packet origin time.<a href="#section-3-6.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.5">Destination SRT Socket ID: 32 bits.</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.6">
          <p id="section-3-6.6.1">A fixed-width field providing the SRT socket ID to which a packet should be dispatched.
The field may have the special value "0" when the packet is a connection request.<a href="#section-3-6.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<div id="data-pkt">
<section id="section-3.1">
        <h3 id="name-data-packets">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-data-packets" class="section-name selfRef">Data Packets</a>
        </h3>
<p id="section-3.1-1">The structure of the SRT data packet is shown in <a href="#srtdatapacket" class="auto internal xref">Figure 3</a>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span id="name-data-packet-structure"></span><div id="srtdatapacket">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.1-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                    Packet Sequence Number                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|P P|O|K K|R|                   Message Number                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Destination SRT Socket ID                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                            Payload                            +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Authentication Tag                      |
|                        (GCM: 16 bytes)                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-data-packet-structure" class="selfRef">Data packet structure</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.1-3">
          <dt id="section-3.1-3.1">Packet Sequence Number: 31 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.2">
            <p id="section-3.1-3.2.1">The sequential number of the data packet. Range [0; 2^31 - 1].<a href="#section-3.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.3">PP: 2 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.4">
            <p id="section-3.1-3.4.1">Packet Position Flag. This field indicates the position of the data packet in the message.
The value "10b" (binary) means the first packet of the message. "00b" indicates a packet
in the middle. "01b" designates the last packet. If a single data packet forms the whole
message, the value is "11b".<a href="#section-3.1-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.5">O: 1 bit.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.6">
            <p id="section-3.1-3.6.1">Order Flag. Indicates whether the message should be delivered by the receiver in order (1)
or not (0). Certain restrictions apply depending on the data transmission mode used
(<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>).<a href="#section-3.1-3.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.7">KK: 2 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.8">
            <p id="section-3.1-3.8.1">Key-based Encryption Flag. The flag bits indicate whether or not data is encrypted.
The value "00b" (binary) means data is not encrypted. "01b" indicates that data is
encrypted with an even key, and "10b" is used for odd key encryption. Refer to <a href="#encryption" class="auto internal xref">Section 6</a>.
The value "11b" is only used in control packets.<a href="#section-3.1-3.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.9">R: 1 bit.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.10">
            <p id="section-3.1-3.10.1">Retransmitted Packet Flag. This flag is clear when a packet is transmitted the first time.
The flag is set to "1" when a packet is retransmitted.<a href="#section-3.1-3.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.11">Message Number: 26 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.12">
            <p id="section-3.1-3.12.1">The sequential number of consecutive data packets that form a message (see PP field).<a href="#section-3.1-3.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.13">Timestamp: 32 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.14">
            <p id="section-3.1-3.14.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.1-3.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.15">Destination SRT Socket ID: 32 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.16">
            <p id="section-3.1-3.16.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.1-3.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.17">Payload: variable length.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.18">
            <p id="section-3.1-3.18.1">The payload of the data packet. The length of the data is the remaining length of
the UDP packet.<a href="#section-3.1-3.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.19">Authentication Tag: optional, 128 bits in case of AES-GCM.</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.20">
            <p id="section-3.1-3.20.1">The message authentication tag (AES-GCM). The field is only present if AES-GCM crypto mode has been negotiated.<a href="#section-3.1-3.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="control-packets">
<section id="section-3.2">
        <h3 id="name-control-packets">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-control-packets" class="section-name selfRef">Control Packets</a>
        </h3>
<p id="section-3.2-1">An SRT control packet has the following structure.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-control-packet-structure"></span><div id="controlpacket">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.2-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|         Control Type        |            Subtype            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Destination SRT Socket ID                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- CIF -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                   Control Information Field                   +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-control-packet-structure" class="selfRef">Control packet structure</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2-3">
          <dt id="section-3.2-3.1">Control Type: 15 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">Control Packet Type. The use of these bits is determined
by the control packet type definition. See <a href="#srt-ctrl-pkt-type-table" class="auto internal xref">Table 1</a>.<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.3">Subtype: 16 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.4">
            <p id="section-3.2-3.4.1">This field specifies an additional subtype for specific packets.
See <a href="#srt-ctrl-pkt-type-table" class="auto internal xref">Table 1</a>.<a href="#section-3.2-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.5">Type-specific Information: 32 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.6">
            <p id="section-3.2-3.6.1">The use of this field depends on the particular control
packet type. Handshake packets do not use this field.<a href="#section-3.2-3.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.7">Timestamp: 32 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.8">
            <p id="section-3.2-3.8.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2-3.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.9">Destination SRT Socket ID: 32 bits.</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.10">
            <p id="section-3.2-3.10.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2-3.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.11">Control Information Field (CIF): variable length.</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.12">
            <p id="section-3.2-3.12.1">The use of this field is defined by the Control Type field of the control packet.<a href="#section-3.2-3.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-4">The types of SRT control packets are shown in <a href="#srt-ctrl-pkt-type-table" class="auto internal xref">Table 1</a>.
The value "0x7FFF" is reserved for a user-defined type.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<span id="name-srt-control-packet-types"></span><div id="srt-ctrl-pkt-type-table">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-srt-control-packet-types" class="selfRef">SRT control packet types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Packet Type</th>
              <th class="text-center" rowspan="1" colspan="1">Control Type</th>
              <th class="text-center" rowspan="1" colspan="1">Subtype</th>
              <th class="text-left" rowspan="1" colspan="1">Section</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">HANDSHAKE</td>
              <td class="text-center" rowspan="1" colspan="1">0x0000</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-handshake" class="auto internal xref">Section 3.2.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">KEEPALIVE</td>
              <td class="text-center" rowspan="1" colspan="1">0x0001</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-keepalive" class="auto internal xref">Section 3.2.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACK</td>
              <td class="text-center" rowspan="1" colspan="1">0x0002</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-ack" class="auto internal xref">Section 3.2.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NAK (Loss Report)</td>
              <td class="text-center" rowspan="1" colspan="1">0x0003</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-nak" class="auto internal xref">Section 3.2.5</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Congestion Warning</td>
              <td class="text-center" rowspan="1" colspan="1">0x0004</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-congestion" class="auto internal xref">Section 3.2.6</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SHUTDOWN</td>
              <td class="text-center" rowspan="1" colspan="1">0x0005</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-shutdown" class="auto internal xref">Section 3.2.7</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACKACK</td>
              <td class="text-center" rowspan="1" colspan="1">0x0006</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-ackack" class="auto internal xref">Section 3.2.8</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">DROPREQ</td>
              <td class="text-center" rowspan="1" colspan="1">0x0007</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-dropreq" class="auto internal xref">Section 3.2.9</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">PEERERROR</td>
              <td class="text-center" rowspan="1" colspan="1">0x0008</td>
              <td class="text-center" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ctrl-pkt-peer-error" class="auto internal xref">Section 3.2.10</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">User-Defined Type</td>
              <td class="text-center" rowspan="1" colspan="1">0x7FFF</td>
              <td class="text-center" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="ctrl-pkt-handshake">
<section id="section-3.2.1">
          <h4 id="name-handshake">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-handshake" class="section-name selfRef">Handshake</a>
          </h4>
<p id="section-3.2.1-1">Handshake control packets (Control Type = 0x0000) are used to exchange peer configurations,
to agree on connection parameters, and to establish a connection.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">The Type-specific Information field is unused in the case of the HS message.
The Control Information Field (CIF) of a handshake control packet is shown
in <a href="#handshake-packet-structure" class="auto internal xref">Figure 5</a>.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<span id="name-handshake-packet-structure"></span><div id="handshake-packet-structure">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-3.2.1-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          HS Version                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Encryption Field       |        Extension Field        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|               Initial Packet Sequence Number                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Maximum Transmission Unit Size                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Maximum Flow Window Size                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Handshake Type                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         SRT Socket ID                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           SYN Cookie                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                        Peer IP Address                        +
|                                                               |
+                                                               +
|                                                               |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
|         Extension Type        |        Extension Length       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                       Extension Contents                      +
|                                                               |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-handshake-packet-structure" class="selfRef">Handshake packet structure</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-4">
            <dt id="section-3.2.1-4.1">HS Version: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-4.2">
              <p id="section-3.2.1-4.2.1">The handshake version number. Currently used values are 4 and 5.
Values greater than 5 are reserved for future use.<a href="#section-3.2.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-4.3">Encryption Field: 16 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-4.4">
              <p id="section-3.2.1-4.4.1">Block cipher family and key size. The values of this field are
described in <a href="#handshake-encr-fld" class="auto internal xref">Table 2</a>. The default value is 0 (no encryption advertised).
If neither peer advertises encryption, AES-128 is selected by default (see <a href="#handshake-messages" class="auto internal xref">Section 4.3</a>).<a href="#section-3.2.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-handshake-encryption-field-"></span><div id="handshake-encr-fld">
<table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-handshake-encryption-field-" class="selfRef">Handshake Encryption Field values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-center" rowspan="1" colspan="1">Cipher Family and Key Size</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-center" rowspan="1" colspan="1">No Encryption Advertised</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">AES-128 *</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-center" rowspan="1" colspan="1">AES-192</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-center" rowspan="1" colspan="1">AES-256</td>
              </tr>
            </tbody>
          </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-6">
            <dt id="section-3.2.1-6.1">Extension Field: 16 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-6.2">
              <p id="section-3.2.1-6.2.1">This field is message specific extension related to Handshake Type field.
The value MUST be set to 0 except for the following cases.<a href="#section-3.2.1-6.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-6.2.2">(1) If the handshake control packet is the INDUCTION message, this field is
sent back by the Listener.
(2) In the case of a CONCLUSION message, this field value should contain a combination
of Extension Type values.<a href="#section-3.2.1-6.2.2" class="pilcrow">¶</a></p>
<p id="section-3.2.1-6.2.3">For more details, see <a href="#caller-listener-handshake" class="auto internal xref">Section 4.3.1</a>.<a href="#section-3.2.1-6.2.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-handshake-extension-flags"></span><div id="hs-ext-flags">
<table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-handshake-extension-flags" class="selfRef">Handshake Extension Flags</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Bitmask</th>
                <th class="text-center" rowspan="1" colspan="1">Flag</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000001</td>
                <td class="text-center" rowspan="1" colspan="1">HSREQ</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000002</td>
                <td class="text-center" rowspan="1" colspan="1">KMREQ</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000004</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
              </tr>
            </tbody>
          </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-8">
            <dt id="section-3.2.1-8.1">Initial Packet Sequence Number: 31 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-8.2">
              <p id="section-3.2.1-8.2.1">The sequence number of the very first data packet to be sent.<a href="#section-3.2.1-8.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-8.3">Maximum Transmission Unit Size: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-8.4">
              <p id="section-3.2.1-8.4.1">Maximum Transmission Unit (MTU) size, in bytes. This value is typically set to 1500 bytes,
which is the default MTU size for Ethernet, but can be less.<a href="#section-3.2.1-8.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-8.5">Maximum Flow Window Size: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-8.6">
              <p id="section-3.2.1-8.6.1">The value of this field is the maximum number of data packets allowed to be "in flight"
(i.e. the number of sent packets for which an ACK control packet has not yet been received).<a href="#section-3.2.1-8.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-8.7">Handshake Type: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-8.8">
              <p id="section-3.2.1-8.8.1">This field indicates the handshake packet type.
The possible values are described in <a href="#handshake-type" class="auto internal xref">Table 4</a>.
For more details refer to <a href="#handshake-messages" class="auto internal xref">Section 4.3</a>.<a href="#section-3.2.1-8.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-handshake-type"></span><div id="handshake-type">
<table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-handshake-type" class="selfRef">Handshake Type</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-center" rowspan="1" colspan="1">Handshake Type</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0xFFFFFFFD</td>
                <td class="text-center" rowspan="1" colspan="1">DONE</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0xFFFFFFFE</td>
                <td class="text-center" rowspan="1" colspan="1">AGREEMENT</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0xFFFFFFFF</td>
                <td class="text-center" rowspan="1" colspan="1">CONCLUSION</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000000</td>
                <td class="text-center" rowspan="1" colspan="1">WAVEAHAND</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0x00000001</td>
                <td class="text-center" rowspan="1" colspan="1">INDUCTION</td>
              </tr>
            </tbody>
          </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-10">
            <dt id="section-3.2.1-10.1">SRT Socket ID: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-10.2">
              <p id="section-3.2.1-10.2.1">This field holds the ID of the source SRT socket from which a handshake packet is issued.<a href="#section-3.2.1-10.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-10.3">SYN Cookie: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-10.4">
              <p id="section-3.2.1-10.4.1">Randomized value for processing a handshake. The value of this field is specified
by the handshake message type. See <a href="#handshake-messages" class="auto internal xref">Section 4.3</a>.<a href="#section-3.2.1-10.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-10.5">Peer IP Address: 128 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-10.6">
              <p id="section-3.2.1-10.6.1">IPv4 or IPv6 address of the packet's sender. The value consists of four 32-bit fields.
In the case of IPv4 addresses, fields 2, 3 and 4 are filled with zeroes.<a href="#section-3.2.1-10.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-10.7">Extension Type: 16 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-10.8">
              <p id="section-3.2.1-10.8.1">The value of this field is used to process an integrated handshake.
Each extension can have a pair of request and response types.<a href="#section-3.2.1-10.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-handshake-extension-type-va"></span><div id="handshake-ext-type">
<table class="center" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-handshake-extension-type-va" class="selfRef">Handshake Extension Type values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-center" rowspan="1" colspan="1">Extension Type</th>
                <th class="text-center" rowspan="1" colspan="1">HS Extension Flag</th>
                <th class="text-left" rowspan="1" colspan="1">Section</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_HSREQ</td>
                <td class="text-center" rowspan="1" colspan="1">HSREQ</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#handshake-extension-msg" class="auto internal xref">Section 3.2.1.1</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_HSRSP</td>
                <td class="text-center" rowspan="1" colspan="1">HSREQ</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#handshake-extension-msg" class="auto internal xref">Section 3.2.1.1</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_KMREQ</td>
                <td class="text-center" rowspan="1" colspan="1">KMREQ</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#sec-hsext-km" class="auto internal xref">Section 3.2.1.2</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_KMRSP</td>
                <td class="text-center" rowspan="1" colspan="1">KMREQ</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#sec-hsext-km" class="auto internal xref">Section 3.2.1.2</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">5</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_SID</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#sec-hsext-streamid" class="auto internal xref">Section 3.2.1.3</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">6</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_CONGESTION</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#sec-hsext-streamid" class="auto internal xref">Section 3.2.1.3</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">7</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_FILTER</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">8</td>
                <td class="text-center" rowspan="1" colspan="1">SRT_CMD_GROUP</td>
                <td class="text-center" rowspan="1" colspan="1">CONFIG</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#sec-hsext-group" class="auto internal xref">Section 3.2.1.4</a>
</td>
              </tr>
            </tbody>
          </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-12">
            <dt id="section-3.2.1-12.1">Extension Length: 16 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-12.2">
              <p id="section-3.2.1-12.2.1">The length of the Extension Contents field in four-byte blocks.<a href="#section-3.2.1-12.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-12.3">Extension Contents: variable length.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-12.4">
              <p id="section-3.2.1-12.4.1">The payload of the extension.<a href="#section-3.2.1-12.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<div id="handshake-extension-msg">
<section id="section-3.2.1.1">
            <h5 id="name-handshake-extension-message">
<a href="#section-3.2.1.1" class="section-number selfRef">3.2.1.1. </a><a href="#name-handshake-extension-message" class="section-name selfRef">Handshake Extension Message</a>
            </h5>
<p id="section-3.2.1.1-1">In a Handshake Extension, the value of the Extension Field of the
handshake control packet is defined as 1 for a Handshake Extension request (SRT_CMD_HSREQ in <a href="#handshake-ext-type" class="auto internal xref">Table 5</a>),
and 2 for a Handshake Extension response (SRT_CMD_HSRSP in <a href="#handshake-ext-type" class="auto internal xref">Table 5</a>).<a href="#section-3.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-2">The Extension Contents field of a Handshake Extension Message is structured as follows:<a href="#section-3.2.1.1-2" class="pilcrow">¶</a></p>
<span id="name-handshake-extension-message-"></span><div id="handshake-extension-msg-structure">
<figure id="figure-6">
              <div class="alignLeft art-text artwork" id="section-3.2.1.1-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          SRT Version                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           SRT Flags                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Receiver TSBPD Delay     |       Sender TSBPD Delay      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-handshake-extension-message-" class="selfRef">Handshake Extension Message structure</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.1-4">
              <dt id="section-3.2.1.1-4.1">SRT Version: 32 bits.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.1-4.2">
                <p id="section-3.2.1.1-4.2.1">SRT library version MUST be formed as major * 0x10000 + minor * 0x100 + patch.<a href="#section-3.2.1.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.1-4.3">SRT Flags: 32 bits.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.1-4.4">
                <p id="section-3.2.1.1-4.4.1">SRT configuration flags (see <a href="#hs-ext-msg-flags" class="auto internal xref">Section 3.2.1.1.1</a>).<a href="#section-3.2.1.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.1-4.5">Receiver TSBPD Delay: 16 bits.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.1-4.6">
                <p id="section-3.2.1.1-4.6.1">Timestamp-Based Packet Delivery (TSBPD) Delay of the receiver, in milliseconds. Refer to <a href="#tsbpd" class="auto internal xref">Section 4.5</a>.<a href="#section-3.2.1.1-4.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.1-4.7">Sender TSBPD Delay: 16 bits.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.1-4.8">
                <p id="section-3.2.1.1-4.8.1">TSBPD of the sender, in milliseconds. Refer to <a href="#tsbpd" class="auto internal xref">Section 4.5</a>.<a href="#section-3.2.1.1-4.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<div id="hs-ext-msg-flags">
<section id="section-3.2.1.1.1">
              <h6 id="name-handshake-extension-message-f">
<a href="#section-3.2.1.1.1" class="section-number selfRef">3.2.1.1.1. </a><a href="#name-handshake-extension-message-f" class="section-name selfRef">Handshake Extension Message Flags</a>
              </h6>
<span id="name-handshake-extension-message-fl"></span><div id="hs-ext-msg-flags-tbl">
<table class="center" id="table-6">
                <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-handshake-extension-message-fl" class="selfRef">Handshake Extension Message Flags</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" rowspan="1" colspan="1">Bitmask</th>
                    <th class="text-center" rowspan="1" colspan="1">Flag</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000001</td>
                    <td class="text-center" rowspan="1" colspan="1">TSBPDSND</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000002</td>
                    <td class="text-center" rowspan="1" colspan="1">TSBPDRCV</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000004</td>
                    <td class="text-center" rowspan="1" colspan="1">CRYPT</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000008</td>
                    <td class="text-center" rowspan="1" colspan="1">TLPKTDROP</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000010</td>
                    <td class="text-center" rowspan="1" colspan="1">PERIODICNAK</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000020</td>
                    <td class="text-center" rowspan="1" colspan="1">REXMITFLG</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000040</td>
                    <td class="text-center" rowspan="1" colspan="1">STREAM</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0x00000080</td>
                    <td class="text-center" rowspan="1" colspan="1">PACKET_FILTER</td>
                  </tr>
                </tbody>
              </table>
</div>
<ul class="normal">
<li class="normal" id="section-3.2.1.1.1-2.1">
                  <p id="section-3.2.1.1.1-2.1.1">TSBPDSND flag defines if the TSBPD mechanism (<a href="#tsbpd" class="auto internal xref">Section 4.5</a>) will be used for sending.<a href="#section-3.2.1.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.2">
                  <p id="section-3.2.1.1.1-2.2.1">TSBPDRCV flag defines if the TSBPD mechanism (<a href="#tsbpd" class="auto internal xref">Section 4.5</a>) will be used for receiving.<a href="#section-3.2.1.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.3">
                  <p id="section-3.2.1.1.1-2.3.1">CRYPT flag MUST be set. It is a legacy flag that indicates the party understands
KK field of the SRT Packet (<a href="#srtdatapacket" class="auto internal xref">Figure 3</a>).<a href="#section-3.2.1.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.4">
                  <p id="section-3.2.1.1.1-2.4.1">TLPKTDROP flag should be set if too-late packet drop mechanism will be used during transmission.
See <a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a>.<a href="#section-3.2.1.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.5">
                  <p id="section-3.2.1.1.1-2.5.1">PERIODICNAK flag set indicates the peer will send periodic NAK packets. See <a href="#packet-naks" class="auto internal xref">Section 4.8.2</a>.<a href="#section-3.2.1.1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.6">
                  <p id="section-3.2.1.1.1-2.6.1">REXMITFLG flag MUST be set. It is a legacy flag that indicates the peer understands the R field
of the SRT DATA Packet (<a href="#srtdatapacket" class="auto internal xref">Figure 3</a>).<a href="#section-3.2.1.1.1-2.6.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.7">
                  <p id="section-3.2.1.1.1-2.7.1">STREAM flag identifies the transmission mode (<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>) to be used in the connection.
If the flag is set, the buffer mode (<a href="#transmission-mode-buffer" class="auto internal xref">Section 4.2.2</a>) is used.
Otherwise, the message mode (<a href="#transmission-mode-msg" class="auto internal xref">Section 4.2.1</a>) is used.<a href="#section-3.2.1.1.1-2.7.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1.1.1-2.8">
                  <p id="section-3.2.1.1.1-2.8.1">PACKET_FILTER flag indicates if the peer supports packet filter.<a href="#section-3.2.1.1.1-2.8.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</section>
</div>
</section>
</div>
<div id="sec-hsext-km">
<section id="section-3.2.1.2">
            <h5 id="name-key-material-extension-mess">
<a href="#section-3.2.1.2" class="section-number selfRef">3.2.1.2. </a><a href="#name-key-material-extension-mess" class="section-name selfRef">Key Material Extension Message</a>
            </h5>
<p id="section-3.2.1.2-1">If an encrypted connection is being established, the Key Material (KM) is first transmitted as a
Handshake Extension message. This extension is not supplied for unprotected connections.
The purpose of the extension is to let peers exchange and negotiate encryption-related information
to be used to encrypt and decrypt the payload of the stream.<a href="#section-3.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.2-2">The extension can be supplied with the Handshake Extension Type field set
to either SRT_CMD_KMREQ or SRT_CMD_KMRSP (see <a href="#handshake-ext-type" class="auto internal xref">Table 5</a> in <a href="#ctrl-pkt-handshake" class="auto internal xref">Section 3.2.1</a>).
For more details refer to <a href="#handshake-messages" class="auto internal xref">Section 4.3</a>.<a href="#section-3.2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1.2-3">The KM message is placed in the Extension Contents. See <a href="#sec-ctrlpkt-km" class="auto internal xref">Section 3.2.2</a> for the structure of the KM message.<a href="#section-3.2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1.2-4">In case of SRT_CMD_KMRSP the Extension Length value can be equal to 1 (meaning 4 bytes).
It is an indication of encryption failure. In this case the Extension Content has a different format, <a href="#fig-hsext-kmerror" class="auto internal xref">Figure 7</a>.<a href="#section-3.2.1.2-4" class="pilcrow">¶</a></p>
<span id="name-km-response-error"></span><div id="fig-hsext-kmerror">
<figure id="figure-7">
              <div class="alignLeft art-text artwork" id="section-3.2.1.2-5.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           KM State                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-km-response-error" class="selfRef">KM Response Error</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.2-6">
              <dt id="section-3.2.1.2-6.1">KM State: 32 bits.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.2-6.2">
                <p id="section-3.2.1.2-6.2.1">Key Material State of the peer:<a href="#section-3.2.1.2-6.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-3.2.1.2-7">NOTE: In the descriptions below, "peer" refers to the remote SRT side sending the KM response, and "agent" refers to the local side interpreting the KM response.<a href="#section-3.2.1.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.2-8.1">
                <p id="section-3.2.1.2-8.1.1">0: unsecured (the peer will encrypt the payload, while the agent has not declared any encryption),<a href="#section-3.2.1.2-8.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.2-8.2">
                <p id="section-3.2.1.2-8.2.1">3: no secret (the peer does not have the key to decrypt the incoming payload),<a href="#section-3.2.1.2-8.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.2-8.3">
                <p id="section-3.2.1.2-8.3.1">4: bad secret (the peer has the wrong key and can't decrypt the incoming payload),<a href="#section-3.2.1.2-8.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.2-8.4">
                <p id="section-3.2.1.2-8.4.1">5: bad crypto mode (the peer expects to use a different cryptographic mode). Since protocol v1.6.<a href="#section-3.2.1.2-8.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="sec-hsext-streamid">
<section id="section-3.2.1.3">
            <h5 id="name-stream-id-extension-message">
<a href="#section-3.2.1.3" class="section-number selfRef">3.2.1.3. </a><a href="#name-stream-id-extension-message" class="section-name selfRef">Stream ID Extension Message</a>
            </h5>
<p id="section-3.2.1.3-1">The Stream ID handshake extension message can be used to identify the stream content.
The Stream ID value can be free-form, but there is also a recommended convention
that can be used to achieve interoperability.<a href="#section-3.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3-2">The Stream ID handshake extension message has SRT_CMD_SID extension type (see <a href="#handshake-ext-type" class="auto internal xref">Table 5</a>.
The extension contents are a sequence of UTF-8 characters. The maximum allowed size of the
StreamID extension is 512 bytes.<a href="#section-3.2.1.3-2" class="pilcrow">¶</a></p>
<span id="name-stream-id-extension-message-2"></span><div id="fig-hsext-streamid">
<figure id="figure-8">
              <div class="alignLeft art-text artwork" id="section-3.2.1.3-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                           Stream ID                           |
                               ...
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-stream-id-extension-message-2" class="selfRef">Stream ID Extension Message</a>
              </figcaption></figure>
</div>
<p id="section-3.2.1.3-4">The Extension Contents field holds a sequence of UTF-8 characters (see <a href="#fig-hsext-streamid" class="auto internal xref">Figure 8</a>).
The maximum allowed size of the StreamID extension is 512 bytes. The actual size is determined
by the Extension Length field (<a href="#handshake-packet-structure" class="auto internal xref">Figure 5</a>), which defines the length in
four byte blocks. If the actual payload is less than the declared length, the remaining bytes are set to zeros.<a href="#section-3.2.1.3-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3-5">The content is stored as 32-bit little endian words.<a href="#section-3.2.1.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-hsext-group">
<section id="section-3.2.1.4">
            <h5 id="name-group-membership-extension">
<a href="#section-3.2.1.4" class="section-number selfRef">3.2.1.4. </a><a href="#name-group-membership-extension" class="section-name selfRef">Group Membership Extension</a>
            </h5>
<p id="section-3.2.1.4-1">The Group Membership handshake extension is reserved for the future and is
going to be used to allow multipath SRT connections.<a href="#section-3.2.1.4-1" class="pilcrow">¶</a></p>
<span id="name-group-membership-extension-"></span><div id="fig-hsext-group">
<figure id="figure-9">
              <div class="alignLeft art-text artwork" id="section-3.2.1.4-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Group ID                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type    |     Flags     |             Weight              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-group-membership-extension-" class="selfRef">Group Membership Extension Message</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.4-3">
              <dt id="section-3.2.1.4-3.1">GroupID: 32 bits.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.4-3.2">
                <p id="section-3.2.1.4-3.2.1">The identifier of a group whose members include the sender socket that is making a connection.
The target socket that is interpreting GroupID SHOULD belong to the corresponding group on the target side.
If such a group does not exist, the target socket MAY create it.<a href="#section-3.2.1.4-3.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.4-3.3">Type: 8 bits.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.4-3.4">
                <p id="section-3.2.1.4-3.4.1">Group type, as per SRT_GTYPE_ enumeration:<a href="#section-3.2.1.4-3.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.2.1.4-4.1">
                <p id="section-3.2.1.4-4.1.1">0: undefined group type,<a href="#section-3.2.1.4-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.4-4.2">
                <p id="section-3.2.1.4-4.2.1">1: broadcast group type,<a href="#section-3.2.1.4-4.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.4-4.3">
                <p id="section-3.2.1.4-4.3.1">2: main/backup group type,<a href="#section-3.2.1.4-4.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.4-4.4">
                <p id="section-3.2.1.4-4.4.1">3: balancing group type,<a href="#section-3.2.1.4-4.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.4-4.5">
                <p id="section-3.2.1.4-4.5.1">4: multicast group type (reserved for future use).<a href="#section-3.2.1.4-4.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.4-5">
              <dt id="section-3.2.1.4-5.1">Flags: 8 bits.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.4-5.2">
                <p id="section-3.2.1.4-5.2.1">Special flags mostly reserved for the future. See <a href="#fig-hsext-group-flags" class="auto internal xref">Figure 10</a>.<a href="#section-3.2.1.4-5.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2.1.4-5.3">Weight: 16 bits.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.4-5.4">
                <p id="section-3.2.1.4-5.4.1">Special value with interpretation depending on the Type field value:<a href="#section-3.2.1.4-5.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.2.1.4-6.1">
                <p id="section-3.2.1.4-6.1.1">Not used with broadcast group type,<a href="#section-3.2.1.4-6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.4-6.2">
                <p id="section-3.2.1.4-6.2.1">Defines the link priority for main/backup group type,<a href="#section-3.2.1.4-6.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.4-6.3">
                <p id="section-3.2.1.4-6.3.1">Not yet defined for any other cases (reserved for future use).<a href="#section-3.2.1.4-6.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<span id="name-group-membership-extension-f"></span><div id="fig-hsext-group-flags">
<figure id="figure-10">
              <div class="alignLeft art-text artwork" id="section-3.2.1.4-7.1">
<pre>
 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+
|   (zero)  |M|
+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-group-membership-extension-f" class="selfRef">Group Membership Extension Flags</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1.4-8">
              <dt id="section-3.2.1.4-8.1">M: 1 bit.</dt>
              <dd style="margin-left: 1.5em" id="section-3.2.1.4-8.2">
                <p id="section-3.2.1.4-8.2.1">When set, defines synchronization on message numbers, otherwise transmission is synchronized on sequence numbers.<a href="#section-3.2.1.4-8.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec-ctrlpkt-km">
<section id="section-3.2.2">
          <h4 id="name-key-material">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-key-material" class="section-name selfRef">Key Material</a>
          </h4>
<p id="section-3.2.2-1">The purpose of the Key Material Message
is to let peers exchange encryption-related information to be used to encrypt and decrypt the payload of the stream.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">This message can be supplied in two possible ways:<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-3.1">
              <p id="section-3.2.2-3.1.1">as a Handshake Extension (see <a href="#sec-hsext-km" class="auto internal xref">Section 3.2.1.2</a>)<a href="#section-3.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.2-3.2">
              <p id="section-3.2.2-3.2.1">in the Content Information Field of the User-Defined control packet (described below).<a href="#section-3.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.2-4">When the Key Material is transmitted as a control packet, the Control Type field of the SRT packet header
is set to User-Defined Type (see <a href="#srt-ctrl-pkt-type-table" class="auto internal xref">Table 1</a>), the Subtype field of the header
is set to SRT_CMD_KMREQ for key-refresh request and SRT_CMD_KMRSP for key-refresh response (<a href="#handshake-ext-type" class="auto internal xref">Table 5</a>).
The KM Refresh mechanism is described in <a href="#sec-crypt-km-refresh" class="auto internal xref">Section 6.1.6</a>.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2.2-5">The structure of the Key Material message is illustrated in <a href="#fig-km-msg" class="auto internal xref">Figure 11</a>.<a href="#section-3.2.2-5" class="pilcrow">¶</a></p>
<span id="name-key-material-message-struct"></span><div id="fig-km-msg">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-3.2.2-6.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|S|  V  |   PT  |              Sign             |   Resv1   | KK|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              KEKI                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Cipher    |      Auth     |       SE      |     Resv2     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Resv3             |     SLen/4    |     KLen/4    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              Salt                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                          Wrapped Key                          +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-key-material-message-struct" class="selfRef">Key Material Message structure</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-7">
            <dt id="section-3.2.2-7.1">S: 1 bit, value = {0}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-7.2">
              <p id="section-3.2.2-7.2.1">This is a fixed-width field that is reserved for future usage.<a href="#section-3.2.2-7.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-7.3">KM Version (V): 3 bits, value = {1}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-7.4">
              <p id="section-3.2.2-7.4.1">This is a fixed-width field that indicates the KM message version:<a href="#section-3.2.2-7.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-7.4.2.1">
                  <p id="section-3.2.2-7.4.2.1.1">1: Initial KM message format version.<a href="#section-3.2.2-7.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-7.5">Packet Type (PT): 4 bits, value = {2}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-7.6">
              <p id="section-3.2.2-7.6.1">This is a fixed-width field that indicates the Packet Type:<a href="#section-3.2.2-7.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-7.6.2.1">
                  <p id="section-3.2.2-7.6.2.1.1">0: Reserved<a href="#section-3.2.2-7.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.6.2.2">
                  <p id="section-3.2.2-7.6.2.2.1">1: Media Stream Message (MSmsg)<a href="#section-3.2.2-7.6.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.6.2.3">
                  <p id="section-3.2.2-7.6.2.3.1">2: Keying Material Message (KMmsg)<a href="#section-3.2.2-7.6.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.6.2.4">
                  <p id="section-3.2.2-7.6.2.4.1">7: Reserved to discriminate MPEG-TS packet (0x47=sync byte).<a href="#section-3.2.2-7.6.2.4.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-7.7">Sign: 16 bits, value = {0x2029}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-7.8">
              <p id="section-3.2.2-7.8.1">This is a fixed-width field that contains the signature ‘HAI‘ encoded as a
PnP Vendor ID <span>[<a href="#PNPID" class="cite xref">PNPID</a>]</span> (in big-endian order).<a href="#section-3.2.2-7.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-7.9">Resv1: 6 bits, value = {0}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-7.10">
              <p id="section-3.2.2-7.10.1">This is a fixed-width field reserved for flag extension or other usage.<a href="#section-3.2.2-7.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-7.11">Key-based Encryption (KK): 2 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-7.12">
              <p id="section-3.2.2-7.12.1">This is a fixed-width field that indicates which SEKs (odd and/or even) are provided in the extension:<a href="#section-3.2.2-7.12.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-7.12.2.1">
                  <p id="section-3.2.2-7.12.2.1.1">00b: No SEK is provided (invalid extension format);<a href="#section-3.2.2-7.12.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.12.2.2">
                  <p id="section-3.2.2-7.12.2.2.1">01b: Even key is provided;<a href="#section-3.2.2-7.12.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.12.2.3">
                  <p id="section-3.2.2-7.12.2.3.1">10b: Odd key is provided;<a href="#section-3.2.2-7.12.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.12.2.4">
                  <p id="section-3.2.2-7.12.2.4.1">11b: Both even and odd keys are provided.<a href="#section-3.2.2-7.12.2.4.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-7.13">Key Encryption Key Index (KEKI): 32 bits, value = {0}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-7.14">
              <p id="section-3.2.2-7.14.1">This is a fixed-width field for specifying the KEK index (big-endian order)
was used to wrap (and optionally authenticate) the SEK(s).
The value 0 is used to indicate the default key of the current stream.
Other values are reserved for the possible use of a key management system in the future
to retrieve a cryptographic context.<a href="#section-3.2.2-7.14.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-7.14.2.1">
                  <p id="section-3.2.2-7.14.2.1.1">0: Default stream associated key (stream/system default)<a href="#section-3.2.2-7.14.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.14.2.2">
                  <p id="section-3.2.2-7.14.2.2.1">1..255: Reserved for manually indexed keys.<a href="#section-3.2.2-7.14.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-7.15">Cipher: 8 bits, value = {0..2}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-7.16">
              <p id="section-3.2.2-7.16.1">This is a fixed-width field for specifying encryption cipher and mode:<a href="#section-3.2.2-7.16.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-7.16.2.1">
                  <p id="section-3.2.2-7.16.2.1.1">0: None or KEKI indexed crypto context;<a href="#section-3.2.2-7.16.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.16.2.2">
                  <p id="section-3.2.2-7.16.2.2.1">1: AES-ECB (Reserved, not supported);<a href="#section-3.2.2-7.16.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.16.2.3">
                  <p id="section-3.2.2-7.16.2.3.1">2: AES-CTR <span>[<a href="#SP800-38A" class="cite xref">SP800-38A</a>]</span>;<a href="#section-3.2.2-7.16.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.16.2.4">
                  <p id="section-3.2.2-7.16.2.4.1">3: AES-CBC (Reserved, not supported);<a href="#section-3.2.2-7.16.2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-7.16.2.5">
                  <p id="section-3.2.2-7.16.2.5.1">4: AES-GCM (Galois Counter Mode), starting from v1.6.0.<a href="#section-3.2.2-7.16.2.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.2-8">If AES-GCM is set as the cipher, AES-GCM MUST also be set as the message authentication code algorithm (the Auth field).<a href="#section-3.2.2-8" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-9">
            <dt id="section-3.2.2-9.1">Authentication (Auth): 8 bits, value = {0}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-9.2">
              <p id="section-3.2.2-9.2.1">This is a fixed-width field for specifying a message authentication code (MAC) algorithm:<a href="#section-3.2.2-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-9.2.2.1">
                  <p id="section-3.2.2-9.2.2.1.1">0: None or KEKI indexed crypto context;<a href="#section-3.2.2-9.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-9.2.2.2">
                  <p id="section-3.2.2-9.2.2.2.1">1: AES-GCM, starting from v1.6.0.<a href="#section-3.2.2-9.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.2-10">If AES-GCM is selected as the MAC algorithm, it MUST also be selected as the cipher.<a href="#section-3.2.2-10" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-11">
            <dt id="section-3.2.2-11.1">Stream Encapsulation (SE): 8 bits, value = {2}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-11.2">
              <p id="section-3.2.2-11.2.1">This is a fixed-width field for describing the stream encapsulation:<a href="#section-3.2.2-11.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-11.2.2.1">
                  <p id="section-3.2.2-11.2.2.1.1">0: Unspecified or KEKI indexed crypto context<a href="#section-3.2.2-11.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-11.2.2.2">
                  <p id="section-3.2.2-11.2.2.2.1">1: MPEG-TS/UDP<a href="#section-3.2.2-11.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-11.2.2.3">
                  <p id="section-3.2.2-11.2.2.3.1">2: MPEG-TS/SRT.<a href="#section-3.2.2-11.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-11.3">Resv2: 8 bits, value = {0}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-11.4">
              <p id="section-3.2.2-11.4.1">This is a fixed-width field reserved for future use.<a href="#section-3.2.2-11.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-11.5">Resv3: 16 bits, value = {0}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-11.6">
              <p id="section-3.2.2-11.6.1">This is a fixed-width field reserved for future use.<a href="#section-3.2.2-11.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-11.7">SLen/4: 8 bits, value = {4}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-11.8">
              <p id="section-3.2.2-11.8.1">This is a fixed-width field for specifying salt length SLen in bytes divided by 4.
Can be zero if no salt/IV present. The only valid length of salt defined is 128 bits.<a href="#section-3.2.2-11.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-11.9">KLen/4: 8 bits, value = {4,6,8}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-11.10">
              <p id="section-3.2.2-11.10.1">This is a fixed-width field for specifying SEK length in bytes divided by 4.
Size of one key even if two keys present. MUST match the key size specified in the Encryption Field
of the handshake packet <a href="#handshake-encr-fld" class="auto internal xref">Table 2</a>.<a href="#section-3.2.2-11.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-11.11">Salt (SLen): SLen * 8 bits, value = { }.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-11.12">
              <p id="section-3.2.2-11.12.1">This is a variable-width field that complements the keying material by specifying a salt key.<a href="#section-3.2.2-11.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-11.13">Wrap: (64 + n * KLen * 8) bits, value = { }.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-11.14">
              <p id="section-3.2.2-11.14.1">This is a variable-width field for specifying Wrapped key(s), where n = (KK + 1)/2 and
the size of the wrap field is ((n * KLen) + 8) bytes.<a href="#section-3.2.2-11.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-unwrapped-key-structure"></span><div id="unwrapped-key-structure">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-3.2.2-12.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                  Integrity Check Vector (ICV)                 +
|                                                               |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
|                              xSEK                             |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
|                              oSEK                             |
+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-unwrapped-key-structure" class="selfRef">Unwrapped key structure</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-13">
            <dt id="section-3.2.2-13.1">ICV: 64 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-13.2">
              <p id="section-3.2.2-13.2.1">64-bit Integrity Check Vector(AES key wrap integrity).
This field is used to detect if the keys were unwrapped properly.
If the KEK in hand is invalid, validation fails and unwrapped keys are discarded.<a href="#section-3.2.2-13.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-13.3">xSEK: variable width.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-13.4">
              <p id="section-3.2.2-13.4.1">This field identifies an odd or even SEK. If only one key is present, the bit set in the KK field tells which SEK is provided.
If both keys are present, then this field is eSEK (even key) and it is followed by odd key oSEK.
The length of this field is calculated as KLen * 8.<a href="#section-3.2.2-13.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-13.5">oSEK: variable width.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-13.6">
              <p id="section-3.2.2-13.6.1">This field with the odd key is present only when the message carries the two SEKs (identified by he KK field).<a href="#section-3.2.2-13.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ctrl-pkt-keepalive">
<section id="section-3.2.3">
          <h4 id="name-keep-alive">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-keep-alive" class="section-name selfRef">Keep-Alive</a>
          </h4>
<p id="section-3.2.3-1">Keep-alive control packets are sent after a certain timeout from the last time
any packet (Control or Data) was sent. The purpose of this control packet is to
notify the peer to keep the connection open when no data exchange is taking place.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.3-2">The default timeout for a keep-alive packet to be sent is 1 second.<a href="#section-3.2.3-2" class="pilcrow">¶</a></p>
<p id="section-3.2.3-3">An SRT keep-alive packet is formatted as follows:<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
<span id="name-keep-alive-control-packet"></span><div id="keepalive-structure">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="section-3.2.3-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|         Control Type        |            Reserved           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Destination SRT Socket ID                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-keep-alive-control-packet" class="selfRef">Keep-Alive control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.3-5">
            <dt id="section-3.2.3-5.1">Packet Type: 1 bit, value = 1.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-5.2">
              <p id="section-3.2.3-5.2.1">The packet type value of a keep-alive control packet is "1".<a href="#section-3.2.3-5.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-5.3">Control Type: 15 bits, value = KEEPALIVE{0x0001}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-5.4">
              <p id="section-3.2.3-5.4.1">The control type value of a keep-alive control packet is "1".<a href="#section-3.2.3-5.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-5.5">Reserved: 16 bits, value = 0.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-5.6">
              <p id="section-3.2.3-5.6.1">This is a fixed-width field reserved for future use.<a href="#section-3.2.3-5.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-5.7">Type-specific Information.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-5.8">
              <p id="section-3.2.3-5.8.1">This field is reserved for future definition.<a href="#section-3.2.3-5.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-5.9">Timestamp: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-5.10">
              <p id="section-3.2.3-5.10.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.3-5.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-5.11">Destination SRT Socket ID: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.3-5.12">
              <p id="section-3.2.3-5.12.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.3-5.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.3-6">Keep-alive controls packet do not contain Control Information Field (CIF).<a href="#section-3.2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ctrl-pkt-ack">
<section id="section-3.2.4">
          <h4 id="name-ack-acknowledgment">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-ack-acknowledgment" class="section-name selfRef">ACK (Acknowledgment)</a>
          </h4>
<p id="section-3.2.4-1">Acknowledgment (ACK) control packets are used to provide the delivery status of data packets.
By acknowledging the reception of data packets up to the acknowledged packet sequence number,
the receiver notifies the sender that all prior packets were received or, in the case of
live streaming (<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>, <a href="#live-streaming-use-case" class="auto internal xref">Section 7.1</a>), preceding missing packets (if any)
were dropped as too late to be delivered (<a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a>).<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.4-2">ACK packets may also carry some additional information from the receiver like
the estimates of RTT, RTT variance, link capacity, receiving speed, etc. The CIF portion of the ACK control packet is
expanded as follows:<a href="#section-3.2.4-2" class="pilcrow">¶</a></p>
<span id="name-ack-control-packet"></span><div id="ack-control-packet">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="section-3.2.4-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|        Control Type         |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Acknowledgement Number                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Destination SRT Socket ID                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- CIF -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|          Last Acknowledged Packet Sequence Number           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              RTT                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          RTT Variance                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Available Buffer Size                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Packets Receiving Rate                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Estimated Link Capacity                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Receiving Rate                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-ack-control-packet" class="selfRef">ACK control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.4-4">
            <dt id="section-3.2.4-4.1">Packet Type: 1 bit, value = 1.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.2">
              <p id="section-3.2.4-4.2.1">The packet type value of an ACK control packet is "1".<a href="#section-3.2.4-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.3">Control Type: 15 bits, value = ACK{0x0002}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.4">
              <p id="section-3.2.4-4.4.1">The control type value of an ACK control packet is "2".<a href="#section-3.2.4-4.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.5">Reserved: 16 bits, value = 0.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.6">
              <p id="section-3.2.4-4.6.1">This is a fixed-width field reserved for future use.<a href="#section-3.2.4-4.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.7">Acknowledgement Number: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.8">
              <p id="section-3.2.4-4.8.1">This field contains the sequential number of the full acknowledgment packet starting from 1, except in the case of Light ACKs and Small ACKs, where this value is 0 (see below).<a href="#section-3.2.4-4.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.9">Timestamp: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.10">
              <p id="section-3.2.4-4.10.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.4-4.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.11">Destination SRT Socket ID: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.12">
              <p id="section-3.2.4-4.12.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.4-4.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.13">Last Acknowledged Packet Sequence Number: 31 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.14">
              <p id="section-3.2.4-4.14.1">This field contains the sequence number of the last data packet being acknowledged plus one.
In other words, if it the sequence number of the first unacknowledged packet.<a href="#section-3.2.4-4.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.15">RTT: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.16">
              <p id="section-3.2.4-4.16.1">RTT value, in microseconds, estimated by the receiver based on the previous ACK/ACKACK
packet pair exchange.<a href="#section-3.2.4-4.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.17">RTT Variance: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.18">
              <p id="section-3.2.4-4.18.1">The variance of the RTT estimate, in microseconds.<a href="#section-3.2.4-4.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.19">Available Buffer Size: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.20">
              <p id="section-3.2.4-4.20.1">Available size of the receiver's buffer, in packets.<a href="#section-3.2.4-4.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.21">Packets Receiving Rate: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.22">
              <p id="section-3.2.4-4.22.1">The rate at which packets are being received, in packets per second.<a href="#section-3.2.4-4.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.23">Estimated Link Capacity: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.24">
              <p id="section-3.2.4-4.24.1">Estimated bandwidth of the link, in packets per second.<a href="#section-3.2.4-4.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.4-4.25">Receiving Rate: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.4-4.26">
              <p id="section-3.2.4-4.26.1">Estimated receiving rate, in bytes per second.<a href="#section-3.2.4-4.26.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.4-5">There are several types of ACK packets:<a href="#section-3.2.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.4-6.1">
              <p id="section-3.2.4-6.1.1">A Full ACK control packet is sent every 10 ms and has all the fields
of <a href="#ack-control-packet" class="auto internal xref">Figure 14</a>.<a href="#section-3.2.4-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.4-6.2">
              <p id="section-3.2.4-6.2.1">A Light ACK control packet includes only the Last Acknowledged Packet Sequence Number
field. The Type-specific Information field should be set to 0.<a href="#section-3.2.4-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.4-6.3">
              <p id="section-3.2.4-6.3.1">A Small ACK includes the fields up to and including the Available Buffer Size field.
The Type-specific Information field should be set to 0.<a href="#section-3.2.4-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.4-7">The sender only acknowledges the receipt of Full ACK packets (see <a href="#ctrl-pkt-ackack" class="auto internal xref">Section 3.2.8</a>).<a href="#section-3.2.4-7" class="pilcrow">¶</a></p>
<p id="section-3.2.4-8">The Light ACK and Small ACK packets are used in cases when the receiver should acknowledge
received data packets more often than every 10 ms. This is usually needed at high data rates.
It is up to the receiver to decide the condition and the type of ACK packet to send (Light or Small).
The recommendation is to send a Light ACK for every 64 packets received.<a href="#section-3.2.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ctrl-pkt-nak">
<section id="section-3.2.5">
          <h4 id="name-nak-negative-acknowledgemen">
<a href="#section-3.2.5" class="section-number selfRef">3.2.5. </a><a href="#name-nak-negative-acknowledgemen" class="section-name selfRef">NAK (Negative Acknowledgement or Loss Report)</a>
          </h4>
<p id="section-3.2.5-1">Negative acknowledgment (NAK) control packets are used to signal failed data packet
deliveries. The receiver notifies the sender about lost data packets by sending a NAK
packet that contains a list of sequence numbers for those lost packets.<a href="#section-3.2.5-1" class="pilcrow">¶</a></p>
<p id="section-3.2.5-2">An SRT NAK packet is formatted as follows:<a href="#section-3.2.5-2" class="pilcrow">¶</a></p>
<span id="name-nak-control-packet"></span><div id="nak-control-packet">
<figure id="figure-15">
            <div class="alignLeft art-text artwork" id="section-3.2.5-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|        Control Type         |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Destination SRT Socket ID                   |
+-+-+-+-+-+-+-+-+-+-+-+- CIF (Loss List) -+-+-+-+-+-+-+-+-+-+-+-+
|0|                 Lost packet sequence number                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|         Range of lost packets from sequence number          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                    Up to sequence number                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                 Lost packet sequence number                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-nak-control-packet" class="selfRef">NAK control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.5-4">
            <dt id="section-3.2.5-4.1">Packet Type: 1 bit, value = 1.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.5-4.2">
              <p id="section-3.2.5-4.2.1">The packet type value of a NAK control packet is "1".<a href="#section-3.2.5-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.5-4.3">Control Type: 15 bits, value = NAK{0x0003}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.5-4.4">
              <p id="section-3.2.5-4.4.1">The control type value of a NAK control packet is "3".<a href="#section-3.2.5-4.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.5-4.5">Reserved: 16 bits, value = 0.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.5-4.6">
              <p id="section-3.2.5-4.6.1">This is a fixed-width field reserved for future use.<a href="#section-3.2.5-4.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.5-4.7">Type-specific Information: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.5-4.8">
              <p id="section-3.2.5-4.8.1">This field is reserved for future definition.<a href="#section-3.2.5-4.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.5-4.9">Timestamp: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.5-4.10">
              <p id="section-3.2.5-4.10.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.5-4.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.5-4.11">Destination SRT Socket ID: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.5-4.12">
              <p id="section-3.2.5-4.12.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.5-4.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.5-4.13">Control Information Field (CIF).</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.5-4.14">
              <p id="section-3.2.5-4.14.1">A single value or a range of lost packets sequence numbers. See packet sequence number
coding in <a href="#packet-seq-list-coding" class="auto internal xref">Appendix A</a>.<a href="#section-3.2.5-4.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ctrl-pkt-congestion">
<section id="section-3.2.6">
          <h4 id="name-congestion-warning">
<a href="#section-3.2.6" class="section-number selfRef">3.2.6. </a><a href="#name-congestion-warning" class="section-name selfRef">Congestion Warning</a>
          </h4>
<p id="section-3.2.6-1">The Congestion Warning control packet is reserved for future use.
Its purpose is to allow a receiver to signal a sender that there is congestion
happening at the receiving side. The expected behaviour is that upon
receiving this packet the sender slows down its sending rate by increasing the
minimum inter-packet sending interval by a discrete value (posited to be 12.5%).<a href="#section-3.2.6-1" class="pilcrow">¶</a></p>
<p id="section-3.2.6-2">Note that the conditions for a receiver to issue this type of packet are not yet defined.<a href="#section-3.2.6-2" class="pilcrow">¶</a></p>
<span id="name-congestion-warning-control-"></span><div id="congestion-warning-control-packet">
<figure id="figure-16">
            <div class="alignLeft art-text artwork" id="section-3.2.6-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|      Control Type = 4       |         Reserved = 0          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Type-specific Information = 0                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Destination SRT Socket ID                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-congestion-warning-control-" class="selfRef">Congestion Warning control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.6-4">
            <dt id="section-3.2.6-4.1">Packet Type: 1 bit, value = 1.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.6-4.2">
              <p id="section-3.2.6-4.2.1">The packet type value of a Congestion Warning control packet is "1".<a href="#section-3.2.6-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.6-4.3">Control Type: 15 bits, value = 4.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.6-4.4">
              <p id="section-3.2.6-4.4.1">The control type value of a Congestion Warning control packet is "4".<a href="#section-3.2.6-4.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.6-4.5">Timestamp: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.6-4.6">
              <p id="section-3.2.6-4.6.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.6-4.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.6-4.7">Destination SRT Socket ID: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.6-4.8">
              <p id="section-3.2.6-4.8.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.6-4.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.6-4.9">Type-specific Information.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.6-4.10">
              <p id="section-3.2.6-4.10.1">This field is reserved for future definition.<a href="#section-3.2.6-4.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ctrl-pkt-shutdown">
<section id="section-3.2.7">
          <h4 id="name-shutdown">
<a href="#section-3.2.7" class="section-number selfRef">3.2.7. </a><a href="#name-shutdown" class="section-name selfRef">Shutdown</a>
          </h4>
<p id="section-3.2.7-1">Shutdown control packets are used to initiate the closing of an SRT connection.<a href="#section-3.2.7-1" class="pilcrow">¶</a></p>
<p id="section-3.2.7-2">An SRT shutdown control packet is formatted as follows:<a href="#section-3.2.7-2" class="pilcrow">¶</a></p>
<span id="name-shutdown-control-packet"></span><div id="shutdown-control-packet">
<figure id="figure-17">
            <div class="alignLeft art-text artwork" id="section-3.2.7-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|        Control Type         |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Type-specific Information                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Destination SRT Socket ID                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-shutdown-control-packet" class="selfRef">Shutdown control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.7-4">
            <dt id="section-3.2.7-4.1">Packet Type: 1 bit, value = 1.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.7-4.2">
              <p id="section-3.2.7-4.2.1">The packet type value of a shutdown control packet is "1".<a href="#section-3.2.7-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.7-4.3">Control Type: 15 bits, value = SHUTDOWN{0x0005}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.7-4.4">
              <p id="section-3.2.7-4.4.1">The control type value of a shutdown control packet is "5".<a href="#section-3.2.7-4.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.7-4.5">Timestamp: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.7-4.6">
              <p id="section-3.2.7-4.6.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.7-4.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.7-4.7">Destination SRT Socket ID: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.7-4.8">
              <p id="section-3.2.7-4.8.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.7-4.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.7-4.9">Type-specific Information.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.7-4.10">
              <p id="section-3.2.7-4.10.1">This field is reserved for future definition.<a href="#section-3.2.7-4.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.7-5">Shutdown control packets do not contain Control Information Field (CIF).<a href="#section-3.2.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ctrl-pkt-ackack">
<section id="section-3.2.8">
          <h4 id="name-ackack-acknowledgement-of-a">
<a href="#section-3.2.8" class="section-number selfRef">3.2.8. </a><a href="#name-ackack-acknowledgement-of-a" class="section-name selfRef">ACKACK (Acknowledgement of Acknowledgement)</a>
          </h4>
<p id="section-3.2.8-1">Acknowledgement of Acknowledgement (ACKACK) control packets are sent to acknowledge the reception of a Full ACK and used
in the calculation of the round-trip time by the SRT receiver.<a href="#section-3.2.8-1" class="pilcrow">¶</a></p>
<p id="section-3.2.8-2">An SRT ACKACK control packet is formatted as follows:<a href="#section-3.2.8-2" class="pilcrow">¶</a></p>
<span id="name-ackack-control-packet"></span><div id="ackack-control-packet">
<figure id="figure-18">
            <div class="alignLeft art-text artwork" id="section-3.2.8-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|        Control Type         |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Acknowledgement Number                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Destination SRT Socket ID                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-ackack-control-packet" class="selfRef">ACKACK control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.8-4">
            <dt id="section-3.2.8-4.1">Packet Type: 1 bit, value = 1.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.8-4.2">
              <p id="section-3.2.8-4.2.1">The packet type value of an ACKACK control packet is "1".<a href="#section-3.2.8-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.8-4.3">Control Type: 15 bits, value = ACKACK{0x0006}.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.8-4.4">
              <p id="section-3.2.8-4.4.1">The control type value of an ACKACK control packet is "6".<a href="#section-3.2.8-4.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.8-4.5">Acknowledgement Number.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.8-4.6">
              <p id="section-3.2.8-4.6.1">This field contains the Acknowledgement Number of the full ACK packet
the reception of which is being acknowledged by this ACKACK packet.<a href="#section-3.2.8-4.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.8-4.7">Timestamp: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.8-4.8">
              <p id="section-3.2.8-4.8.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.8-4.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.8-4.9">Destination SRT Socket ID: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.8-4.10">
              <p id="section-3.2.8-4.10.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.8-4.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.8-5">ACKACK control packets do not contain Control Information Field (CIF).<a href="#section-3.2.8-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ctrl-pkt-dropreq">
<section id="section-3.2.9">
          <h4 id="name-message-drop-request">
<a href="#section-3.2.9" class="section-number selfRef">3.2.9. </a><a href="#name-message-drop-request" class="section-name selfRef">Message Drop Request</a>
          </h4>
<p id="section-3.2.9-1">A Message Drop Request control packet is sent by the sender to the receiver
when a retransmission of an unacknowledged packet (forming a whole or a part
of a message) which is not present in the sender's buffer is requested.
This may happen, for example, when a TTL parameter (passed in the sending function) triggers a
timeout for retransmitting one or more lost packets which constitute parts of a message, causing
these packets to be removed from the sender's buffer.<a href="#section-3.2.9-1" class="pilcrow">¶</a></p>
<p id="section-3.2.9-2">The sender notifies the receiver that it must not wait for retransmission of this
message. Note that a Message Drop Request control packet is not sent if the
Too Late Packet Drop mechanism (<a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a>) causes the sender
to drop a message, as in this case the receiver is expected to drop it anyway.<a href="#section-3.2.9-2" class="pilcrow">¶</a></p>
<p id="section-3.2.9-3">A Message Drop Request contains the message number and corresponding range of packet sequence numbers
which form the whole message. If the sender does not already have in its buffer the specific packet or packets for
which retransmission was requested, then it is unable to restore the message number. In this case the Message
Number field must be set to zero, and the receiver should drop packets in the provided packet sequence number range.<a href="#section-3.2.9-3" class="pilcrow">¶</a></p>
<span id="name-drop-request-control-packet"></span><div id="dropreq-control-packet">
<figure id="figure-19">
            <div class="alignLeft art-text artwork" id="section-3.2.9-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|      Control Type = 7       |         Reserved = 0          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Message Number                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Destination SRT Socket ID                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|               First Packet Sequence Number                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                Last Packet Sequence Number                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-drop-request-control-packet" class="selfRef">Drop Request control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.9-5">
            <dt id="section-3.2.9-5.1">Packet Type: 1 bit, value = 1.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.9-5.2">
              <p id="section-3.2.9-5.2.1">The packet type value of a Drop Request control packet is "1".<a href="#section-3.2.9-5.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.9-5.3">Control Type: 15 bits, value = 7.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.9-5.4">
              <p id="section-3.2.9-5.4.1">The control type value of a Drop Request control packet is "7".<a href="#section-3.2.9-5.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.9-5.5">Message Number: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.9-5.6">
              <p id="section-3.2.9-5.6.1">The identifying number of the message requested to be dropped.
See the Message Number field in <a href="#data-pkt" class="auto internal xref">Section 3.1</a>.<a href="#section-3.2.9-5.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.9-5.7">Timestamp: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.9-5.8">
              <p id="section-3.2.9-5.8.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.9-5.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.9-5.9">Destination SRT Socket ID: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.9-5.10">
              <p id="section-3.2.9-5.10.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.9-5.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.9-5.11">First Packet Sequence Number: 31 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.9-5.12">
              <p id="section-3.2.9-5.12.1">The sequence number of the first packet in the message.<a href="#section-3.2.9-5.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.9-5.13">Last Packet Sequence Number: 31 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.9-5.14">
              <p id="section-3.2.9-5.14.1">The sequence number of the last packet in the message.<a href="#section-3.2.9-5.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ctrl-pkt-peer-error">
<section id="section-3.2.10">
          <h4 id="name-peer-error">
<a href="#section-3.2.10" class="section-number selfRef">3.2.10. </a><a href="#name-peer-error" class="section-name selfRef">Peer Error</a>
          </h4>
<p id="section-3.2.10-1">The Peer Error control packet is sent by a receiver when a processing error
(e.g. write to disk failure) occurs. This informs the sender of the situation
and unblocks it from waiting for further responses from the receiver.<a href="#section-3.2.10-1" class="pilcrow">¶</a></p>
<p id="section-3.2.10-2">The sender receiving this type of control packet must unblock any sending operation in progress.<a href="#section-3.2.10-2" class="pilcrow">¶</a></p>
<p id="section-3.2.10-3"><strong>NOTE</strong>: This control packet is only used if the File Transfer Congestion Control (<a href="#fileCC" class="auto internal xref">Section 5.2</a>) is enabled.<a href="#section-3.2.10-3" class="pilcrow">¶</a></p>
<span id="name-peer-error-control-packet"></span><div id="peer-error-control-packet">
<figure id="figure-20">
            <div class="alignLeft art-text artwork" id="section-3.2.10-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+- SRT Header +-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|      Control Type = 8       |         Reserved = 0          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Error Code                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Timestamp                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Destination SRT Socket ID                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-peer-error-control-packet" class="selfRef">Peer Error control packet</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.10-5">
            <dt id="section-3.2.10-5.1">Packet Type: 1 bit, value = 1.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.10-5.2">
              <p id="section-3.2.10-5.2.1">The packet type value of a Peer Error control packet is "1".<a href="#section-3.2.10-5.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.10-5.3">Control Type: 15 bits, value = 8.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.10-5.4">
              <p id="section-3.2.10-5.4.1">The control type value of a Peer Error control packet is "8".<a href="#section-3.2.10-5.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.10-5.5">Error Code: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.10-5.6">
              <p id="section-3.2.10-5.6.1">Peer error code. At the moment the only value defined is 4000 - file system error.<a href="#section-3.2.10-5.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.10-5.7">Timestamp: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.10-5.8">
              <p id="section-3.2.10-5.8.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.10-5.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.10-5.9">Destination SRT Socket ID: 32 bits.</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.10-5.10">
              <p id="section-3.2.10-5.10.1">See <a href="#packet-structure" class="auto internal xref">Section 3</a>.<a href="#section-3.2.10-5.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="srt-data-transmission-and-control">
<section id="section-4">
      <h2 id="name-srt-data-transmission-and-c">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-srt-data-transmission-and-c" class="section-name selfRef">SRT Data Transmission and Control</a>
      </h2>
<p id="section-4-1">This section describes key concepts related to the handling of control
and data packets during the transmission process.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">After the handshake and exchange of capabilities is completed, packet data
can be sent and received over the established connection. To fully utilize
the features of low latency and error recovery provided by SRT, the sender
and receiver must handle control packets, timers, and buffers for the connection
as specified in this section.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="stream-multiplexing">
<section id="section-4.1">
        <h3 id="name-stream-multiplexing">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-stream-multiplexing" class="section-name selfRef">Stream Multiplexing</a>
        </h3>
<p id="section-4.1-1">Multiple SRT sockets may share the same UDP socket so that the packets
received to this UDP socket will be correctly dispatched to those
SRT sockets they are currently destined.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">During the handshake, the parties exchange their SRT Socket IDs.
These IDs are then used in the Destination SRT Socket ID field of
every control and data packet (see <a href="#packet-structure" class="auto internal xref">Section 3</a>).<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-transmission-modes">
<section id="section-4.2">
        <h3 id="name-data-transmission-modes">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-data-transmission-modes" class="section-name selfRef">Data Transmission Modes</a>
        </h3>
<p id="section-4.2-1">There are two data transmission modes supported by SRT: message mode (<a href="#transmission-mode-msg" class="auto internal xref">Section 4.2.1</a>) and buffer mode (<a href="#transmission-mode-buffer" class="auto internal xref">Section 4.2.2</a>). These are the modes originally defined in the UDT protocol <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">As SRT has been mainly designed for live video and audio streaming, its main and default transmission mode is message mode with certain settings applied (<a href="#live-streaming-use-case" class="auto internal xref">Section 7.1</a>).<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Besides live streaming, SRT maintains the ability for fast file transfers introduced in UDT (<a href="#file-transmission-use-case" class="auto internal xref">Section 7.2</a>). The usage of both message and buffer modes is possible in this case.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Best practices and configuration tips for both use cases can be found in <a href="#best-practices" class="auto internal xref">Section 7</a>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<div id="transmission-mode-msg">
<section id="section-4.2.1">
          <h4 id="name-message-mode">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-message-mode" class="section-name selfRef">Message Mode</a>
          </h4>
<p id="section-4.2.1-1">When the STREAM flag of the handshake Extension Message
<a href="#handshake-extension-msg" class="auto internal xref">Section 3.2.1.1</a> is set to 0, the protocol operates
in Message mode, characterized as follows:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.1">
              <p id="section-4.2.1-2.1.1">Every packet has its own Packet Sequence Number.<a href="#section-4.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.2">
              <p id="section-4.2.1-2.2.1">One or several consecutive SRT data packets can form a message.<a href="#section-4.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-2.3">
              <p id="section-4.2.1-2.3.1">All the packets belonging to the same message have a similar message number set
    in the Message Number field.<a href="#section-4.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-3">The first packet of a message has the first bit of the Packet Position Flags (<a href="#data-pkt" class="auto internal xref">Section 3.1</a>)
set to 1. The last packet of the message has the second bit of the Packet Position Flags
set to 1. Thus, a PP equal to "11b" indicates a packet that forms the whole message.
A PP equal to "00b" indicates a packet that belongs to the inner part of the message.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">The concept of the message in SRT comes from UDT <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span>. In this mode, a single
sending instruction passes exactly one piece of data that has boundaries (a message).
This message may span multiple UDP packets and multiple SRT data packets. The
only size limitation is that it shall fit as a whole in the buffers of the sender and the
receiver. Although internally all operations (e.g., ACK, NAK) on data packets are performed
independently, an application must send and receive the whole message. Until the message
is complete (all packets are received) the application will not be allowed to read it.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-5">When the Order Flag of a data packet is set to 1, this imposes a sequential reading order
on messages. An Order Flag set to 0 allows an application to read messages that are
already fully available, before any preceding messages that may have some packets missing.<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transmission-mode-buffer">
<section id="section-4.2.2">
          <h4 id="name-buffer-mode">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-buffer-mode" class="section-name selfRef">Buffer Mode</a>
          </h4>
<p id="section-4.2.2-1">Buffer mode is negotiated during the handshake by setting the STREAM flag
of the handshake Extension Message Flags (<a href="#hs-ext-msg-flags" class="auto internal xref">Section 3.2.1.1.1</a>) to 1.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">In this mode, consecutive packets form one continuous stream that can be read with
portions of any size.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="handshake-messages">
<section id="section-4.3">
        <h3 id="name-handshake-messages">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-handshake-messages" class="section-name selfRef">Handshake Messages</a>
        </h3>
<p id="section-4.3-1">SRT uses UDP as an underlying connectionless transport protocol.
SRT is a connection-oriented protocol. It embraces the concepts of "connection"
and "session". Every SRT session starts with the connection phase, where
peers exchange configuration parameters and relevant information by the means of
SRT handshake control packets.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">SRT versions prior to v1.3.0 use version 4 of the handshaking procedure.
HS version 5 is used starting from SRT v1.3.0.\
HS version 4 is not described in this specification.
SRT implementations MUST support HS version 5, but MAY not support HS v4.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">An SRT connection is characterized by the fact that it is:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-4.1">
            <p id="section-4.3-4.1.1">first engaged by a handshake process,<a href="#section-4.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-4.2">
            <p id="section-4.3-4.2.1">maintained as long as any packets are being exchanged in a timely manner, and<a href="#section-4.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-4.3">
            <p id="section-4.3-4.3.1">considered closed when a party receives the appropriate SHUTDOWN command from
its peer (connection closed by the foreign host), or when it receives no
packets at all for some predefined time (connection broken on timeout).<a href="#section-4.3-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-5">SRT supports two connection modes:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-6">
<li id="section-4.3-6.1">
            <p id="section-4.3-6.1.1">Caller-Listener, where one side waits for the other to initiate a connection;<a href="#section-4.3-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-6.2">
            <p id="section-4.3-6.2.1">Rendezvous, where both sides attempt to initiate a connection.<a href="#section-4.3-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.3-7">The handshake is performed between two parties: "Initiator" and "Responder" in
the following order:<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-8.1">
            <p id="section-4.3-8.1.1">Initiator starts an extended SRT handshake process and sends appropriate
SRT extended handshake requests.<a href="#section-4.3-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-8.2">
            <p id="section-4.3-8.2.1">Responder expects the SRT extended handshake requests to be sent by the
Initiator and sends SRT extended handshake responses back.<a href="#section-4.3-8.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-9">There are three basic types of SRT handshake extensions that are exchanged
in the handshake:<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-10.1">
            <p id="section-4.3-10.1.1">Handshake Extension Message exchanges the basic SRT information;<a href="#section-4.3-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-10.2">
            <p id="section-4.3-10.2.1">Key Material Exchange exchanges the wrapped stream encryption key (used only if
an encryption is requested).<a href="#section-4.3-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-10.3">
            <p id="section-4.3-10.3.1">Stream ID extension exchanges some stream-specific information that can be used
by the application to identify an incoming stream connection.<a href="#section-4.3-10.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-11">The Initiator and Responder roles are assigned depending on the connection mode.<a href="#section-4.3-11" class="pilcrow">¶</a></p>
<p id="section-4.3-12">For Caller-Listener connections: the Caller is the Initiator,
the Listener is the Responder.
For Rendezvous connections: the Initiator and Responder roles are assigned
based on the initial data interchange during the handshake.<a href="#section-4.3-12" class="pilcrow">¶</a></p>
<p id="section-4.3-13">The Handshake Type field in the Handshake Structure (see <a href="#handshake-packet-structure" class="auto internal xref">Figure 5</a>)
indicates the handshake message type.<a href="#section-4.3-13" class="pilcrow">¶</a></p>
<p id="section-4.3-14">Caller-Listener handshake exchange has the following order of Handshake Types:<a href="#section-4.3-14" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-15">
<li id="section-4.3-15.1">
            <p id="section-4.3-15.1.1">Caller to Listener: INDUCTION Request<a href="#section-4.3-15.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-15.2">
            <p id="section-4.3-15.2.1">Listener to Caller: INDUCTION Response (reports cookie)<a href="#section-4.3-15.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-15.3">
            <p id="section-4.3-15.3.1">Caller to Listener: CONCLUSION Request (uses previously returned cookie)<a href="#section-4.3-15.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-15.4">
            <p id="section-4.3-15.4.1">Listener to Caller: CONCLUSION Response (confirms connection established).<a href="#section-4.3-15.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.3-16">Rendezvous handshake exchange has the following order of Handshake Types:<a href="#section-4.3-16" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-17">
<li id="section-4.3-17.1">
            <p id="section-4.3-17.1.1">Both peers after starting the connection: WAVEAHAND with a cookie.<a href="#section-4.3-17.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-17.2">
            <p id="section-4.3-17.2.1">After receiving the above message from the peer: CONCLUSION<a href="#section-4.3-17.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-17.3">
            <p id="section-4.3-17.3.1">After receiving the above message from the peer: AGREEMENT.<a href="#section-4.3-17.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.3-18">When a connection process has failed before either party can send the CONCLUSION handshake,
the Handshake Type field will contain the appropriate error value for the rejected
connection. See the list of error codes in <a href="#hs-rej-reason" class="auto internal xref">Table 7</a>.<a href="#section-4.3-18" class="pilcrow">¶</a></p>
<span id="name-handshake-rejection-reason-"></span><div id="hs-rej-reason">
<table class="center" id="table-7">
          <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-handshake-rejection-reason-" class="selfRef">Handshake Rejection Reason codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Error</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1000</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_UNKNOWN</td>
              <td class="text-left" rowspan="1" colspan="1">Unknown reason</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1001</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_SYSTEM</td>
              <td class="text-left" rowspan="1" colspan="1">System function error</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1002</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_PEER</td>
              <td class="text-left" rowspan="1" colspan="1">Rejected by peer</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1003</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_RESOURCE</td>
              <td class="text-left" rowspan="1" colspan="1">Resource allocation problem</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1004</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_ROGUE</td>
              <td class="text-left" rowspan="1" colspan="1">incorrect data in handshake</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1005</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_BACKLOG</td>
              <td class="text-left" rowspan="1" colspan="1">listener's backlog exceeded</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1006</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_IPE</td>
              <td class="text-left" rowspan="1" colspan="1">internal program error</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1007</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_CLOSE</td>
              <td class="text-left" rowspan="1" colspan="1">socket is closing</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1008</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_VERSION</td>
              <td class="text-left" rowspan="1" colspan="1">peer is older version than agent's min</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1009</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_RDVCOOKIE</td>
              <td class="text-left" rowspan="1" colspan="1">rendezvous cookie collision</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1010</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_BADSECRET</td>
              <td class="text-left" rowspan="1" colspan="1">wrong password</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1011</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_UNSECURE</td>
              <td class="text-left" rowspan="1" colspan="1">password required or unexpected</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1012</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_MESSAGEAPI</td>
              <td class="text-left" rowspan="1" colspan="1">Stream flag collision</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1013</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_CONGESTION</td>
              <td class="text-left" rowspan="1" colspan="1">incompatible congestion-controller type</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1014</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_FILTER</td>
              <td class="text-left" rowspan="1" colspan="1">incompatible packet filter</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1015</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_GROUP</td>
              <td class="text-left" rowspan="1" colspan="1">incompatible group</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1016</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_TIMEOUT</td>
              <td class="text-left" rowspan="1" colspan="1">timeout expired</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1017</td>
              <td class="text-left" rowspan="1" colspan="1">SRT_REJ_CRYPTO</td>
              <td class="text-left" rowspan="1" colspan="1">incompatible cryptographic mode</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.3-20">The specification of the cipher family and block size is decided by the data Sender.
When the transmission is bidirectional, this value MUST be agreed upon at the outset
because when both are set the Responder wins. For Caller-Listener connections it is
reasonable to set this value on the Listener only. In the case of Rendezvous the only
reasonable approach is to decide upon the correct value from the different sources and to
set it on both parties (note that <strong>AES-128</strong> is the default).<a href="#section-4.3-20" class="pilcrow">¶</a></p>
<div id="caller-listener-handshake">
<section id="section-4.3.1">
          <h4 id="name-caller-listener-handshake">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-caller-listener-handshake" class="section-name selfRef">Caller-Listener Handshake</a>
          </h4>
<p id="section-4.3.1-1">This section describes the handshaking process where a Listener is
waiting for an incoming Handshake request on a bound UDP port from a Caller.
The process has two phases: induction and conclusion.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<div id="the-induction-phase">
<section id="section-4.3.1.1">
            <h5 id="name-the-induction-phase">
<a href="#section-4.3.1.1" class="section-number selfRef">4.3.1.1. </a><a href="#name-the-induction-phase" class="section-name selfRef">The Induction Phase</a>
            </h5>
<p id="section-4.3.1.1-1">The INDUCTION phase serves only to set a cookie on the Listener so that it
doesn't allocate resources, thus mitigating a potential DoS attack that might be
perpetrated by flooding the Listener with handshake commands.<a href="#section-4.3.1.1-1" class="pilcrow">¶</a></p>
<div id="the-induction-request">
<section id="section-4.3.1.1.1">
              <h6 id="name-the-induction-request">
<a href="#section-4.3.1.1.1" class="section-number selfRef">4.3.1.1.1. </a><a href="#name-the-induction-request" class="section-name selfRef">The Induction Request</a>
              </h6>
<p id="section-4.3.1.1.1-1">The Caller begins by sending the INDUCTION handshake which contains the following
significant fields:<a href="#section-4.3.1.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1.1.1-2.1">
                  <p id="section-4.3.1.1.1-2.1.1">Destination SRT Socket ID: 0.<a href="#section-4.3.1.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.1-2.2">
                  <p id="section-4.3.1.1.1-2.2.1">HS Version: MUST always be 4.<a href="#section-4.3.1.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.1-2.3">
                  <p id="section-4.3.1.1.1-2.3.1">Encryption Field: 0.<a href="#section-4.3.1.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.1-2.4">
                  <p id="section-4.3.1.1.1-2.4.1">Extension Field: 2<a href="#section-4.3.1.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.1-2.5">
                  <p id="section-4.3.1.1.1-2.5.1">Handshake Type: INDUCTION<a href="#section-4.3.1.1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.1-2.6">
                  <p id="section-4.3.1.1.1-2.6.1">SRT Socket ID: SRT Socket ID of the Caller<a href="#section-4.3.1.1.1-2.6.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.1-2.7">
                  <p id="section-4.3.1.1.1-2.7.1">SYN Cookie: 0.<a href="#section-4.3.1.1.1-2.7.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.1-2.8">
                  <p id="section-4.3.1.1.1-2.8.1">There MUST be no HS extensions.<a href="#section-4.3.1.1.1-2.8.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-4.3.1.1.1-3">The Destination SRT Socket ID of the SRT packet header in this message is 0, which is
interpreted as a connection request.<a href="#section-4.3.1.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1.1-4">The handshake version number is set to 4 in this initial handshake.
This is due to the initial design of SRT that was to be compliant with the UDT
protocol <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span> on which it is based.<a href="#section-4.3.1.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-induction-response">
<section id="section-4.3.1.1.2">
              <h6 id="name-the-induction-response">
<a href="#section-4.3.1.1.2" class="section-number selfRef">4.3.1.1.2. </a><a href="#name-the-induction-response" class="section-name selfRef">The Induction Response</a>
              </h6>
<p id="section-4.3.1.1.2-1">The Listener responds with the following:<a href="#section-4.3.1.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1.1.2-2.1">
                  <p id="section-4.3.1.1.2-2.1.1">HS Version: 5.<a href="#section-4.3.1.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.2-2.2">
                  <p id="section-4.3.1.1.2-2.2.1">Encryption Field: Advertised cipher family and block size.<a href="#section-4.3.1.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.2-2.3">
                  <p id="section-4.3.1.1.2-2.3.1">Extension Field: SRT magic code 0x4A17.<a href="#section-4.3.1.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.2-2.4">
                  <p id="section-4.3.1.1.2-2.4.1">Handshake Type: INDUCTION<a href="#section-4.3.1.1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.2-2.5">
                  <p id="section-4.3.1.1.2-2.5.1">SRT Socket ID: Socket ID of the Listener<a href="#section-4.3.1.1.2-2.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.2-2.6">
                  <p id="section-4.3.1.1.2-2.6.1">SYN Cookie: a cookie that is crafted based on host, port and current time
with 1 minute accuracy to avoid SYN flooding attack <span>[<a href="#RFC4987" class="cite xref">RFC4987</a>]</span>.<a href="#section-4.3.1.1.2-2.6.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.1.2-2.7">
                  <p id="section-4.3.1.1.2-2.7.1">There MUST be no HS extensions.<a href="#section-4.3.1.1.2-2.7.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-4.3.1.1.2-3">At this point the Listener still does not know if the Caller is SRT or UDT,
and it responds with the same set of values regardless of whether the Caller is
SRT or UDT.<a href="#section-4.3.1.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1.2-4">A legacy UDT party completely ignores the values reported in the HS Version and the Handshake Type field.\
It is, however, interested in the SYN Cookie value, as this must be passed to the next
phase. It does interpret these fields, but only in the "conclusion" message.<a href="#section-4.3.1.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="the-conclusion-phase">
<section id="section-4.3.1.2">
            <h5 id="name-the-conclusion-phase">
<a href="#section-4.3.1.2" class="section-number selfRef">4.3.1.2. </a><a href="#name-the-conclusion-phase" class="section-name selfRef">The Conclusion Phase</a>
            </h5>
<div id="the-conclusion-request">
<section id="section-4.3.1.2.1">
              <h6 id="name-the-conclusion-request">
<a href="#section-4.3.1.2.1" class="section-number selfRef">4.3.1.2.1. </a><a href="#name-the-conclusion-request" class="section-name selfRef">The Conclusion Request</a>
              </h6>
<p id="section-4.3.1.2.1-1">The SRT caller receives the Induction Response from the SRT listener. The SRT caller MUST check the Induction response from the SRT listener.<a href="#section-4.3.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2.1-2">If the HS Version value is 5, the response came from SRT, and the handshake version 5 procedure is performed
as covered below.\
If the HS Version value is 4, the legacy handshake procedure can be applied if supported. The procedure is deprecated and is not covered here.
The caller MAY reject the connection with the <code>SRT_REJ_VERSION</code> reason. In this case there is nothing to send to the SRT listener, as there is no
connection established at this point.<a href="#section-4.3.1.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2.1-3">The Extension Flags field MUST contain the magic value 0x4A17. If it does not, the
connection MUST be rejected with rejection reason <code>SRT_REJ_ROGUE</code>. This is, among other things,
a contingency for the case when someone, in an attempt to extend UDT independently, increases the HS Version value to 5
and tries to test it against SRT. In this case there is nothing to send to the SRT listener, as there is no
connection established at this point.<a href="#section-4.3.1.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2.1-4">If the Encryption Flag field is set to 0 (not advertised), the caller MAY advertise its own cipher and key length.
If the induction response already advertises a certain value in the Encryption Flag, the caller MAY accept it or force its own value.
It is RECOMMENDED that if a caller will be sending the content, then it SHOULD force its own value. If it expects to receive content from the
SRT listener, then is it RECOMMENDED that it accepts the value advertised in the Encryption Flag field.<a href="#section-4.3.1.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2.1-5">An alternative behavior MAY be for a caller to take the longer key length in such cases.<a href="#section-4.3.1.2.1-5" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2.1-6">TODO: Receiver TSBPD Delay,  Sender TSBPD Delay.<a href="#section-4.3.1.2.1-6" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2.1-7">The SRT Caller forms a Conclusion Request. The following values of a Handshake packet MUST be set by the compliant Caller:<a href="#section-4.3.1.2.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1.2.1-8.1">
                  <p id="section-4.3.1.2.1-8.1.1">Destination SRT Socket ID: 0.<a href="#section-4.3.1.2.1-8.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.2.1-8.2">
                  <p id="section-4.3.1.2.1-8.2.1">HS Version: 5.<a href="#section-4.3.1.2.1-8.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.2.1-8.3">
                  <p id="section-4.3.1.2.1-8.3.1">Handshake Type: CONCLUSION.<a href="#section-4.3.1.2.1-8.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.2.1-8.4">
                  <p id="section-4.3.1.2.1-8.4.1">SRT Socket ID: Socket ID of the Caller.<a href="#section-4.3.1.2.1-8.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.2.1-8.5">
                  <p id="section-4.3.1.2.1-8.5.1">SYN Cookie: the Listener's cookie from the induction response.<a href="#section-4.3.1.2.1-8.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.2.1-8.6">
                  <p id="section-4.3.1.2.1-8.6.1">Encryption Flags: advertised cipher family and block size.<a href="#section-4.3.1.2.1-8.6.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.2.1-8.7">
                  <p id="section-4.3.1.2.1-8.7.1">Extension Flags: a set of flags that define the extensions provided in the handshake.<a href="#section-4.3.1.2.1-8.7.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1.2.1-8.8">
                  <p id="section-4.3.1.2.1-8.8.1">The Handshake Extension Message <a href="#handshake-extension-msg" class="auto internal xref">Section 3.2.1.1</a> MUST be present in the conclusion response.<a href="#section-4.3.1.2.1-8.8.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</section>
</div>
<div id="the-conclusion-response">
<section id="section-4.3.1.2.2">
              <h6 id="name-the-conclusion-response">
<a href="#section-4.3.1.2.2" class="section-number selfRef">4.3.1.2.2. </a><a href="#name-the-conclusion-response" class="section-name selfRef">The Conclusion Response</a>
              </h6>
<p id="section-4.3.1.2.2-1">The SRT Listener receives the conclusion request.
If the values of the conclusion request are in any way NOT acceptable on the SRT Listener side, the connection MUST
be rejected by sending a conclusion response with the Handshake Type field carrying the rejection reason (<a href="#hs-rej-reason" class="auto internal xref">Table 7</a>).<a href="#section-4.3.1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2.2-2">TODO: latency value. Special value 0.<a href="#section-4.3.1.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2.2-3">TODO: Incorrect?
The only case when the Listener can have precedence over the Caller
is the advertised Cipher Family and Block Size (see <a href="#handshake-encr-fld" class="auto internal xref">Table 2</a>)
in the Encryption Field of the Handshake.<a href="#section-4.3.1.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.1.2.2-4">The value for latency is always agreed to be the greater of those reported
by each party.<a href="#section-4.3.1.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1.2.2-5.1">
                  <p id="section-4.3.1.2.2-5.1.1">Destination SRT Socket ID: the SRT Socket ID field value of the previously received conclusion request.<a href="#section-4.3.1.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-4.3.1.2.2-6">There is no "negotiation" at this point.<a href="#section-4.3.1.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="rendezvous-handshake">
<section id="section-4.3.2">
          <h4 id="name-rendezvous-handshake">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-rendezvous-handshake" class="section-name selfRef">Rendezvous Handshake</a>
          </h4>
<p id="section-4.3.2-1">The Rendezvous process uses a state machine. It is slightly
different from UDT Rendezvous handshake <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span>,
although it is still based on the same message request types.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">The states of a party are Waving ("Wave A Hand"), Conclusion and Agreement.
The Waving stage is intended to exchange cookie values, perform the cookie contest and
deduce the role of each party: initiator or responder.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<div id="cookie-contest">
<section id="section-4.3.2.1">
            <h5 id="name-cookie-contest">
<a href="#section-4.3.2.1" class="section-number selfRef">4.3.2.1. </a><a href="#name-cookie-contest" class="section-name selfRef">Cookie Contest</a>
            </h5>
<p id="section-4.3.2.1-1">The cookie contest is intended to determine the connection role of a peer.
When one party's cookie value is greater (with certain conditions, see below)
than its peer's, it wins the cookie contest and becomes Initiator
(the other party becomes the Responder).<a href="#section-4.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.1-2">The intent is to let the side with the greater cookie value become the Initiator
(the other party becomes the Responder). However, with a special handling
of the higher bit of the difference.<a href="#section-4.3.2.1-2" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-4.3.2.1-3">
<pre>&lt;CODE BEGINS&gt;
enum ContestResult
{
  DRAW,
  RESPONDER,
  INITIATOR
};

ContestResult CookieContest(int32_t host, int32_t peer)
{
  // peer - Requestor-side (peer) cookie value.
  // host - Responder-side (host) cookie value.
  int64_t contest = int64_t(peer) - int64_t(host);

  if ((contest &amp; 0xFFFFFFFF) == 0)
    return DRAW;

  if (contest &amp; 0x80000000)
    return RESPONDER;

  return INITIATOR;
}

&lt;CODE ENDS&gt;</pre><a href="#section-4.3.2.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="waving-state">
<section id="section-4.3.2.2">
            <h5 id="name-the-waving-state">
<a href="#section-4.3.2.2" class="section-number selfRef">4.3.2.2. </a><a href="#name-the-waving-state" class="section-name selfRef">The Waving State</a>
            </h5>
<p id="section-4.3.2.2-1">Both parties start in a Waving state.
In the Waving state, the parties wishing to connect -- Bob and Alice -- each send a WAVEAHAND handshake packet
with the fields set to the following values:<a href="#section-4.3.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-2.1">
                <p id="section-4.3.2.2-2.1.1">HS Version: 5<a href="#section-4.3.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.2-2.2">
                <p id="section-4.3.2.2-2.2.1">Type: Extension field: 0, Encryption field: advertised "PBKEYLEN"<a href="#section-4.3.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.2-2.3">
                <p id="section-4.3.2.2-2.3.1">Handshake Type: WAVEAHAND (<a href="#handshake-type" class="auto internal xref">Table 4</a>)<a href="#section-4.3.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.2-2.4">
                <p id="section-4.3.2.2-2.4.1">SRT Socket ID: socket ID of the party (HS sender).<a href="#section-4.3.2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.2-2.5">
                <p id="section-4.3.2.2-2.5.1">SYN Cookie: Created based on host/port and current time.<a href="#section-4.3.2.2-2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.2-2.6">
                <p id="section-4.3.2.2-2.6.1">HS Extensions: none.<a href="#section-4.3.2.2-2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.3.2.2-3">Legacy HS Version 4 clients do not look at the HS Version value,
whereas HS Version 5 clients can detect version 5.
The parties only continue with the HS Version 5 Rendezvous process when HS Version is set to 5
for both. Otherwise the process continues exclusively according to HS Version 4 rules <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span>.
Implementations MUST support HS Version 5, and MAY not support HS Version 4.<a href="#section-4.3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.2.2-4">The WAVEAHAND Handshake packet SHOULD not have extensions.<a href="#section-4.3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2.2-5">With SRT Handshake Version 5 Rendezvous, both parties create a cookie for a process called the
"cookie contest". This is necessary for the assignment of Initiator and Responder
roles. Each party generates a cookie value (a 32-bit number) based on the host,
port, and current time with 1 minute accuracy. This value is scrambled using
an MD5 sum calculation. The cookie values are then compared with one another.<a href="#section-4.3.2.2-5" class="pilcrow">¶</a></p>
<p id="section-4.3.2.2-6">Since it is impossible to have two sockets on the same machine bound to the same NIC
and port and operating independently, it is virtually impossible that the
parties will generate identical cookies. However, this situation may occur if an
application tries to "connect to itself" - that is, either connects to a local
IP address, when the socket is bound to INADDR_ANY, or to the same IP address to
which the socket was bound. If the cookies are identical (for any reason), the
connection will not be made until new, unique cookies are generated (after a
delay of up to one minute). In the case of an application "connecting to itself",
the cookies will always be identical, and so the connection will never be established.<a href="#section-4.3.2.2-6" class="pilcrow">¶</a></p>
<p id="section-4.3.2.2-7">If there is no response from a peer the WAVEAHAND handshake SHOULD be repeated every 250 ms
until a connection timeout expires. The connection timeout value is defined by the implementation.<a href="#section-4.3.2.2-7" class="pilcrow">¶</a></p>
<p id="section-4.3.2.2-8">If a WAVEAHAND packet is received from the peer during a CONCLUSION handshake, the state is transitioned to the Attention state.<a href="#section-4.3.2.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conclusion-state">
<section id="section-4.3.2.3">
            <h5 id="name-conclusion">
<a href="#section-4.3.2.3" class="section-number selfRef">4.3.2.3. </a><a href="#name-conclusion" class="section-name selfRef">Conclusion</a>
            </h5>
<p id="section-4.3.2.3-1">In the Conclusion state each peer has received and now knows the other's cookie value.
Thus each peer can perform the Cookie Contest operation
(compare both cookie values according to <a href="#cookie-contest" class="auto internal xref">Section 4.3.2.1</a>)
and thereby determine its role.
The determination of the Handshake Role (Initiator or Responder) is essential for further processing.<a href="#section-4.3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.3-2">Initiator replies with a Conclusion request handshake:<a href="#section-4.3.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.3-3.1">
                <p id="section-4.3.2.3-3.1.1">HS Version: 5<a href="#section-4.3.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.3-3.2">
                <p id="section-4.3.2.3-3.2.1">Extension field: appropriate flags.<a href="#section-4.3.2.3-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.3-3.3">
                <p id="section-4.3.2.3-3.3.1">Encryption field: advertised PBKEYLEN<a href="#section-4.3.2.3-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.3-3.4">
                <p id="section-4.3.2.3-3.4.1">Handshake Type: CONCLUSION.<a href="#section-4.3.2.3-3.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.3-3.5">
                <p id="section-4.3.2.3-3.5.1">Required Handshake Extension: HS Extension Message (<a href="#handshake-extension-msg" class="auto internal xref">Section 3.2.1.1</a>)
with HS Extension Type SRT_CMD_HSREQ.<a href="#section-4.3.2.3-3.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.3-3.6">
                <p id="section-4.3.2.3-3.6.1">Other handshake extensions are allowed.<a href="#section-4.3.2.3-3.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.3.2.3-4">If encryption is on, the Initiator (Bob) will use either his
own cipher family and block size or the one received from Alice (if she has advertised
those values).<a href="#section-4.3.2.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2.3-5">The Responder responds  with a Conclusion or a WAVEAHAND handshake without extensions until it receives the Conclusion Request from the peer:<a href="#section-4.3.2.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.3-6.1">
                <p id="section-4.3.2.3-6.1.1">HS Version: 5<a href="#section-4.3.2.3-6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.3-6.2">
                <p id="section-4.3.2.3-6.2.1">Extension field: 0.<a href="#section-4.3.2.3-6.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.3-6.3">
                <p id="section-4.3.2.3-6.3.1">Encryption field: advertised PBKEYLEN.<a href="#section-4.3.2.3-6.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.3-6.4">
                <p id="section-4.3.2.3-6.4.1">Handshake Type: CONCLUSION.<a href="#section-4.3.2.3-6.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3.2.3-6.5">
                <p id="section-4.3.2.3-6.5.1">Handshake extensions are NOT allowed.<a href="#section-4.3.2.3-6.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.3.2.3-7">TODO: What to do if WAVEAHAND or AGREEMENT or else is received in this stage?
Repeat conclusion response but not more often that every 250 ms.<a href="#section-4.3.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initiated">
<section id="section-4.3.2.4">
            <h5 id="name-initiated">
<a href="#section-4.3.2.4" class="section-number selfRef">4.3.2.4. </a><a href="#name-initiated" class="section-name selfRef">Initiated</a>
            </h5>
<p id="section-4.3.2.4-1">Alice receives Bob's CONCLUSION message. While at this point she also
   performs the "cookie contest" operation, the outcome will be the same. She switches to the
   "fine" state, and sends:
   - Version: 5
   - Appropriate extension flags and encryption flags
   - Handshake Type: CONCLUSION<a href="#section-4.3.2.4-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.4-2">Both parties always send extension flags at this point, which will
   contain HSREQ if the message comes from an Initiator, or
   HSRSP if it comes from a Responder. If the Initiator has received a
   previous message from the Responder containing an advertised cipher family and block size in the
   encryption flags field, it will be used as the key length
   for key generation sent next in the KMREQ extension.<a href="#section-4.3.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="serial-handshake-flow">
<section id="section-4.3.2.5">
            <h5 id="name-serial-handshake-flow">
<a href="#section-4.3.2.5" class="section-number selfRef">4.3.2.5. </a><a href="#name-serial-handshake-flow" class="section-name selfRef">Serial Handshake Flow</a>
            </h5>
<p id="section-4.3.2.5-1">In the serial handshake flow, one party is always first, and the other follows.
That is, while both parties are repeatedly sending WAVEAHAND messages, at
some point one party - let's say Alice - will find she has received a
WAVEAHAND message before she can send her next one, so she sends a
CONCLUSION message in response. Meantime, Bob (Alice's peer) has missed
Alice's WAVEAHAND messages, so that Alice's CONCLUSION is the first message
Bob has received from her.<a href="#section-4.3.2.5-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.5-2">This process can be described easily as a series of exchanges between the first
and following parties (Alice and Bob, respectively):<a href="#section-4.3.2.5-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.5-3">
<li id="section-4.3.2.5-3.1">
                <p id="section-4.3.2.5-3.1.1">Initially, both parties are in the waving state. Alice sends a handshake
message to Bob:<a href="#section-4.3.2.5-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.5-3.1.2.1">
                    <p id="section-4.3.2.5-3.1.2.1.1">Version: 5<a href="#section-4.3.2.5-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.1.2.2">
                    <p id="section-4.3.2.5-3.1.2.2.1">Type: Extension field: 0, Encryption field: advertised "PBKEYLEN"<a href="#section-4.3.2.5-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.1.2.3">
                    <p id="section-4.3.2.5-3.1.2.3.1">Handshake Type: WAVEAHAND<a href="#section-4.3.2.5-3.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.1.2.4">
                    <p id="section-4.3.2.5-3.1.2.4.1">SRT Socket ID: Alice's socket ID<a href="#section-4.3.2.5-3.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.1.2.5">
                    <p id="section-4.3.2.5-3.1.2.5.1">SYN Cookie: Created based on host/port and current time.<a href="#section-4.3.2.5-3.1.2.5.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-4.3.2.5-3.1.3">
While Alice does not yet know if she is sending this message to
a Version 4 or Version 5 peer, the values from these fields would not be interpreted by
the Version 4 peer when the Handshake Type is WAVEAHAND.<a href="#section-4.3.2.5-3.1.3" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.3.2.5-3.2">
                <p id="section-4.3.2.5-3.2.1">Bob receives Alice's WAVEAHAND message, switches to the "attention"
state. Since Bob now knows Alice's cookie, he performs a "cookie contest"
(compares both cookie values). If Bob's cookie is greater than Alice's, he will
become the Initiator. Otherwise, he will become the Responder.<a href="#section-4.3.2.5-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.5-3.2.2">
The resolution of the Handshake Role
(Initiator or Responder) is essential for further processing.<a href="#section-4.3.2.5-3.2.2" class="pilcrow">¶</a></p>
<p id="section-4.3.2.5-3.2.3">
Then Bob responds:<a href="#section-4.3.2.5-3.2.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.5-3.2.4.1">
                    <p id="section-4.3.2.5-3.2.4.1.1">Version: 5<a href="#section-4.3.2.5-3.2.4.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.2.4.2">
                    <p id="section-4.3.2.5-3.2.4.2.1">Extension field: appropriate flags if Initiator, otherwise 0<a href="#section-4.3.2.5-3.2.4.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.2.4.3">
                    <p id="section-4.3.2.5-3.2.4.3.1">Encryption field: advertised PBKEYLEN<a href="#section-4.3.2.5-3.2.4.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.2.4.4">
                    <p id="section-4.3.2.5-3.2.4.4.1">Handshake Type: CONCLUSION.<a href="#section-4.3.2.5-3.2.4.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-4.3.2.5-3.2.5">
If Bob is the Initiator and encryption is on, he will use either his
own cipher family and block size or the one received from Alice (if she has advertised
those values).<a href="#section-4.3.2.5-3.2.5" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.3.2.5-3.3">
                <p id="section-4.3.2.5-3.3.1">Alice receives Bob's CONCLUSION message. While at this point she also
performs the "cookie contest", the outcome will be the same. She switches to the
"fine" state, and sends:<a href="#section-4.3.2.5-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.5-3.3.2.1">
                    <p id="section-4.3.2.5-3.3.2.1.1">Version: 5<a href="#section-4.3.2.5-3.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.3.2.2">
                    <p id="section-4.3.2.5-3.3.2.2.1">Appropriate extension flags and encryption flags<a href="#section-4.3.2.5-3.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.3.2.3">
                    <p id="section-4.3.2.5-3.3.2.3.1">Handshake Type: CONCLUSION.<a href="#section-4.3.2.5-3.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-4.3.2.5-3.3.3">
Both parties always send extension flags at this point, which will
contain HSREQ if the message comes from an Initiator, or
HSRSP if it comes from a Responder. If the Initiator has received a
previous message from the Responder containing an advertised cipher family and block size in the
encryption flags field, it will be used as the key length
for key generation sent next in the KMREQ extension.<a href="#section-4.3.2.5-3.3.3" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.3.2.5-3.4">
                <p id="section-4.3.2.5-3.4.1">Bob receives Alice's CONCLUSION message, and then does one of the
following (depending on Bob's role):<a href="#section-4.3.2.5-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.5-3.4.2.1">
                    <p id="section-4.3.2.5-3.4.2.1.1">If Bob is the Initiator (Alice's message contains HSRSP), he:<a href="#section-4.3.2.5-3.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.5-3.4.2.1.2.1">
                        <p id="section-4.3.2.5-3.4.2.1.2.1.1">switches to the "connected" state, and<a href="#section-4.3.2.5-3.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.3.2.5-3.4.2.1.2.2">
                        <p id="section-4.3.2.5-3.4.2.1.2.2.1">sends Alice a message with Handshake Type AGREEMENT, but containing
no SRT extensions (Extension Flags field should be 0).<a href="#section-4.3.2.5-3.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                  <li class="normal" id="section-4.3.2.5-3.4.2.2">
                    <p id="section-4.3.2.5-3.4.2.2.1">If Bob is the Responder (Alice's message contains HSREQ), he:<a href="#section-4.3.2.5-3.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.5-3.4.2.2.2.1">
                        <p id="section-4.3.2.5-3.4.2.2.2.1.1">switches to "initiated" state,<a href="#section-4.3.2.5-3.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.3.2.5-3.4.2.2.2.2">
                        <p id="section-4.3.2.5-3.4.2.2.2.2.1">sends Alice a message with Handshake Type CONCLUSION that also contains
extensions with HSRSP, and<a href="#section-4.3.2.5-3.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-4.3.2.5-3.4.2.2.2.3">
                        <p id="section-4.3.2.5-3.4.2.2.2.3.1">awaits a confirmation from Alice that she is also connected (preferably
by AGREEMENT message).<a href="#section-4.3.2.5-3.4.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li id="section-4.3.2.5-3.5">
                <p id="section-4.3.2.5-3.5.1">Alice receives the above message, enters into the "connected" state, and
then does one of the following (depending on Alice's role):<a href="#section-4.3.2.5-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.5-3.5.2.1">
                    <p id="section-4.3.2.5-3.5.2.1.1">If Alice is the Initiator (received CONCLUSION with HSRSP),
she sends Bob a message with Handshake Type = AGREEMENT.<a href="#section-4.3.2.5-3.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.5-3.5.2.2">
                    <p id="section-4.3.2.5-3.5.2.2.1">If Alice is the Responder, the received message has Handshake Type AGREEMENT
and in response she does nothing.<a href="#section-4.3.2.5-3.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-4.3.2.5-3.6">
                <p id="section-4.3.2.5-3.6.1">At this point, if Bob was an Initiator, he is connected already. If he was a
Responder, he should receive the above AGREEMENT message, after which he
switches to the "connected" state. In the case where the UDP packet with the
agreement message gets lost, Bob will still enter the "connected" state once
he receives anything else from Alice. If Bob is going to send, however, he
has to continue sending the same CONCLUSION until he gets the confirmation
from Alice.<a href="#section-4.3.2.5-3.6.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
<div id="parallel-handshake-flow">
<section id="section-4.3.2.6">
            <h5 id="name-parallel-handshake-flow">
<a href="#section-4.3.2.6" class="section-number selfRef">4.3.2.6. </a><a href="#name-parallel-handshake-flow" class="section-name selfRef">Parallel Handshake Flow</a>
            </h5>
<p id="section-4.3.2.6-1">The chances of the parallel handshake flow are very low, but still it may
occur if the handshake messages with WAVEAHAND are sent and received by both peers
at precisely the same time.<a href="#section-4.3.2.6-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.6-2">The resulting flow is very much like Bob's behaviour in the serial handshake flow,
but for both parties. Alice and Bob will go through the same state transitions:<a href="#section-4.3.2.6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.2.6-3">
<pre>
Waving -&gt; Attention -&gt; Initiated -&gt; Connected
</pre><a href="#section-4.3.2.6-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2.6-4">In the Attention state they know each other's cookies, so they can assign
roles. In contrast to serial flows,
which are mostly based on request-response cycles, here everything
happens completely asynchronously: the state switches upon reception
of a particular handshake message with appropriate contents (the
Initiator MUST attach the HSREQ extension, and Responder MUST attach the
<code>HSRSP</code> extension).<a href="#section-4.3.2.6-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2.6-5">Here is how the parallel handshake flow works, based on roles and states:<a href="#section-4.3.2.6-5" class="pilcrow">¶</a></p>
<p id="section-4.3.2.6-6">(1) Initiator<a href="#section-4.3.2.6-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.6-7">
<li id="section-4.3.2.6-7.1">
                <p id="section-4.3.2.6-7.1.1">Waving<a href="#section-4.3.2.6-7.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.6-7.1.2.1">
                    <p id="section-4.3.2.6-7.1.2.1.1">Receives WAVEAHAND message,<a href="#section-4.3.2.6-7.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.6-7.1.2.2">
                    <p id="section-4.3.2.6-7.1.2.2.1">Switches to Attention,<a href="#section-4.3.2.6-7.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.6-7.1.2.3">
                    <p id="section-4.3.2.6-7.1.2.3.1">Sends CONCLUSION + HSREQ.<a href="#section-4.3.2.6-7.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-4.3.2.6-7.2">
                <p id="section-4.3.2.6-7.2.1">Attention<a href="#section-4.3.2.6-7.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.6-7.2.2">
Receives CONCLUSION message which<a href="#section-4.3.2.6-7.2.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.6-7.2.3.1">
                    <p id="section-4.3.2.6-7.2.3.1.1">either contains no extensions, then switches to Initiated, still sends CONCLUSION + HSREQ; or<a href="#section-4.3.2.6-7.2.3.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.6-7.2.3.2">
                    <p id="section-4.3.2.6-7.2.3.2.1">contains <code>HSRSP</code> extension, then switches to Connected, sends AGREEMENT.<a href="#section-4.3.2.6-7.2.3.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-4.3.2.6-7.3">
                <p id="section-4.3.2.6-7.3.1">Initiated<a href="#section-4.3.2.6-7.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.6-7.3.2">
Receives CONCLUSION message, which<a href="#section-4.3.2.6-7.3.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.6-7.3.3.1">
                    <p id="section-4.3.2.6-7.3.3.1.1">either contains no extensions, then REMAINS IN THIS STATE, still sends CONCLUSION + HSREQ; or<a href="#section-4.3.2.6-7.3.3.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.6-7.3.3.2">
                    <p id="section-4.3.2.6-7.3.3.2.1">contains <code>HSRSP</code> extension, then switches to Connected, sends AGREEMENT.<a href="#section-4.3.2.6-7.3.3.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-4.3.2.6-7.4">
                <p id="section-4.3.2.6-7.4.1">Connected<a href="#section-4.3.2.6-7.4.1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.6-7.4.2">
May receive CONCLUSION and respond with AGREEMENT, but normally
by now it should already have received payload packets.<a href="#section-4.3.2.6-7.4.2" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-4.3.2.6-8">(2) Responder<a href="#section-4.3.2.6-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.6-9">
<li id="section-4.3.2.6-9.1">
                <p id="section-4.3.2.6-9.1.1">Waving<a href="#section-4.3.2.6-9.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.6-9.1.2.1">
                    <p id="section-4.3.2.6-9.1.2.1.1">Receives WAVEAHAND message,<a href="#section-4.3.2.6-9.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.6-9.1.2.2">
                    <p id="section-4.3.2.6-9.1.2.2.1">Switches to Attention,<a href="#section-4.3.2.6-9.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.6-9.1.2.3">
                    <p id="section-4.3.2.6-9.1.2.3.1">Sends CONCLUSION message (with no extensions).<a href="#section-4.3.2.6-9.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-4.3.2.6-9.2">
                <p id="section-4.3.2.6-9.2.1">Attention<a href="#section-4.3.2.6-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.6-9.2.2.1">
                    <p id="section-4.3.2.6-9.2.2.1.1">Receives CONCLUSION message with HSREQ.
This message might contain no extensions, in which case the party
SHALL simply send the empty CONCLUSION message, as before, and remain
in this state.<a href="#section-4.3.2.6-9.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.6-9.2.2.2">
                    <p id="section-4.3.2.6-9.2.2.2.1">Switches to Initiated and sends CONCLUSION message with HSRSP.<a href="#section-4.3.2.6-9.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-4.3.2.6-9.3">
                <p id="section-4.3.2.6-9.3.1">Initiated<a href="#section-4.3.2.6-9.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.6-9.3.2">
Receives:<a href="#section-4.3.2.6-9.3.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.6-9.3.3.1">
                    <p id="section-4.3.2.6-9.3.3.1.1">CONCLUSION message with HSREQ, then responds with CONCLUSION with HSRSP and remains in this state;<a href="#section-4.3.2.6-9.3.3.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.6-9.3.3.2">
                    <p id="section-4.3.2.6-9.3.3.2.1">AGREEMENT message, then responds with AGREEMENT and switches to Connected;<a href="#section-4.3.2.6-9.3.3.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-4.3.2.6-9.3.3.3">
                    <p id="section-4.3.2.6-9.3.3.3.1">Payload packet, then responds with AGREEMENT and switches to Connected.<a href="#section-4.3.2.6-9.3.3.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li id="section-4.3.2.6-9.4">
                <p id="section-4.3.2.6-9.4.1">Connected<a href="#section-4.3.2.6-9.4.1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.6-9.4.2">
Is not expecting to receive any handshake messages anymore. The
AGREEMENT message is always sent only once or per every final
CONCLUSION message.<a href="#section-4.3.2.6-9.4.2" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-4.3.2.6-10">Note that any of these packets may be missing, and the sending party will
never become aware. The missing packet problem is resolved this way:<a href="#section-4.3.2.6-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2.6-11">
<li id="section-4.3.2.6-11.1">
                <p id="section-4.3.2.6-11.1.1">If the Responder misses the CONCLUSION + HSREQ message, it simply
continues sending empty CONCLUSION messages. Only upon reception of
CONCLUSION + HSREQ it does respond with CONCLUSION + HSRSP.<a href="#section-4.3.2.6-11.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.3.2.6-11.2">
                <p id="section-4.3.2.6-11.2.1">If the Initiator misses the CONCLUSION + HSRSP response from the
Responder, it continues sending CONCLUSION + HSREQ. The Responder MUST
always respond with CONCLUSION + HSRSP when the Initiator sends
CONCLUSION + HSREQ, even if it has already received and interpreted it.<a href="#section-4.3.2.6-11.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.3.2.6-11.3">
                <p id="section-4.3.2.6-11.3.1">When the Initiator switches to the Connected state it responds with a
AGREEMENT message, which may be missed by the Responder. Nonetheless, the
Initiator may start sending data packets because it considers itself
connected - it does not know that the Responder has not yet switched
to the Connected state. Therefore it is exceptionally allowed that when
the Responder is in the Initiated state and receives a data packet
(or any control packet that is normally sent only between connected
parties) over this connection, it may switch to the Connected
state just as if it had received a AGREEMENT message.<a href="#section-4.3.2.6-11.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.3.2.6-11.4">
                <p id="section-4.3.2.6-11.4.1">If the the Initiator has already switched to the Connected state it will not
bother the Responder with any more handshake messages. But the Responder may be
completely unaware of that (having missed the AGREEMENT message from the
Initiator). Therefore it does not exit the connecting state, which means that it
continues sending CONCLUSION + HSRSP messages until it receives any
packet that will make it switch to the Connected state (normally
AGREEMENT). Only then does it exit the connecting state and the
application can start transmission.<a href="#section-4.3.2.6-11.4.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="srt-latency">
<section id="section-4.4">
        <h3 id="name-srt-buffer-latency">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-srt-buffer-latency" class="section-name selfRef">SRT Buffer Latency</a>
        </h3>
<p id="section-4.4-1">The SRT sender and receiver have buffers to store packets.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">On the sender, latency is the time that SRT holds a packet to give it a chance to be
delivered successfully while maintaining the rate of the sender at the receiver. If an
acknowledgment (ACK) is missing or late for more than the configured latency, the packet
is dropped from the sender buffer. A packet can be retransmitted as long as it remains
in the buffer for the duration of the latency window. On the receiver, packets are
delivered to an application from a buffer after the latency interval has passed. This
helps to recover from potential packet losses. See <a href="#tsbpd" class="auto internal xref">Section 4.5</a>,
<a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a> for details.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">Latency is a value, in milliseconds, that can cover the time to transmit
hundreds or even thousands of packets at high bitrate. Latency can be thought of as a
window that slides over time, during which a number of activities take place, such as
the reporting of acknowledged packets (ACKs) (<a href="#packet-acks" class="auto internal xref">Section 4.8.1</a>) and unacknowledged
packets (NAKs) (<a href="#packet-naks" class="auto internal xref">Section 4.8.2</a>).<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">Latency is configured through the exchange of capabilities during the extended handshake
process between initiator and responder. The Handshake Extension Message (<a href="#handshake-extension-msg" class="auto internal xref">Section 3.2.1.1</a>)
has TSBPD delay information, in milliseconds, from the SRT receiver and sender. The
latency for a connection will be established as the maximum value of latencies proposed
by the initiator and responder.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tsbpd">
<section id="section-4.5">
        <h3 id="name-timestamp-based-packet-deli">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-timestamp-based-packet-deli" class="section-name selfRef">Timestamp-Based Packet Delivery</a>
        </h3>
<p id="section-4.5-1">The goal of the SRT Timestamp-Based Packet Delivery (TSBPD) mechanism is to reproduce
the output of the sending application (e.g., encoder) at the input of the receiving
application (e.g., decoder) in the case of live streaming (<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>, <a href="#live-streaming-use-case" class="auto internal xref">Section 7.1</a>).
It attempts to reproduce the timing of packets committed by the sending application to
the SRT sender. This allows packets to be scheduled for delivery by the SRT receiver,
making them ready to be read by the receiving application (see <a href="#fig-latency-points" class="auto internal xref">Figure 21</a>).<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">The SRT receiver, using the timestamp of the SRT data packet header, delivers packets to
a receiving application with a fixed minimum delay from the time the packet was scheduled
for sending on the SRT sender side. Basically, the sender timestamp in the received packet
is adjusted to the receiver’s local time (compensating for the time drift or different
time zones) before releasing the packet to the application. Packets can be withheld by
the SRT receiver for a configured receiver delay. A higher delay can accommodate a larger
uniform packet drop rate, or a larger packet burst drop. Packets received after their
"play time" are dropped if the Too-Late Packet Drop feature is enabled
(<a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a>).
For example, in the case of live video streaming, TSBPD and Too-Late Packet Drop mechanisms
allow to intentionally drop those packets that were lost and have no chance to be retransmitted
before their play time. Thus, SRT provides a fixed end-to-end latency of the stream.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">The packet timestamp, in microseconds, is relative to the SRT connection creation time.
Packets are inserted based on the sequence number in the header field. The origin time,
in microseconds, of the packet is already sampled when a packet is first submitted by
the application to the SRT sender unless explicitly provided. The TSBPD feature uses this time to stamp the packet
for first transmission and any subsequent retransmission. This timestamp and the
configured SRT latency (<a href="#srt-latency" class="auto internal xref">Section 4.4</a>) control the recovery buffer size and the
instant that packets are delivered at the destination (the aforementioned "play time"
which is decided by adding the timestamp to the configured latency).<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">It is worth mentioning that the use of the packet sending time to stamp the packets is
inappropriate for the TSBPD feature, since a new time (current sending time) is used for
retransmitted packets, putting them out of order when inserted at their proper place
in the stream.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5"><a href="#fig-latency-points" class="auto internal xref">Figure 21</a> illustrates the key latency points during the packet transmission
with the TSBPD feature enabled.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<span id="name-key-latency-points-during-t"></span><div id="fig-latency-points">
<figure id="figure-21">
          <div class="alignLeft art-text artwork" id="section-4.5-6.1">
<pre>
              |  Sending  |              |                   |
              |   Delay   |    ~RTT/2    |    SRT Latency    |
              |&lt;---------&gt;|&lt;------------&gt;|&lt;-----------------&gt;|
              |           |              |                   |
              |           |              |                   |
              |           |              |                   |
    ___ Scheduled       Sent         Received           Scheduled
   /    for sending       |              |              for delivery
Packet        |           |              |                   |
State         |           |              |                   |
              |           |              |                   |
              |           |              |                   |
              -----------------------------------------------------&gt;
                                                                Time
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-key-latency-points-during-t" class="selfRef">Key latency points during the packet transmission</a>
          </figcaption></figure>
</div>
<p id="section-4.5-7">The main packet states shown in <a href="#fig-latency-points" class="auto internal xref">Figure 21</a> are the following:<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-8.1">
            <p id="section-4.5-8.1.1">"Scheduled for sending": the packet is committed by the sending application, stamped and ready to be sent;<a href="#section-4.5-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-8.2">
            <p id="section-4.5-8.2.1">"Sent": the packet is passed to the UDP socket and sent;<a href="#section-4.5-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-8.3">
            <p id="section-4.5-8.3.1">"Received": the packet is received and read from the UDP socket;<a href="#section-4.5-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-8.4">
            <p id="section-4.5-8.4.1">"Scheduled for delivery": the packet is scheduled for the delivery
and ready to be read by the receiving application.<a href="#section-4.5-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.5-9">It is worth noting that the round-trip time (RTT) of an SRT link may
vary in time. However the actual end-to-end latency on the link becomes
fixed and is approximately equal to (RTT_0/2 + SRT Latency) once the SRT handshake exchange happens,
where RTT_0 is the actual value of the round-trip time during the SRT handshake
exchange (the value of the round-trip time once the SRT connection has been established).<a href="#section-4.5-9" class="pilcrow">¶</a></p>
<p id="section-4.5-10">The value of sending delay depends on the hardware performance. Usually
it is relatively small (several microseconds) in contrast to RTT_0/2
and SRT latency which are measured in milliseconds.<a href="#section-4.5-10" class="pilcrow">¶</a></p>
<div id="packet-delivery-time">
<section id="section-4.5.1">
          <h4 id="name-packet-delivery-time">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-packet-delivery-time" class="section-name selfRef">Packet Delivery Time</a>
          </h4>
<p id="section-4.5.1-1">Packet delivery time is the moment, estimated by the receiver, when a packet should be delivered
to the upstream application. The calculation of packet delivery time (PktTsbpdTime) is performed
upon receiving a data packet according to the following formula:<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-2">
<pre>
PktTsbpdTime = TsbpdTimeBase + PKT_TIMESTAMP + TsbpdDelay + Drift
</pre><a href="#section-4.5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1-3">where<a href="#section-4.5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.1-4.1">
              <p id="section-4.5.1-4.1.1">TsbpdTimeBase is the time base that reflects the time difference between local clock of the receiver
and the clock used by the sender to timestamp packets being sent (see <a href="#tsbpd-time-base" class="auto internal xref">Section 4.5.1.1</a>);<a href="#section-4.5.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.1-4.2">
              <p id="section-4.5.1-4.2.1">PKT_TIMESTAMP is the data packet timestamp, in microseconds;<a href="#section-4.5.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.1-4.3">
              <p id="section-4.5.1-4.3.1">TsbpdDelay is the receiver’s buffer delay (or receiver’s buffer latency, or SRT Latency).
This is the time, in milliseconds, that SRT holds a packet from the moment it has been received till the time it
should be delivered to the upstream application;<a href="#section-4.5.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.1-4.4">
              <p id="section-4.5.1-4.4.1">Drift is the time drift used to adjust the fluctuations between sender and receiver clock, in microseconds.<a href="#section-4.5.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.5.1-5">SRT Latency (TsbpdDelay) should be a buffer time large enough to cover the unexpectedly
extended RTT time, and the time needed to retransmit the lost packet. The value of minimum TsbpdDelay
is negotiated during the SRT handshake exchange and is equal to 120 milliseconds. The recommended
value of TsbpdDelay is 3-4 times RTT.<a href="#section-4.5.1-5" class="pilcrow">¶</a></p>
<p id="section-4.5.1-6">It is worth noting that TsbpdDelay limits the number of packet retransmissions to a certain extent
making it impossible to retransmit packets endlessly. This is important for the case of live streaming (<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>, <a href="#live-streaming-use-case" class="auto internal xref">Section 7.1</a>).<a href="#section-4.5.1-6" class="pilcrow">¶</a></p>
<div id="tsbpd-time-base">
<section id="section-4.5.1.1">
            <h5 id="name-tsbpd-time-base-calculation">
<a href="#section-4.5.1.1" class="section-number selfRef">4.5.1.1. </a><a href="#name-tsbpd-time-base-calculation" class="section-name selfRef">TSBPD Time Base Calculation</a>
            </h5>
<p id="section-4.5.1.1-1">The initial value of TSBPD time base (TsbpdTimeBase) is calculated at the moment of
the second handshake request is received as follows:<a href="#section-4.5.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1.1-2">
<pre>
TsbpdTimeBase = T_NOW - HSREQ_TIMESTAMP
</pre><a href="#section-4.5.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1.1-3">where T_NOW is the current time according to the receiver clock;
HSREQ_TIMESTAMP is the handshake packet timestamp, in microseconds.<a href="#section-4.5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-4">The value of TsbpdTimeBase is approximately equal to the initial one-way delay of the link RTT_0/2,
where RTT_0 is the actual value of the round-trip time during the SRT handshake
exchange.<a href="#section-4.5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-5">During the transmission process, the value of TSBPD time base may be adjusted in two cases:<a href="#section-4.5.1.1-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.5.1.1-6">
<li id="section-4.5.1.1-6.1">
                <p id="section-4.5.1.1-6.1.1">During the TSBPD wrapping period.
The TSBPD wrapping period happens every 01:11:35 hours. This time corresponds
to the maximum timestamp value of a packet (MAX_TIMESTAMP). MAX_TIMESTAMP is equal
to 0xFFFFFFFF, or the maximum value of 32-bit unsigned integer, in microseconds (<a href="#packet-structure" class="auto internal xref">Section 3</a>).
The TSBPD wrapping period starts 30 seconds before reaching the maximum timestamp value
of a packet and ends once the packet with timestamp within (30, 60) seconds interval
is delivered (read from the buffer). The updated value of TsbpdTimeBase will be recalculated as follows:<a href="#section-4.5.1.1-6.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1.1-6.1.2">
<pre>
TsbpdTimeBase = TsbpdTimeBase + MAX_TIMESTAMP + 1
</pre><a href="#section-4.5.1.1-6.1.2" class="pilcrow">¶</a>
</div>
</li>
              <li id="section-4.5.1.1-6.2">
                <p id="section-4.5.1.1-6.2.1">By drift tracer. See <a href="#drift-management" class="auto internal xref">Section 4.7</a> for details.<a href="#section-4.5.1.1-6.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="too-late-packet-drop">
<section id="section-4.6">
        <h3 id="name-too-late-packet-drop">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-too-late-packet-drop" class="section-name selfRef">Too-Late Packet Drop</a>
        </h3>
<p id="section-4.6-1">The Too-Late Packet Drop (TLPKTDROP) mechanism allows the sender to drop packets that
have no chance to be delivered in time, and allows the receiver to skip missing packets
that have not been delivered in time. The timeout of dropping a packet is based on the
TSBPD mechanism (<a href="#tsbpd" class="auto internal xref">Section 4.5</a>).<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">When the TLPKTDROP mechanism is enabled, a packet is considered "too late" to be
delivered and may be dropped by the sender if the packet timestamp is older than
TLPKTDROP_THRESHOLD.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">TLPKTDROP_THRESHOLD is related to SRT latency (<a href="#srt-latency" class="auto internal xref">Section 4.4</a>). For the Too-Late Packet Drop mechanism to function effectively, it is recommended that a value higher than the SRT latency is used.
This will allow the SRT receiver to drop missing packets first while the sender drops packets if a proper response is not received from the peer in time (e.g., due to severe congestion).
The recommended threshold value is 1.25 times the SRT latency value.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">Note that the SRT sender keeps packets for at least 1 second in case the
latency is not high enough for a large RTT (that is, if TLPKTDROP_THRESHOLD is less
than 1 second).<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<p id="section-4.6-5">When enabled on the receiver, the receiver drops packets that have not been delivered
or retransmitted in time, and delivers the subsequent packets to the application when
it is their time to play.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
<p id="section-4.6-6">In pseudo-code, the algorithm of reading from the receiver buffer is
the following:<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-4.6-7">
<pre>&lt;CODE BEGINS&gt;
pos = 0;  /* Current receiver buffer position */
i = 0;    /* Position of the next available in the receiver buffer
             packet relatively to the current buffer position pos */

while(True) {
    // Get the position i of the next available packet
    // in the receiver buffer
    i = next_avail();
    // Calculate packet delivery time PktTsbpdTime
    // for the next available packet
    PktTsbpdTime = delivery_time(i);

    if T_NOW &lt; PktTsbpdTime:
        continue;

    Drop packets which buffer position number is less than i;

    Deliver packet with the buffer position i;

    pos = i + 1;
}

&lt;CODE ENDS&gt;</pre><a href="#section-4.6-7" class="pilcrow">¶</a>
</div>
<p id="section-4.6-8">where T_NOW is the current time according to the receiver clock.<a href="#section-4.6-8" class="pilcrow">¶</a></p>
<p id="section-4.6-9">When a receiver encounters the situation where the next packet to be played was not
successfully received from the sender, the receiver will "skip" this packet
and send a fake ACK packet (<a href="#packet-acks" class="auto internal xref">Section 4.8.1</a>). To the sender, this fake ACK is a real ACK,
and so it just behaves as if the packet had been received.
This facilitates the synchronization between SRT sender and receiver. The fact that a packet was
skipped remains unknown by the sender. It is recommended that skipped packets are recorded
in the statistics on the SRT receiver.<a href="#section-4.6-9" class="pilcrow">¶</a></p>
<p id="section-4.6-10">The TLPKTDROP mechanism can be turned off to always ensure a clean
delivery. However, a lost packet can simply pause a delivery for some
longer, potentially undefined time, and cause even worse tearing
for the player. Setting SRT latency higher will help much more in the event that TLPKTDROP causes packet drops too often.<a href="#section-4.6-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="drift-management">
<section id="section-4.7">
        <h3 id="name-drift-management">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-drift-management" class="section-name selfRef">Drift Management</a>
        </h3>
<p id="section-4.7-1">When the sender enters "connected" status it tells the application
there is a socket interface that is transmitter-ready. At this point
the application can start sending data packets. It adds packets to
the SRT sender's buffer at a certain input rate, from which they are
transmitted to the receiver at scheduled times.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">A synchronized time is required to keep proper sender/receiver buffer
levels, taking into account the time zone and round-trip time (up to
2 seconds for satellite links). Considering addition/subtraction
round-off, and possibly unsynchronized system times, an agreed-upon
time base drifts by a few microseconds every minute. The drift may
accumulate over many days to a point where the sender or receiver
buffers will overflow or deplete, seriously affecting the quality
of the video. SRT has a time management mechanism to compensate
for this drift.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">When a packet is received, SRT determines the difference between the
time it was expected and its timestamp. The timestamp is calculated on
the receiver side. The RTT tells the receiver how much time it was
supposed to take. SRT maintains a reference between the time at the
leading edge of the send buffer's latency window and the corresponding
time on the receiver (the present time). This allows to convert packet
timestamp to the local receiver time. Based on this time, various
events (packet delivery, etc.) can be scheduled.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">The receiver samples time drift data and periodically calculates a
packet timestamp correction factor, which is applied to each data
packet received by adjusting the inter-packet interval. When a
packet is received it is not given right away to the application.
As time advances, the receiver knows the expected time for any
missing or dropped packet, and can use this information to fill
any "holes" in the receive queue with another packet
(see <a href="#tsbpd" class="auto internal xref">Section 4.5</a>).<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<p id="section-4.7-5">It is worth noting that the period of sampling time drift data is based
on a number of packets rather than time duration to ensure enough
samples, independently of the media stream packet rate. The effect of
network jitter on the estimated time drift is attenuated by using a
large number of samples. The actual time drift being very slow (affecting a
stream only after many hours) does not require a fast reaction.<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<p id="section-4.7-6">The receiver uses local time to be able to schedule events — to
determine, for example, if it is time to deliver a certain packet
right away. The timestamps in the packets themselves are just
references to the beginning of the session. When a packet is received
(with a timestamp from the sender), the receiver makes a reference to
the beginning of the session to recalculate its timestamp. The start
time is derived from the local time at the moment that the session is
connected. A packet timestamp equals "now" minus "StartTime", where
the latter is the point in time when the socket was created.<a href="#section-4.7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgement-and-lost-packet-handling">
<section id="section-4.8">
        <h3 id="name-acknowledgement-and-lost-pa">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-acknowledgement-and-lost-pa" class="section-name selfRef">Acknowledgement and Lost Packet Handling</a>
        </h3>
<p id="section-4.8-1">To enable the Automatic Repeat reQuest of data packet retransmissions, a sender stores
all sent data packets in its buffer.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">The SRT receiver periodically sends acknowledgments (ACKs) for the
received data packets so that the SRT sender can remove the
acknowledged packets from its buffer (<a href="#packet-acks" class="auto internal xref">Section 4.8.1</a>). Once the acknowledged packets are
removed, their retransmission is no longer possible and presumably not needed.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<p id="section-4.8-3">Upon receiving the full acknowledgment (ACK) control packet, the SRT sender SHOULD acknowledge
its reception to the receiver by sending an ACKACK control packet with the sequence number
of the full ACK packet being acknowledged.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<p id="section-4.8-4">The SRT receiver also sends NAK control packets to notify the sender about the missing packets (<a href="#packet-naks" class="auto internal xref">Section 4.8.2</a>).
The sending of a NAK packet can be triggered immediately after a gap in sequence numbers of
data packets is detected. In addition, a Periodic NAK report mechanism can be used to
send NAK reports periodically. The NAK packet in that case will list all the packets that
the receiver considers being lost up to the moment the Periodic NAK report is sent.<a href="#section-4.8-4" class="pilcrow">¶</a></p>
<p id="section-4.8-5">Upon reception of the NAK packet, the SRT sender prioritizes retransmissions of lost packets over the regular data
packets to be transmitted for the first time.<a href="#section-4.8-5" class="pilcrow">¶</a></p>
<p id="section-4.8-6">The retransmission of the missing packet is repeated until the receiver acknowledges its receipt,
or if both peers agree to drop this packet (<a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a>).<a href="#section-4.8-6" class="pilcrow">¶</a></p>
<div id="packet-acks">
<section id="section-4.8.1">
          <h4 id="name-packet-acknowledgement-acks">
<a href="#section-4.8.1" class="section-number selfRef">4.8.1. </a><a href="#name-packet-acknowledgement-acks" class="section-name selfRef">Packet Acknowledgement (ACKs, ACKACKs)</a>
          </h4>
<p id="section-4.8.1-1">At certain intervals (see below), the SRT receiver sends an acknowledgment (ACK) that
causes the acknowledged packets to be removed from the SRT sender's buffer.<a href="#section-4.8.1-1" class="pilcrow">¶</a></p>
<p id="section-4.8.1-2">An ACK control packet contains the sequence number of the packet immediately
following the latest in the list of received packets. Where no packet loss has
occurred up to the packet with sequence number n, an ACK would include the sequence number (n + 1).<a href="#section-4.8.1-2" class="pilcrow">¶</a></p>
<p id="section-4.8.1-3">An ACK (from a receiver) will trigger the transmission of an ACKACK (by the sender), with almost no delay.
The time it takes for an ACK to be sent and an ACKACK to be received is the RTT.
The ACKACK tells the receiver to stop sending the ACK position because the sender already
knows it. Otherwise, ACKs (with outdated information) would continue to be sent regularly.
Similarly, if the sender does not receive an ACK, it does not stop transmitting.<a href="#section-4.8.1-3" class="pilcrow">¶</a></p>
<p id="section-4.8.1-4">There are two conditions for sending an acknowledgment. A full ACK is based on a timer of 10
milliseconds (the ACK period or synchronization time interval SYN). For high bitrate transmissions, a "light ACK" can be sent, which is an ACK
for a sequence of packets. In a 10 milliseconds interval, there are often so many packets being sent and
received that the ACK position on the sender does not advance quickly enough. To mitigate this,
after 64 packets (even if the ACK period has not fully elapsed) the receiver sends a light ACK.
A light ACK is a shorter ACK (SRT header  and one 32-bit field). It does not trigger an ACKACK.<a href="#section-4.8.1-4" class="pilcrow">¶</a></p>
<p id="section-4.8.1-5">When a receiver encounters the situation where the next packet to be played was not
successfully received from the sender, it will "skip" this packet (see <a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a>)
and send a fake ACK. To the sender, this fake ACK is a real ACK, and so it just behaves as if the packet had been received.
This facilitates the synchronization between SRT sender and receiver. The fact that a packet was
skipped remains unknown by the sender. Skipped packets are recorded in the statistics on the
SRT receiver.<a href="#section-4.8.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="packet-naks">
<section id="section-4.8.2">
          <h4 id="name-packet-retransmission-naks">
<a href="#section-4.8.2" class="section-number selfRef">4.8.2. </a><a href="#name-packet-retransmission-naks" class="section-name selfRef">Packet Retransmission (NAKs)</a>
          </h4>
<p id="section-4.8.2-1">The SRT receiver sends NAK control packets to notify the sender about the missing packets.
The NAK packet sending can be triggered immediately after a gap in sequence numbers of
data packets is detected.<a href="#section-4.8.2-1" class="pilcrow">¶</a></p>
<p id="section-4.8.2-2">Upon reception of the NAK packet, the SRT sender prioritizes retransmissions of lost packets over the regular data
packets to be transmitted for the first time.<a href="#section-4.8.2-2" class="pilcrow">¶</a></p>
<p id="section-4.8.2-3">The SRT sender maintains a list of lost packets (loss list) that is built from NAK reports. When
scheduling packet transmission, it looks to see if a packet in the loss list has priority and sends it if so.
Otherwise, it sends the next packet scheduled for the first transmission list.
Note that when a packet is transmitted, it stays in the buffer in case it is not received by the SRT receiver.<a href="#section-4.8.2-3" class="pilcrow">¶</a></p>
<p id="section-4.8.2-4">NAK packets are processed to fill in the loss list. As the latency window advances and packets are
dropped from the sending queue, a check is performed to see if any of the dropped or resent
packets are in the loss list, to determine if they can be removed from there as well so that they
are not retransmitted unnecessarily.<a href="#section-4.8.2-4" class="pilcrow">¶</a></p>
<p id="section-4.8.2-5">There is a counter for the packets that are resent. If there is no ACK
for a packet, it will stay in the loss list and can be resent more than
once. Packets in the loss list are prioritized.<a href="#section-4.8.2-5" class="pilcrow">¶</a></p>
<p id="section-4.8.2-6">If packets in the loss list continue to block the send queue, at some point this will cause the
send queue to fill. When the send queue is full, the sender will begin to drop packets without
even sending them the first time. An encoder (or other application) may continue to provide
packets, but there's no place for them, so they will end up being thrown away.<a href="#section-4.8.2-6" class="pilcrow">¶</a></p>
<p id="section-4.8.2-7">This condition where packets are unsent does not happen often. There is a maximum number of
packets held in the send buffer based on the configured latency. Older packets that have no
chance to be retransmitted and played in time are dropped, making room for newer real-time
packets produced by the sending application. See <a href="#tsbpd" class="auto internal xref">Section 4.5</a>, <a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a> for details.<a href="#section-4.8.2-7" class="pilcrow">¶</a></p>
<p id="section-4.8.2-8">In addition to the regular NAKs, the Periodic NAK report mechanism can be used to send NAK reports periodically.
The NAK packet in that case will have all the packets that the receiver considers being lost
at the time of sending the Periodic NAK report.<a href="#section-4.8.2-8" class="pilcrow">¶</a></p>
<p id="section-4.8.2-9">SRT Periodic NAK reports are sent with a period of
(RTT + 4 * RTTVar) / 2 (so called NAKInterval), with a 20 milliseconds
floor, where RTT and RTTVar are defined in <a href="#rtt" class="auto internal xref">Section 4.10</a>. A NAK control
packet contains a compressed list of the lost packets. Therefore, only
lost packets are retransmitted. By using NAKInterval for the NAK
reports period, it may happen that lost packets are retransmitted more
than once, but it helps maintain low latency in the case where NAK
packets are lost.<a href="#section-4.8.2-9" class="pilcrow">¶</a></p>
<p id="section-4.8.2-10">An ACKACK tells the receiver to stop sending the ACK position because the sender already
knows it. Otherwise, ACKs (with outdated information) would continue to be sent regularly.<a href="#section-4.8.2-10" class="pilcrow">¶</a></p>
<p id="section-4.8.2-11">An ACK serves as a ping, with a corresponding ACKACK pong, to measure RTT. The time it
takes for an ACK to be sent and an ACKACK to be received is the RTT. Each ACK has a number.
A corresponding ACKACK has that same number. The receiver keeps a list of all ACKs in a
queue to match them. Unlike a full ACK, which contains the current RTT and several other
values in the Control Information Field (CIF) (<a href="#ctrl-pkt-ack" class="auto internal xref">Section 3.2.4</a>),
a light ACK just contains the sequence number. All control messages
are sent directly and processed upon reception, but ACKACK processing time is negligible
(the time this takes is included in the round-trip time).<a href="#section-4.8.2-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bidirectional-transmission-queues">
<section id="section-4.9">
        <h3 id="name-bidirectional-transmission-">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-bidirectional-transmission-" class="section-name selfRef">Bidirectional Transmission Queues</a>
        </h3>
<p id="section-4.9-1">Once an SRT connection is established, both peers can send data packets simultaneously.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rtt">
<section id="section-4.10">
        <h3 id="name-round-trip-time-estimation">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-round-trip-time-estimation" class="section-name selfRef">Round-Trip Time Estimation</a>
        </h3>
<p id="section-4.10-1">Round-trip time (RTT) in SRT is estimated during the transmission of
data packets based on a difference in time between an ACK packet is
sent out and a corresponding ACKACK packet is received back by the
SRT receiver.<a href="#section-4.10-1" class="pilcrow">¶</a></p>
<p id="section-4.10-2">An ACK sent by the receiver triggers an ACKACK from the sender with
minimal processing delay. The ACKACK response is expected to arrive
at the receiver roughly one RTT after the corresponding ACK was sent.<a href="#section-4.10-2" class="pilcrow">¶</a></p>
<p id="section-4.10-3">The SRT receiver records the time when an ACK is sent out. The ACK
carries a unique sequence number (independent of the data packet
sequence number). The corresponding ACKACK also carries the same
sequence number. Upon receiving the ACKACK, SRT calculates the
RTT by comparing the difference between the ACKACK arrival
time and the ACK departure time. In the following formula,
RTT is the current value that the receiver maintains and rtt is the
recent value that was just calculated from an ACK/ACKACK pair:<a href="#section-4.10-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.10-4">
<pre>
RTT = 7/8 * RTT + 1/8 * rtt
</pre><a href="#section-4.10-4" class="pilcrow">¶</a>
</div>
<p id="section-4.10-5">RTT variance (RTTVar) is obtained as follows:<a href="#section-4.10-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.10-6">
<pre>
RTTVar = 3/4 * RTTVar + 1/4 * abs(RTT - rtt)
</pre><a href="#section-4.10-6" class="pilcrow">¶</a>
</div>
<p id="section-4.10-7">where abs() means an absolute value.<a href="#section-4.10-7" class="pilcrow">¶</a></p>
<p id="section-4.10-8">Both RTT and RTTVar are measured in microseconds. The initial value
of RTT is 100 milliseconds, RTTVar is 50 milliseconds.<a href="#section-4.10-8" class="pilcrow">¶</a></p>
<p id="section-4.10-9">The round-trip time (RTT) calculated by the receiver as well as the RTT variance
(RTTVar) are sent with the next full acknowledgement packet (see
<a href="#ctrl-pkt-ack" class="auto internal xref">Section 3.2.4</a>). Note that the first ACK in an SRT session might
contain an initial RTT value of 100 milliseconds, because the
early calculations may not be precise.<a href="#section-4.10-9" class="pilcrow">¶</a></p>
<p id="section-4.10-10">The sender always gets the RTT from the receiver. It does not have
an analog to the ACK/ACKACK mechanism, i.e. it can not send a message
that guarantees an immediate return without processing. Upon an ACK
reception, the SRT sender updates its own RTT and RTTVar values using
the same formulas as above, in which case rtt is the most recent value
it receives, i.e., carried by an incoming ACK.<a href="#section-4.10-10" class="pilcrow">¶</a></p>
<p id="section-4.10-11">Note that an SRT socket can both send and receive data packets. RTT
and RTTVar are updated by the socket based on algorithms for the sender
(using ACK packets) and for the receiver (using ACK/ACKACK pairs).
When an SRT socket receives data, it updates its local RTT and RTTVar,
which can be used for its own sender as well.<a href="#section-4.10-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="srt-packet-pacing-and-congestion-control">
<section id="section-5">
      <h2 id="name-srt-packet-pacing-and-conge">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-srt-packet-pacing-and-conge" class="section-name selfRef">SRT Packet Pacing and Congestion Control</a>
      </h2>
<p id="section-5-1">SRT provides certain mechanisms for exchanging feedback on the state of
packet transmission between sender and receiver. Every 10 milliseconds
the receiving side sends acknowledgement (ACK) packets (<a href="#ctrl-pkt-ack" class="auto internal xref">Section 3.2.4</a>)
to the sender that include the latest values of RTT, RTT variance, available
buffer size, receiving rate, and estimated link capacity. Similarly, NAK packets
(<a href="#ctrl-pkt-nak" class="auto internal xref">Section 3.2.5</a>) from the receiver inform the sender of any packet loss during
the transmission, triggering an appropriate response. These mechanisms provide
a solid background for the integration of various congestion control algorithms
in the SRT protocol.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">As SRT is designed both for live streaming and file
transmission (<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>), there are two groups of
congestion control algorithms defined in SRT: Live Congestion
Control (LiveCC), and File Transfer Congestion Control (FileCC).<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="liveCC">
<section id="section-5.1">
        <h3 id="name-srt-packet-pacing-and-live-">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-srt-packet-pacing-and-live-" class="section-name selfRef">SRT Packet Pacing and Live Congestion Control (LiveCC)</a>
        </h3>
<p id="section-5.1-1">To ensure smooth video playback on a receiving peer during
live streaming, SRT must control the sender's buffer level to
prevent overfill and depletion. The pacing control module is
designed to send packets as fast as they are submitted by a
video application while maintaining a relatively stable buffer level.
While this looks like a simple problem, the details of the Automatic
Repeat Request (ARQ) behaviour between input and output of the
SRT sender add some complexity.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">SRT needs a certain amount of bandwidth overhead in order to have
space for the sender to insert packets for retransmission with minimum
impact on the output rate of the main packet transmission.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">This balance is achieved by adjusting the maximum allowed bandwidth MAX_BW
(<a href="#maxbw" class="auto internal xref">Section 5.1.1</a>) which limits the bandwidth usage by SRT. The MAX_BW value is used
by the Live Congestion Control (LiveCC) module to calculate the minimum
interval between consecutive sent packets PKT_SND_PERIOD.
In principle, the space between packets determines where
retransmissions can be inserted, and the overhead represents the
available margin. There is an empiric calculation that defines the
interval, in microseconds, between two packets to give a certain
bitrate. It is a function of the average packet payload (which
includes video, audio, etc.) and the configured maximum bandwidth (MAX_BW).
See <a href="#default-liveCC" class="auto internal xref">Section 5.1.2</a> for details.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">In the case of live streaming, the sender is allowed to drop packets
that cannot be delivered in time (<a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a>).<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">The combination of pacing control and Live Congestion Control (LiveCC), based
on the input rate and an overhead for packets retransmission, helps avoid congestion
during fluctuations of the source bitrate.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">During live streaming over highly variable networks, fairness can be achieved by controlling
the bitrate of the source encoder at the input of the SRT sender. SRT sender can provide a
variety of network related statistics, such as RTT estimate, packet loss level,
the number of packets dropped, etc., to the encoder which can be used for making decisions
and adjusting the bitrate in real time.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div id="maxbw">
<section id="section-5.1.1">
          <h4 id="name-configuring-maximum-bandwid">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-configuring-maximum-bandwid" class="section-name selfRef">Configuring Maximum Bandwidth</a>
          </h4>
<p id="section-5.1.1-1">There are several ways of configuring maximum bandwidth (MAX_BW):<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.1-2">
<li id="section-5.1.1-2.1">
              <p id="section-5.1.1-2.1.1">MAXBW_SET mode: Set the value explicitly.<a href="#section-5.1.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2.1.2">
The recommended default value is 1 Gbps. The default value
is set only for live streaming.<a href="#section-5.1.1-2.1.2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2.1.3">
Note that this static setting is not well-suited to a variable input,
like when you change the bitrate on an encoder. Each time the input
bitrate is configured on the encoder, MAX_BW should also be reconfigured.<a href="#section-5.1.1-2.1.3" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.1.1-2.2">
              <p id="section-5.1.1-2.2.1">INPUTBW_SET mode: Set the SRT sender's input rate (INPUT_BW) and overhead (OVERHEAD).<a href="#section-5.1.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2.2.2">
In this mode, SRT calculates the maximum bandwidth as follows:<a href="#section-5.1.1-2.2.2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-2.2.3">
<pre>
MAX_BW = INPUT_BW * (1 + OVERHEAD /100)
</pre><a href="#section-5.1.1-2.2.3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-2.2.4">
Note that INPUTBW_SET mode reduces to the MAXBW_SET mode and the same restrictions apply.<a href="#section-5.1.1-2.2.4" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.1.1-2.3">
              <p id="section-5.1.1-2.3.1">INPUTBW_ESTIMATED mode: Measure the SRT sender's input rate internally and set the
overhead (OVERHEAD).<a href="#section-5.1.1-2.3.1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2.3.2">
In this mode, SRT adjusts the value of maximum bandwidth each time it
gets the updated estimate of the input rate EST_INPUT_BW:<a href="#section-5.1.1-2.3.2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-2.3.3">
<pre>
MAX_BW = EST_INPUT_BW * (1 + OVERHEAD /100)
</pre><a href="#section-5.1.1-2.3.3" class="pilcrow">¶</a>
</div>
</li>
          </ol>
<p id="section-5.1.1-3">Note that the units of MAX_BW, INPUT_BW, and EST_INPUT_BW are bytes per
second. OVERHEAD is defined in %.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">INPUTBW_ESTIMATED mode is recommended for setting the
maximum bandwidth (MAX_BW) as it follows the fluctuations in
SRT sender's input rate. However, there are certain considerations
that should be taken into account.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1-5">In INPUTBW_SET mode, SRT takes as an input the rate that had been
configured as the expected output rate of an encoder (in terms
of bitrate for the packets including audio and overhead). But it is
normal for an encoder to occasionally overshoot. At low bitrate,
sometimes an encoder can be too optimistic and will output more bits
than expected. Under these conditions, SRT packets would not go out
fast enough because the configured bandwidth limitation would be too low.<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1.1-6">This is mitigated by calculating the bitrate internally (INPUTBW_ESTIMATED
mode). SRT examines the packets being submitted and calculates the
input rate as a moving average. However, this introduces a bit of a
delay based on the content. It also means that if an encoder encounters
black screens or still frames, this would dramatically lower the
bitrate being measured, which would in turn reduce the SRT output rate.
And then, when the video picks up again, the input rate rises sharply.
SRT would not start up again fast enough on output because of the time
it takes to measure the speed. Packets might be accumulated in the
SRT's sender buffer and delayed as a result, causing them to arrive too late
at the decoder, and possible drops by the receiver.<a href="#section-5.1.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1.1-7">The following table shows a summary of the bandwidth configuration modes
and the variables that need to be set (v) or ignored (-):<a href="#section-5.1.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-8">
<pre>
| Mode / Variable       | MAX_BW | INPUT_BW | OVERHEAD |
| --------------------- | ------ | -------- | -------- |
| MAXBW_SET             | v      | -        | -        |
| INPUTBW_SET           | -      | v        | v        |
| INPUTBW_ESTIMATED     | -      | -        | v        |
</pre><a href="#section-5.1.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="default-liveCC">
<section id="section-5.1.2">
          <h4 id="name-srts-default-livecc-algorit">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-srts-default-livecc-algorit" class="section-name selfRef">SRT's Default LiveCC Algorithm</a>
          </h4>
<p id="section-5.1.2-1">The main goal of the SRT's default LiveCC algorithm is to adjust the
minimum allowed packet sending period PKT_SND_PERIOD (and, as a result,
the maximum allowed sending rate) during transmission based on the
average packet payload size (AvgPayloadSize) and maximum bandwidth
(MAX_BW).<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">On the sender side, there are three events that the LiveCC algorithm reacts to:
(1) sending a data packet, (2) receiving an acknowledgement (ACK) packet,
and (3) a timeout event as described below.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">(1) On sending a data packet (either original or retransmitted), update
the value of average packet payload size (AvgPayloadSize):<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-4">
<pre>
AvgPayloadSize = 7/8 * AvgPayloadSize + 1/8 * PacketPayloadSize
</pre><a href="#section-5.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-5">where PacketPayloadSize is the payload size of a sent data packet, in bytes;
the initial value of AvgPayloadSize is equal to the maximum allowed packet
payload size, which cannot be larger than 1456 bytes.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<p id="section-5.1.2-6">(2) On an acknowledgement (ACK) packet reception:<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
<p id="section-5.1.2-7">Step 1. Calculate SRT packet size (PktSize) as the sum of average payload size
(AvgPayloadSize) and SRT header size (<a href="#packet-structure" class="auto internal xref">Section 3</a>), in bytes.<a href="#section-5.1.2-7" class="pilcrow">¶</a></p>
<p id="section-5.1.2-8">Step 2. Calculate the minimum allowed packet sending period (PKT_SND_PERIOD)
as:<a href="#section-5.1.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-9">
<pre>
PKT_SND_PERIOD = PktSize * 1000000 / MAX_BW
</pre><a href="#section-5.1.2-9" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-10">where MAX_BW is the configured maximum bandwidth which limits the
bandwidth usage by SRT, in bytes per second; PKT_SND_PERIOD is
measured in microseconds.<a href="#section-5.1.2-10" class="pilcrow">¶</a></p>
<p id="section-5.1.2-11">(3) On a retransmission timeout (RTO) event, follow the same steps as
described in method (1) above.<a href="#section-5.1.2-11" class="pilcrow">¶</a></p>
<p id="section-5.1.2-12">RTO is the amount of time within which an acknowledgement is expected after a data packet
is sent out. If there is no ACK after this amount of time has elapsed, a
timeout event is triggered. Since SRT only acknowledges every SYN time
(<a href="#packet-acks" class="auto internal xref">Section 4.8.1</a>), the value of retransmission timeout is
defined as follows:<a href="#section-5.1.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-13">
<pre>
RTO = RTT + 4 * RTTVar + 2 * SYN
</pre><a href="#section-5.1.2-13" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-14">where RTT is the round-trip time estimate, in microseconds, and
RTTVar is the variance of RTT estimate, in microseconds, reported
by the receiver and smoothed at the sender side
(see <a href="#ctrl-pkt-ack" class="auto internal xref">Section 3.2.4</a>, <a href="#rtt" class="auto internal xref">Section 4.10</a>). Here and throughout the current
section, smoothing means applying an exponentially weighted moving average (EWMA).<a href="#section-5.1.2-14" class="pilcrow">¶</a></p>
<p id="section-5.1.2-15">Continuous timeout should increase the RTO value. In SRT, a counter
(RexmitCount) is used to track the number of continuous timeouts:<a href="#section-5.1.2-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-16">
<pre>
RTO = RexmitCount * (RTT + 4 * RTTVar + 2 * SYN) + SYN
</pre><a href="#section-5.1.2-16" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-17">On the receiver side, when a loss report is sent, the sending interval of
periodic NAK reports (<a href="#packet-naks" class="auto internal xref">Section 4.8.2</a>) is updated as follows:<a href="#section-5.1.2-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-18">
<pre>
NAKInterval = max((RTT + 4 * RTTVar) / 2, 20000)
</pre><a href="#section-5.1.2-18" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-19">where RTT and RTTVar are receiver's estimates (see <a href="#ctrl-pkt-ack" class="auto internal xref">Section 3.2.4</a>,
<a href="#rtt" class="auto internal xref">Section 4.10</a>). The minimum value of NAKInterval is set to 20 milliseconds
in order to avoid sending periodic NAK reports too often under
low latency conditions.<a href="#section-5.1.2-19" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="fileCC">
<section id="section-5.2">
        <h3 id="name-file-transfer-congestion-co">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-file-transfer-congestion-co" class="section-name selfRef">File Transfer Congestion Control (FileCC)</a>
        </h3>
<p id="section-5.2-1">For file transfer (<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>), any known congestion control
algorithm like CUBIC <span>[<a href="#RFC8312" class="cite xref">RFC8312</a>]</span> or BBR <span>[<a href="#BBR" class="cite xref">BBR</a>]</span> can be applied,
including SRT's default FileCC algorithm described below.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="default-fileCC">
<section id="section-5.2.1">
          <h4 id="name-srts-default-filecc-algorit">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-srts-default-filecc-algorit" class="section-name selfRef">SRT's Default FileCC Algorithm</a>
          </h4>
<p id="section-5.2.1-1">SRT's default FileCC algorithm is a modified version of the UDT
native congestion control algorithm <span>[<a href="#GuAnAO" class="cite xref">GuAnAO</a>]</span>, <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span>
designed for a bulk data transfer over networks with a large
bandwidth-delay product (BDP). It is a hybrid Additive Increase
Multiplicative Decrease (AIMD) algorithm, hence it adjusts both
congestion window size (CWND_SIZE) and packet sending period
(PKT_SND_PERIOD). The units of measurement for CWND_SIZE and
PKT_SND_PERIOD are packets and microseconds, respectively.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">The algorithm controls sending rate by tuning the packet sending period
(i.e. how often packets are sent out). The sending rate is increased
upon receipt of an acknowledgement (ACK), and decreased when
receiving a loss report (negative acknowledgement, or NAK).
Only full ACKs, not light ACKs (<a href="#packet-acks" class="auto internal xref">Section 4.8.1</a>), trigger an increase
in the sending rate.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">SRT congestion control has two phases: "Slow Start" and "Congestion
Avoidance". In the slow start phase the congestion control module
probes the network to determine available bandwidth and the target
sending rate for the next (operational) phase, which is congestion
avoidance. In this phase, if there is no congestion detected via
loss reports, the sending rate is gradually increased. Conversely,
if a network congestion is detected, the algorithm decreases the
sending rate to reduce subsequent packet loss. The slow start phase
runs exactly once at the beginning of a connection, and stops when
a packet loss occurs, when the congestion window size reaches its
maximum value, or on a timeout event.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">The detailed algorithm behaviour at both phases is described
in <a href="#default-fileCC-slow-start" class="auto internal xref">Section 5.2.1.1</a> and
<a href="#default-fileCC-congestion-avoidance" class="auto internal xref">Section 5.2.1.2</a>, respectively.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1-5">As with LiveCC, SRT's default FileCC algorithm reacts to three events:
(1) sending a data packet, (2) receiving an acknowledgement (ACK) packet,
and (3) a timeout event. These are described below as they apply to the
congestion control phases.<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
<div id="default-fileCC-slow-start">
<section id="section-5.2.1.1">
            <h5 id="name-slow-start">
<a href="#section-5.2.1.1" class="section-number selfRef">5.2.1.1. </a><a href="#name-slow-start" class="section-name selfRef">Slow Start</a>
            </h5>
<p id="section-5.2.1.1-1">During the slow start phase, the packet sending period PKT_SND_PERIOD
is kept at 1 microsecond in order to send packets as fast as possible,
but not at an infinite rate. The initial value of the congestion window
size (CWND_SIZE) is set to 16 packets. CWND_SIZE has an upper
threshold, which is the maximum allowed congestion window size
(MAX_CWND_SIZE), so that even if there is no packet loss, the slow
start phase has to stop at a certain point. The threshold can be
set to the maximum receiver buffer size (12 MB).<a href="#section-5.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-2">(1) On an acknowledgement (ACK) packet reception:<a href="#section-5.2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-3">Step 1. If the interval since the last time the sending rate was either
increased or kept (LastRCTime) is less than RC_INTERVAL:<a href="#section-5.2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-4">a. Keep the sending rate at the same level;<a href="#section-5.2.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-5">b. Stop.<a href="#section-5.2.1.1-5" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-5.2.1.1-6">
<pre>&lt;CODE BEGINS&gt;
if (currTime - LastRCTime &lt; RC_INTERVAL)
{
    Keep the sending rate at the same level;
    Stop;
}

&lt;CODE ENDS&gt;</pre><a href="#section-5.2.1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.1-7">where currTime is the current time, in microseconds; LastRCTime is
the last time the sending rate was either increased, or kept,
in microseconds.<a href="#section-5.2.1.1-7" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-8">Step 2. Update the value of LastRCTime to the current time:<a href="#section-5.2.1.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.1-9">
<pre>
LastRCTime = currTime
</pre><a href="#section-5.2.1.1-9" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.1-10">Step 3. The size of congestion window CWND_SIZE is increased by the
difference in sequence numbers of the data packet being acknowledged
ACK_SEQNO and the last acknowledged data packet LAST_ACK_SEQNO:<a href="#section-5.2.1.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.1-11">
<pre>
CWND_SIZE += ACK_SEQNO - LAST_ACK_SEQNO
</pre><a href="#section-5.2.1.1-11" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.1-12">Step 4. The sequence number of the last acknowledged data packet
LAST_ACK_SEQNO is updated as follows:<a href="#section-5.2.1.1-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.1-13">
<pre>
LAST_ACK_SEQNO = ACK_SEQNO
</pre><a href="#section-5.2.1.1-13" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.1-14">Step 5. If the congestion window size CWND_SIZE calculated at Step 3 is greater
than the upper threshold MAX_CWND_SIZE, slow start phase ends.
Set the packet sending period PKT_SND_PERIOD as follows:<a href="#section-5.2.1.1-14" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-5.2.1.1-15">
<pre>&lt;CODE BEGINS&gt;
if (RECEIVING_RATE &gt; 0)
    PKT_SND_PERIOD = 1000000 / RECEIVING_RATE;
else
    PKT_SND_PERIOD = CWND_SIZE / (RTT + RC_INTERVAL);

&lt;CODE ENDS&gt;</pre><a href="#section-5.2.1.1-15" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.1-16">where<a href="#section-5.2.1.1-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.1-17.1">
                <p id="section-5.2.1.1-17.1.1">RECEIVING_RATE is the rate at which packets are being received,
in packets per second, reported by the receiver and smoothed at
the sender side (see <a href="#ctrl-pkt-ack" class="auto internal xref">Section 3.2.4</a>, <a href="#bandwidth-estimation" class="auto internal xref">Section 5.2.1.3</a>);<a href="#section-5.2.1.1-17.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.1-17.2">
                <p id="section-5.2.1.1-17.2.1">RTT is the round-trip time estimate, in microseconds,
reported by the receiver and smoothed at the sender side (see
<a href="#ctrl-pkt-ack" class="auto internal xref">Section 3.2.4</a>, <a href="#rtt" class="auto internal xref">Section 4.10</a>);<a href="#section-5.2.1.1-17.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.1-17.3">
                <p id="section-5.2.1.1-17.3.1">RC_INTERVAL is the fixed rate control interval, in microseconds.
RC_INTERVAL of SRT is SYN, or synchronization time interval, which
is 0.01 second. An ACK in SRT is sent every fixed time interval.
The maximum and default ACK time interval is SYN.
See <a href="#packet-acks" class="auto internal xref">Section 4.8.1</a> for details.<a href="#section-5.2.1.1-17.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.2.1.1-18">(2) On a loss report (NAK) packet reception:<a href="#section-5.2.1.1-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.1-19.1">
                <p id="section-5.2.1.1-19.1.1">Slow start phase ends;<a href="#section-5.2.1.1-19.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.1-19.2">
                <p id="section-5.2.1.1-19.2.1">Set the packet sending period PKT_SND_PERIOD as described in Step 5
of section (1) above.<a href="#section-5.2.1.1-19.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.2.1.1-20">(3) On a retransmission timeout (RTO) event:<a href="#section-5.2.1.1-20" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.1-21.1">
                <p id="section-5.2.1.1-21.1.1">Slow start phase ends;<a href="#section-5.2.1.1-21.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.1-21.2">
                <p id="section-5.2.1.1-21.2.1">Set the packet sending period PKT_SND_PERIOD as described in Step 5
of section (1) above.<a href="#section-5.2.1.1-21.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="default-fileCC-congestion-avoidance">
<section id="section-5.2.1.2">
            <h5 id="name-congestion-avoidance">
<a href="#section-5.2.1.2" class="section-number selfRef">5.2.1.2. </a><a href="#name-congestion-avoidance" class="section-name selfRef">Congestion Avoidance</a>
            </h5>
<p id="section-5.2.1.2-1">Once the slow start phase ends, the algorithm enters the congestion
avoidance phase and behaves as described below.<a href="#section-5.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-2">(1) On an acknowledgement (ACK) packet reception:<a href="#section-5.2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-3">Step 1. If the interval since the last time the sending rate was either
increased or kept (LastRCTime) is less than RC_INTERVAL:<a href="#section-5.2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-4">a. Keep the sending rate at the same level;<a href="#section-5.2.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-5">b. Stop.<a href="#section-5.2.1.2-5" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-5.2.1.2-6">
<pre>&lt;CODE BEGINS&gt;
if (currTime - LastRCTime &lt; RC_INTERVAL)
{
    Keep the sending rate at the same level;
    Stop;
}

&lt;CODE ENDS&gt;</pre><a href="#section-5.2.1.2-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.2-7">where currTime is the current time, in microseconds; LastRCTime is
the last time the sending rate was either increased, or kept,
in microseconds.<a href="#section-5.2.1.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-8">Step 2. Update the value of LastRCTime to the current time:<a href="#section-5.2.1.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.2-9">
<pre>
LastRCTime = currTime
</pre><a href="#section-5.2.1.2-9" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.2-10">Step 3. Set the congestion window size to:<a href="#section-5.2.1.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.2-11">
<pre>
CWND_SIZE = RECEIVING_RATE * (RTT + RC_INTERVAL) / 1000000 + 16
</pre><a href="#section-5.2.1.2-11" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.2-12">Step 4. If there is packet loss reported by the receiver (bLoss=True):<a href="#section-5.2.1.2-12" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-13">a. Keep the value of PKT_SND_PERIOD at the same level;<a href="#section-5.2.1.2-13" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-14">b. Set the value of bLoss to False;<a href="#section-5.2.1.2-14" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-15">c. Stop.<a href="#section-5.2.1.2-15" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-16">bLoss flag is equal to True if a packet loss has happened since the
last sending rate increase. Initial value: False.<a href="#section-5.2.1.2-16" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-17">Step 5. If there is no packet loss reported by the receiver (bLoss=False),
calculate PKT_SND_PERIOD as follows:<a href="#section-5.2.1.2-17" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-5.2.1.2-18">
<pre>&lt;CODE BEGINS&gt;
inc = 0;

lossBandwidth = 2 * (1000000 / LastDecPeriod);
linkCapacity = min(lossBandwidth, EST_LINK_CAPACITY);
B = linkCapacity - 1000000 / PKT_SND_PERIOD;

if ((PKT_SND_PERIOD &gt; LastDecPeriod) &amp;&amp; ((linkCapacity / 9) &lt; B))
    B = linkCapacity / 9;
if (B &lt;= 0)
    inc = 1 / S;
else
{
    inc = pow(10.0, ceil(log10(B * S * 8))) * 0.0000015 / S;
    inc = max(inc, 1 / S);
}

PKT_SND_PERIOD = (PKT_SND_PERIOD * RC_INTERVAL) /
                  (PKT_SND_PERIOD * inc + RC_INTERVAL);

&lt;CODE ENDS&gt;</pre><a href="#section-5.2.1.2-18" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.2-19">where<a href="#section-5.2.1.2-19" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.2-20.1">
                <p id="section-5.2.1.2-20.1.1">LastDecPeriod is the value of PKT_SND_PERIOD right before the last
sending rate decrease has happened (on a loss report (NAK) packet
reception), in microseconds. The initial value of LastDecPeriod
is set to 1 microsecond;<a href="#section-5.2.1.2-20.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.2-20.2">
                <p id="section-5.2.1.2-20.2.1">EST_LINK_CAPACITY is the estimated link capacity reported
by the receiver within an ACK packet and smoothed at the sender side
(<a href="#bandwidth-estimation" class="auto internal xref">Section 5.2.1.3</a>), in packets per second;<a href="#section-5.2.1.2-20.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.2-20.3">
                <p id="section-5.2.1.2-20.3.1">B is the estimated available bandwidth, in packets per second;<a href="#section-5.2.1.2-20.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.2-20.4">
                <p id="section-5.2.1.2-20.4.1">S is the SRT packet size (in terms of IP payload) in bytes.
SRT treats 1500 bytes as a standard packet size.<a href="#section-5.2.1.2-20.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.2.1.2-21">A detailed explanation of the formulas used to calculate the increase
in sending rate can be found in <span>[<a href="#GuAnAO" class="cite xref">GuAnAO</a>]</span>. UDT's available
bandwidth estimation has been modified to take into account the
bandwidth registered at the moment of packet loss, since the estimated
link capacity reported by the receiver may
overestimate the actual link capacity significantly.<a href="#section-5.2.1.2-21" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-22">Step 6. If the value of maximum bandwidth MAX_BW defined in
<a href="#liveCC" class="auto internal xref">Section 5.1</a> is set, limit the value of PKT_SND_PERIOD to the
minimum allowed period, if necessary:<a href="#section-5.2.1.2-22" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-5.2.1.2-23">
<pre>&lt;CODE BEGINS&gt;
if (MAX_BW)
    MIN_PERIOD = 1000000 / (MAX_BW / S);

    if (PKT_SND_PERIOD &lt; MIN_PERIOD)
        PKT_SND_PERIOD = MIN_PERIOD;

&lt;CODE ENDS&gt;</pre><a href="#section-5.2.1.2-23" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.2-24">Note that in the case of file transmission the the maximum allowed bandwidth (MAX_BW)
for SRT can be defined. This limits the minimum possible interval between packets
sent. Only the usage of MAXBW_SET mode is possible (<a href="#maxbw" class="auto internal xref">Section 5.1.1</a>). In contrast with
live streaming, there is no default value set for MAX_BW, and the transmission
rate is not limited if not set explicitly.<a href="#section-5.2.1.2-24" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-25">(2) On a loss report (NAK) packet reception:<a href="#section-5.2.1.2-25" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-26">Step 1. Set the value of flag bLoss equal to True.<a href="#section-5.2.1.2-26" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-27">Step 2. If the current loss ratio estimated by the sender is less than 2%:<a href="#section-5.2.1.2-27" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-28">a. Keep the sending rate at the same level;<a href="#section-5.2.1.2-28" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-29">b. Update the value of LastDecPeriod:<a href="#section-5.2.1.2-29" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.2-30">
<pre>
LastDecPeriod = PKT_SND_PERIOD
</pre><a href="#section-5.2.1.2-30" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.2-31">c. Stop.<a href="#section-5.2.1.2-31" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-32">This modification has been introduced to increase the algorithm
tolerance to a random packet loss specific for public networks, but
not related to the absence of available bandwidth.<a href="#section-5.2.1.2-32" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-33">Step 3. If sequence number of a packet being reported as lost is greater
than the largest sequence number has been sent so far (LastDecSeq),
i.e. this NAK starts a new congestion period:<a href="#section-5.2.1.2-33" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-34">a. Set the value of LastDecPeriod to the current packet sending
period PKT_SND_PERIOD;<a href="#section-5.2.1.2-34" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-35">b. Increase the value of packet sending period:<a href="#section-5.2.1.2-35" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.2-36">
<pre>
PKT_SND_PERIOD = 1.03 * PKT_SND_PERIOD
</pre><a href="#section-5.2.1.2-36" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.2-37">c. Update AvgNAKNum:<a href="#section-5.2.1.2-37" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.2-38">
<pre>
AvgNAKNum = 0.97 * AvgNAKNum + 0.03 * NAKCount
</pre><a href="#section-5.2.1.2-38" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.2-39">d. Reset NAKCount and DecCount values to 1;<a href="#section-5.2.1.2-39" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-40">e. Record the current largest sent sequence number LastDecSeq;<a href="#section-5.2.1.2-40" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-41">f. Compute DecRandom to a random (uniform distribution) number
between 1 and AvgNAKNum. If DecRandom &lt; 1: DecRandom = 1;<a href="#section-5.2.1.2-41" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-42">g. Stop;<a href="#section-5.2.1.2-42" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-43">where<a href="#section-5.2.1.2-43" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.2-44.1">
                <p id="section-5.2.1.2-44.1.1">AvgNAKNum is the average number of NAKs during a congestion period.
Initial value: 0;<a href="#section-5.2.1.2-44.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.2-44.2">
                <p id="section-5.2.1.2-44.2.1">NAKCount is the number of NAKs received so far in the current
congestion period. Initial value: 0;<a href="#section-5.2.1.2-44.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.2-44.3">
                <p id="section-5.2.1.2-44.3.1">DecCount means the number of times that the sending rate has been
decreased during the congestion period. Initial value: 0;<a href="#section-5.2.1.2-44.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.2.1.2-44.4">
                <p id="section-5.2.1.2-44.4.1">DecRandom is a random number used to decide if the rate should be
decreased or not for the following NAKs (not the first one) during
the congestion period. DecRandom is a random number between 1 and
the average number of NAKs per congestion period (AvgNAKNum).<a href="#section-5.2.1.2-44.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.2.1.2-45">Congestion period is defined as the time between two NAKs in which
the biggest lost packet sequence number carried in the NAK is greater
than the LastDecSeq.<a href="#section-5.2.1.2-45" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-46">The coefficients used in the formulas above have been slightly modified
to reduce the amount by which the sending rate decreases.<a href="#section-5.2.1.2-46" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-47">Step 4. If DecCount &lt;= 5, and NAKCount == DecCount * DecRandom:<a href="#section-5.2.1.2-47" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-48">a. Update SND period: SND = 1.03 * SND;<a href="#section-5.2.1.2-48" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-49">b. Increase DecCount and NAKCount by 1;<a href="#section-5.2.1.2-49" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-50">c. Record the current largest sent sequence number (LastDecSeq).<a href="#section-5.2.1.2-50" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bandwidth-estimation">
<section id="section-5.2.1.3">
            <h5 id="name-link-capacity-and-receiving">
<a href="#section-5.2.1.3" class="section-number selfRef">5.2.1.3. </a><a href="#name-link-capacity-and-receiving" class="section-name selfRef">Link Capacity and Receiving Rate Estimation</a>
            </h5>
<p id="section-5.2.1.3-1">Estimates of link capacity and receiving rate, in packets/bytes per second,
are calculated at the receiver side during file transmission
(<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>). It is worth noting
that the receiving rate estimate, while available during the entire data transmission
period, is used only during the slow start phase of the congestion control
algorithm (<a href="#default-fileCC-slow-start" class="auto internal xref">Section 5.2.1.1</a>).
The latest estimate obtained before the end of the slow start
period is used by the sender as a reference maximum speed
to continue data transmission without further congestion.
Link capacity is estimated all the time and used primarily
(as well as packet loss ratio and other protocol statistics)
for sending rate adjustments during the transmission process.<a href="#section-5.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.3-2">As each data packet arrives, the receiver records the time delta with respect to
the arrival of the previous data packet, which is used to estimate bandwidth and
receiving speed (delivery rate). This and other control information is communicated
to the sender by means of acknowledgment (ACK) packets sent every 10 milliseconds.
At the sender side, upon receiving a new value, an exponentially weighted moving average (EWMA)
is applied to update the latest estimate maintained at the sender side.<a href="#section-5.2.1.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1.3-3">It is important to note that for bandwidth estimation only data
probing packets are taken into account, while all data packets
(both data and data probing) are used for estimating receiving
speed. Data probing refers to the use of the packet pairs technique,
whereby pairs of probing packets are sent to a server back-to-back,
thus making it possible to measure the minimum interval in receiving
consecutive packets.<a href="#section-5.2.1.3-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1.3-4">The detailed description of models used to estimate link capacity
and receiving rate can be found in <span>[<a href="#GuAnAO" class="cite xref">GuAnAO</a>]</span>, <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span>.<a href="#section-5.2.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="encryption">
<section id="section-6">
      <h2 id="name-encryption">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-encryption" class="section-name selfRef">Encryption</a>
      </h2>
<p id="section-6-1">This section describes the encryption mechanism that protects the payload of SRT streams.
Based on standard cryptographic algorithms, the mechanism allows an efficient stream cipher
with a key establishment method.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="overview">
<section id="section-6.1">
        <h3 id="name-overview">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-6.1-1">SRT implements encryption using AES <span>[<a href="#AES" class="cite xref">AES</a>]</span> in counter mode (AES-CTR) <span>[<a href="#SP800-38A" class="cite xref">SP800-38A</a>]</span> with a short-lived key
to encrypt and decrypt the media stream. The AES-CTR cipher is suitable for continuous stream encryption
that permits decryption from any point, without access to start of the stream (random access),
and for the same reason tolerates packet loss. It also offers strong confidentiality when the counter is managed properly.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div id="encryption-scope">
<section id="section-6.1.1">
          <h4 id="name-encryption-scope">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-encryption-scope" class="section-name selfRef">Encryption Scope</a>
          </h4>
<p id="section-6.1.1-1">SRT encrypts only the payload of SRT data packets (<a href="#data-pkt" class="auto internal xref">Section 3.1</a>), while the header is left unencrypted.
The unencrypted header contains the Packet Sequence Number field used to keep the synchronization
of the cipher counter between the encrypting sender and the decrypting receiver.
No constraints apply to the payload of SRT data packets as no padding of the payload is required by counter mode ciphers.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aes-counter">
<section id="section-6.1.2">
          <h4 id="name-aes-counter">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-aes-counter" class="section-name selfRef">AES Counter</a>
          </h4>
<p id="section-6.1.2-1">The counter for AES-CTR is the size of the cipher's block, i.e. 128 bits. It is derived from
a 128-bit sequence consisting of<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-2.1">
              <p id="section-6.1.2-2.1.1">a block counter in the least significant 16 bits which counts the blocks in a packet;<a href="#section-6.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-2.2">
              <p id="section-6.1.2-2.2.1">a packet index, based on the packet sequence number in the SRT header, in the next 32 bits;<a href="#section-6.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-2.3">
              <p id="section-6.1.2-2.3.1">eighty zeroed bits.<a href="#section-6.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.2-3">The upper 112 bits of this sequence are XORed with an Initialization Vector (IV)
to produce a unique counter for each crypto block. The IV is derived from the Salt
provided in the Keying Material (<a href="#sec-ctrlpkt-km" class="auto internal xref">Section 3.2.2</a>):<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.2-4">
<pre>
IV = MSB(112, Salt): Most significant 112 bits of the salt.
</pre><a href="#section-6.1.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="stream-encrypting-key-sek">
<section id="section-6.1.3">
          <h4 id="name-stream-encrypting-key-sek">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-stream-encrypting-key-sek" class="section-name selfRef">Stream Encrypting Key (SEK)</a>
          </h4>
<p id="section-6.1.3-1">The key used for AES-CTR encryption is called the "Stream Encrypting Key" (SEK). It is used for
up to 2^25 packets with further rekeying.
The short-lived SEK is generated by the sender using a pseudo-random number generator (PRNG),
and transmitted within the stream, wrapped with another longer-term key,
the Key Encrypting Key (KEK), using a known AES key wrap protocol.<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3-2">For connection-oriented transport such as SRT, there is no need to periodically transmit
the short-lived key since no additional party can join a stream in progress. The keying material
is transmitted within the connection handshake packets, and for a short period
when rekeying occurs.<a href="#section-6.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-encrypting-key-kek">
<section id="section-6.1.4">
          <h4 id="name-key-encrypting-key-kek">
<a href="#section-6.1.4" class="section-number selfRef">6.1.4. </a><a href="#name-key-encrypting-key-kek" class="section-name selfRef">Key Encrypting Key (KEK)</a>
          </h4>
<p id="section-6.1.4-1">The Key Encrypting Key (KEK) is derived from a secret (passphrase) shared between the sender and the receiver.
The KEK provides access to the Stream Encrypting Key, which in turn provides access
to the protected payload of SRT data packets. The KEK has to be at least as long as the SEK.<a href="#section-6.1.4-1" class="pilcrow">¶</a></p>
<p id="section-6.1.4-2">The KEK is generated by a password-based key generation function (PBKDF2) <span>[<a href="#RFC8018" class="cite xref">RFC8018</a>]</span>,
using the passphrase, a number of iterations (2048), a keyed-hash (HMAC-SHA1) <span>[<a href="#RFC2104" class="cite xref">RFC2104</a>]</span>, and
a key length value (KLen). The PBKDF2 function hashes the passphrase to make a long string,
by repetition or padding. The number of iterations is based on how much time can be given to
the process without it becoming disruptive.<a href="#section-6.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-material-exchange">
<section id="section-6.1.5">
          <h4 id="name-key-material-exchange">
<a href="#section-6.1.5" class="section-number selfRef">6.1.5. </a><a href="#name-key-material-exchange" class="section-name selfRef">Key Material Exchange</a>
          </h4>
<p id="section-6.1.5-1">The KEK is used to generate a wrap <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span> that is put in a key material (KM) message
by the initiator of a connection (i.e. caller in caller-listener handshake and initiator
in the rendezvous handshake, see <a href="#handshake-messages" class="auto internal xref">Section 4.3</a>) to send to the responder (listener).
The KM message contains the key length,
the salt (one of the arguments provided to the PBKDF2 function), the protocol being used
(e.g. AES-256) and the AES counter (which will eventually change, see <a href="#sec-crypt-km-refresh" class="auto internal xref">Section 6.1.6</a>).<a href="#section-6.1.5-1" class="pilcrow">¶</a></p>
<p id="section-6.1.5-2">On the other side, the responder attempts to decode the wrap to obtain the Stream Encrypting Key.
In the protocol for the wrap there is a padding, which is a known template, so the responder
knows from the KM that it has the right KEK to decode the SEK.
The SEK (generated and transmitted by the initiator) is random, and cannot be known in advance.
The KEK formula is calculated on both sides, with the difference that the responder gets
the key length (KLen) from the initiator via the key material (KM).
It is the initiator who decides on the configured length. The responder obtains it from
the material sent by the initiator.<a href="#section-6.1.5-2" class="pilcrow">¶</a></p>
<p id="section-6.1.5-3">The responder returns the same KM message to show that it has the same information as the initiator,
and that the encoded material will be decrypted. If the responder does not return this status,
this means that it does not have the SEK. All incoming encrypted packets received by the responder
will be lost (undecrypted). Even if they are transmitted
successfully, the receiver will be unable to decrypt them, and so packets will be dropped.
All data packets coming from responder will be unencrypted.<a href="#section-6.1.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-crypt-km-refresh">
<section id="section-6.1.6">
          <h4 id="name-km-refresh">
<a href="#section-6.1.6" class="section-number selfRef">6.1.6. </a><a href="#name-km-refresh" class="section-name selfRef">KM Refresh</a>
          </h4>
<p id="section-6.1.6-1">The short lived SEK is regenerated for cryptographic reasons when a pre-determined number of packets has been
encrypted. The KM refresh period is determined by the implementation.
The receiver knows which SEK (odd or even) was used to encrypt the packet
by means of the KK field of the SRT Data Packet (<a href="#data-pkt" class="auto internal xref">Section 3.1</a>).<a href="#section-6.1.6-1" class="pilcrow">¶</a></p>
<p id="section-6.1.6-2">There are two variables used to determine the KM Refresh timing:<a href="#section-6.1.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.6-3.1">
              <p id="section-6.1.6-3.1.1">KM Refresh Period specifies the number of packets to be sent before switching to the new SEK.<a href="#section-6.1.6-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.6-3.2">
              <p id="section-6.1.6-3.2.1">KM Pre-Announcement Period specifies when a new key is announced in a number of packets before key switchover.
The same value is used to determine when to decommission the old key after switchover.<a href="#section-6.1.6-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.6-4">The recommended KM Refresh Period is after 2^25 packets encrypted with the same SEK are sent.
The recommended KM Pre-Announcement Period is 4000 packets (i.e. a new key is generated,
wrapped, and sent at 2^25 minus 4000 packets; the old key is decommissioned at 2^25 plus 4000 packets).<a href="#section-6.1.6-4" class="pilcrow">¶</a></p>
<p id="section-6.1.6-5">Even and odd keys are alternated during transmission the following way.
The packets with the earlier key #1 (let it be the odd key) will continue to be sent.
The receiver will receive the new key #2 (even), then decrypt and unwrap it.
The receiver will reply to the sender if it is able to understand.
Once the sender gets to the 2^25th packet using the odd key (key #1), it will then start to
send packets with the even key (key #2), knowing that the receiver has what it needs to
decrypt them. This happens transparently, from one packet to the next.
At 2^25 plus 4000 packets the first key will be decommissioned automatically.<a href="#section-6.1.6-5" class="pilcrow">¶</a></p>
<p id="section-6.1.6-6">Both keys live in parallel for two times the Pre-Announcement Period (e.g. 4000 packets before the key switch, and 4000 packets after). This is to allow for packet retransmission. It is possible for packets with the older key to arrive
at the receiver a bit late. Each packet contains a description of which key it requires,
so the receiver will still have the ability to decrypt it.<a href="#section-6.1.6-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="encryption-process">
<section id="section-6.2">
        <h3 id="name-encryption-process">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-encryption-process" class="section-name selfRef">Encryption Process</a>
        </h3>
<div id="generating-the-stream-encrypting-key">
<section id="section-6.2.1">
          <h4 id="name-generating-the-stream-encry">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-generating-the-stream-encry" class="section-name selfRef">Generating the Stream Encrypting Key</a>
          </h4>
<p id="section-6.2.1-1">On the sending side SEK, Salt and KEK are generated in the following way:<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-2">
<pre>
SEK  = PRNG(KLen)
Salt = PRNG(128)
KEK = PBKDF2(passphrase, LSB(64,Salt), Iter, KLen)
</pre><a href="#section-6.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-3">where<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-4.1">
              <p id="section-6.2.1-4.1.1">PBKDF2 is the PKCS#5 Password Based Key Derivation Function <span>[<a href="#RFC8018" class="cite xref">RFC8018</a>]</span>;<a href="#section-6.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.2">
              <p id="section-6.2.1-4.2.1">passphrase is the pre-shared passphrase;<a href="#section-6.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.3">
              <p id="section-6.2.1-4.3.1">Salt is a field of the KM message;<a href="#section-6.2.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.4">
              <p id="section-6.2.1-4.4.1">LSB(n, v) is the function taking n least significant bits of v;<a href="#section-6.2.1-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.5">
              <p id="section-6.2.1-4.5.1">Iter=2048 defines the number of iterations for PBKDF2;<a href="#section-6.2.1-4.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-4.6">
              <p id="section-6.2.1-4.6.1">KLen is a field of the KM message.<a href="#section-6.2.1-4.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div class="alignLeft art-text artwork" id="section-6.2.1-5">
<pre>
Wrap = AESkw(KEK, SEK)
</pre><a href="#section-6.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-6">where AESkw(KEK, SEK) is the key wrapping function <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span>.<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encrypting-the-payload">
<section id="section-6.2.2">
          <h4 id="name-encrypting-the-payload">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-encrypting-the-payload" class="section-name selfRef">Encrypting the Payload</a>
          </h4>
<p id="section-6.2.2-1">The encryption of the payload of the SRT data packet is done with AES-CTR<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-2">
<pre>
EncryptedPayload = AES_CTR_Encrypt(SEK, IV, UnencryptedPayload)
</pre><a href="#section-6.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2-3">where the Initialization Vector (IV) is derived as<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-4">
<pre>
IV = (MSB(112, Salt) &lt;&lt; 2) XOR (PktSeqNo)
</pre><a href="#section-6.2.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2-5">PktSeqNo is the value of the Packet Sequence Number field of the SRT data packet.<a href="#section-6.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="decryption-process">
<section id="section-6.3">
        <h3 id="name-decryption-process">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-decryption-process" class="section-name selfRef">Decryption Process</a>
        </h3>
<div id="restoring-the-stream-encrypting-key">
<section id="section-6.3.1">
          <h4 id="name-restoring-the-stream-encryp">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-restoring-the-stream-encryp" class="section-name selfRef">Restoring the Stream Encrypting Key</a>
          </h4>
<p id="section-6.3.1-1">For the receiver to be able to decrypt the incoming stream it has to know the stream encrypting key (SEK)
used by the sender. The receiver MUST know the passphrase used by the sender. The remaining information can
be extracted from the Keying Material message.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">The Keying Material message contains the AES-wrapped <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span> SEK used by the encoder.
The Key-Encryption Key (KEK) required to unwrap the SEK is calculated as:<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.1-3">
<pre>
KEK = PBKDF2(passphrase, LSB(64,Salt), Iter, KLen)
</pre><a href="#section-6.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1-4">where<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1-5.1">
              <p id="section-6.3.1-5.1.1">PBKDF2 is the PKCS#5 Password Based Key Derivation Function <span>[<a href="#RFC8018" class="cite xref">RFC8018</a>]</span>;<a href="#section-6.3.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.3.1-5.2">
              <p id="section-6.3.1-5.2.1">passphrase is the pre-shared passphrase;<a href="#section-6.3.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.3.1-5.3">
              <p id="section-6.3.1-5.3.1">Salt is a field of the KM message;<a href="#section-6.3.1-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.3.1-5.4">
              <p id="section-6.3.1-5.4.1">LSB(n, v) is the function taking n least significant bits of v;<a href="#section-6.3.1-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.3.1-5.5">
              <p id="section-6.3.1-5.5.1">Iter=2048 defines the number of iterations for PBKDF2;<a href="#section-6.3.1-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.3.1-5.6">
              <p id="section-6.3.1-5.6.1">KLen is a field of the KM message.<a href="#section-6.3.1-5.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div class="alignLeft art-text artwork" id="section-6.3.1-6">
<pre>
SEK = AESkuw(KEK, Wrap)
</pre><a href="#section-6.3.1-6" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1-7">where AESkuw(KEK, Wrap) is the key unwrapping function.<a href="#section-6.3.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decrypting-the-payload">
<section id="section-6.3.2">
          <h4 id="name-decrypting-the-payload">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-decrypting-the-payload" class="section-name selfRef">Decrypting the Payload</a>
          </h4>
<p id="section-6.3.2-1">The decryption of the payload of the SRT data packet is done with AES-CTR<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.2-2">
<pre>
DecryptedPayload = AES_CTR_Encrypt(SEK, IV, EncryptedPayload)
</pre><a href="#section-6.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3.2-3">where the Initialization Vector (IV) is derived as<a href="#section-6.3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.2-4">
<pre>
IV = (MSB(112, Salt) &lt;&lt; 2) XOR (PktSeqNo)
</pre><a href="#section-6.3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.2-5">PktSeqNo is the value of the Packet Sequence Number field of the SRT data packet.<a href="#section-6.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="best-practices">
<section id="section-7">
      <h2 id="name-best-practices-and-configur">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-best-practices-and-configur" class="section-name selfRef">Best Practices and Configuration Tips for Data Transmission via SRT</a>
      </h2>
<div id="live-streaming-use-case">
<section id="section-7.1">
        <h3 id="name-live-streaming">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-live-streaming" class="section-name selfRef">Live Streaming</a>
        </h3>
<p id="section-7.1-1">This section describes real world examples of live audio/video streaming and the current consensus on maintaining the compatibility between SRT implementations by different vendors. It is meant as guidance for developers to write applications compatible with existing SRT implementations.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The term "live streaming" refers to MPEG-TS style continuous data transmission with latency management. Live streaming based on segmentation and transmission of files like in HLS protocol <span>[<a href="#RFC8216" class="cite xref">RFC8216</a>]</span> is not part of this use case.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">The default SRT data transmission mode for continuous live streaming is message mode (<a href="#transmission-mode-msg" class="auto internal xref">Section 4.2.1</a>) with certain settings applied as described below:<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-4.1">
            <p id="section-7.1-4.1.1">Only data packets with their Packet Position Flag (PP) field set to "11b" are allowed, meaning a single data packet forms exactly one message (<a href="#data-pkt" class="auto internal xref">Section 3.1</a>).<a href="#section-7.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.2">
            <p id="section-7.1-4.2.1">Timestamp-Based Packet Delivery (TSBPD) (<a href="#tsbpd" class="auto internal xref">Section 4.5</a>) and Too-Late Packet Drop
(TLPKTDROP) (<a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a>) mechanisms must be enabled.<a href="#section-7.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.3">
            <p id="section-7.1-4.3.1">Live Congestion Control (LiveCC) (<a href="#liveCC" class="auto internal xref">Section 5.1</a>) must be used.<a href="#section-7.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.4">
            <p id="section-7.1-4.4.1">Periodic NAK reports (<a href="#packet-naks" class="auto internal xref">Section 4.8.2</a>) must be enabled.<a href="#section-7.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-4.5">
            <p id="section-7.1-4.5.1">The Order Flag (<a href="#data-pkt" class="auto internal xref">Section 3.1</a>) needs special attention. In the case
of live streaming, it is set to 0 allowing out of order
delivery of a packet. However, in this use case the Order Flag has to be ignored
by the receiver. As TSBPD is enabled, the receiver will still deliver
packets in order, but based on the timestamps. In the case of a
packet arriving too late and skipped by the TLPKTDROP mechanism, the
order of delivery is still maintained except for potential sequence
discontinuity.<a href="#section-7.1-4.5.1" class="pilcrow">¶</a></p>
<p id="section-7.1-4.5.2">
This method has grown historically and is the current common standard
for live streaming across different SRT implementations. A change or
variation of the settings will break compatibility between two parties.<a href="#section-7.1-4.5.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-5">This combination of settings allows live streaming with a constant latency (<a href="#srt-latency" class="auto internal xref">Section 4.4</a>). The receiving end will not "fall behind" in time by waiting for missing packets. However, data integrity might not be ensured if packets or retransmitted packets do not arrive within the expected time frame. Audio or video interruption can occur, but the overall latency is maintained and does not increase over time whenever packets are missing.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="file-transmission-use-case">
<section id="section-7.2">
        <h3 id="name-file-transmission">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-file-transmission" class="section-name selfRef">File Transmission</a>
        </h3>
<p id="section-7.2-1">This section describes the use case of file transmission and provides configuration examples.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">The usage of both message and buffer modes (<a href="#data-transmission-modes" class="auto internal xref">Section 4.2</a>) is possible in this case. For both modes, Timestamp-Based Packet Delivery (TSBPD) (<a href="#tsbpd" class="auto internal xref">Section 4.5</a>) and Too-Late Packet Drop (TLPKTDROP) (<a href="#too-late-packet-drop" class="auto internal xref">Section 4.6</a>) mechanisms must be turned off, while File Transfer Congestion Control (FileCC) (<a href="#fileCC" class="auto internal xref">Section 5.2</a>) must be enabled.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">When TSBPD is disabled, each packet gets timestamped with the time it is sent by the SRT sender. A packet being sent for the first time will have a timestamp different from that of a corresponding retransmitted packet. In contrast to the live streaming case, the timing of packets' delivery, when sending files, is not critical. The most important thing is data integrity. Therefore the TLPKTDROP mechanism must be disabled in this case. No data is allowed to be dropped, because this will result in corrupted files with missing data. The retransmission of missing packets has to happen until the packets are finally acknowledged by the SRT receiver.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">The File Transfer Congestion Control (FileCC) mechanism will take care of using the available link bandwidth for maximum transfer speed.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<div id="file-transmission-use-case-buffer">
<section id="section-7.2.1">
          <h4 id="name-file-transmission-in-buffer">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-file-transmission-in-buffer" class="section-name selfRef">File Transmission in Buffer Mode</a>
          </h4>
<p id="section-7.2.1-1">The original UDT protocol <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span> used buffer mode (<a href="#transmission-mode-buffer" class="auto internal xref">Section 4.2.2</a>) to send files, and the same is possible in SRT. This mode was designed to transmit one file per connection. For a single file transmission, a socket is opened, a file is transmitted, and then the socket is closed. This procedure is repeated for each subsequent single file, as the receiver cannot distinguish between two files in a continuous data stream.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">Buffer mode is not suitable for the transmission of many small files since for every file a new connection has to be established. To initiate a new connection, at least two round-trip times (RTTs) for the handshake exchange are required (<a href="#handshake-messages" class="auto internal xref">Section 4.3</a>).<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.2.1-3">It is also important to note that the SRT protocol does not add any information to the data being transmitted. The file name or any auxiliary information can be declared separately by the sending application, e.g., in the form of a Stream ID Extension Message (<a href="#sec-hsext-streamid" class="auto internal xref">Section 3.2.1.3</a>).<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="file-transmission-in-message-mode">
<section id="section-7.2.2">
          <h4 id="name-file-transmission-in-messag">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-file-transmission-in-messag" class="section-name selfRef">File Transmission in Message Mode</a>
          </h4>
<p id="section-7.2.2-1">If message mode (<a href="#transmission-mode-msg" class="auto internal xref">Section 4.2.1</a>) is used for the file transmission, the application should either segment the file into several messages, or use one message per file. The size of an individual message plays an important role on the receiving side since the size of the receiver buffer should be large enough to store at least a single message entirely.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">In the case of file transfer in message mode, the file name, segmentation rules, or any auxiliary information can be specified separately by both sending and receiving applications. The SRT protocol does not provide a specific way of doing this. It could be done by setting the file name, etc., in the very first message of a message sequence, followed by the file itself.<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2.2-3">When designing an application for SRT file transfer, it is also important to be aware of the delivery order of the received messages.
This can be set by the Order Flag as described in <a href="#data-pkt" class="auto internal xref">Section 3.1</a>.<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">SRT provides confidentiality of the payload using stream cipher and a pre-shared private key as
specified in <a href="#encryption" class="auto internal xref">Section 6</a>. The security can be compromised if the pre-shared passphrase
is known to the attacker.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">On the protocol control level, SRT does not encrypt packet headers.
Therefore it has some vulnerabilities similar to TCP <span>[<a href="#RFC6528" class="cite xref">RFC6528</a>]</span>:<a href="#section-8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-3.1">
          <p id="section-8-3.1.1">A peer tells a counterpart its public IP during the handshake that is visible to any attacker.<a href="#section-8-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.2">
          <p id="section-8-3.2.1">An attacker may potentially count the number of SRT processes behind a Network
Address Translator (NAT) by establishing multiple SRT connections and tracking
the ranges of SRT Socket IDs. If a random Socket ID is generated for the first
connection, subsequent connections may get consecutive SRT Socket IDs. Assuming
one system runs only one SRT process, for example, then an attacker can estimate
the number of systems behind a NAT.<a href="#section-8-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.3">
          <p id="section-8-3.3.1">Similarly, the possibility of attack depends on the implementation of the initial
sequence number (ISN) generation. If an ISN is not generated randomly for each
connection, an attacker may potentially count the number of systems behind a
Network Address Translator (NAT) by establishing a number of SRT connections and
identifying the number of different sequence number "spaces", given that no SRT
packet headers are encrypted.<a href="#section-8-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.4">
          <p id="section-8-3.4.1">An eavesdropper can hijack existing connections only if it steals the IP and
port of one of the parties. If some stream addresses an existing SRT receiver
by its SRT socket ID, IP, and port number, but arrives from a different IP or
port, the SRT receiver ignores it.<a href="#section-8-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.5">
          <p id="section-8-3.5.1">SRT has a certain protection from DoS attacks, see <a href="#handshake-messages" class="auto internal xref">Section 4.3</a>.<a href="#section-8-3.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-4">There are some important considerations regarding the encryption feature of SRT:<a href="#section-8-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-5.1">
          <p id="section-8-5.1.1">The SEK must be changed at an appropriate refresh interval to avoid the risk
associated with the use of security keys over a long period of time.<a href="#section-8-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-5.2">
          <p id="section-8-5.2.1">The shared secret for KEK generation must be carefully configured by a
security officer responsible for security policies, enforcing encryption, and
limiting key size selection.<a href="#section-8-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document makes no requests of the IANA.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-10">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-10-1">This specification is based on the SRT Protocol Technical Overview <span>[<a href="#SRTTO" class="cite xref">SRTTO</a>]</span>
written by Jean Dube and Steve Matthews.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">In alphabetical order, the contributors to the pre-IETF SRT project and
specification at Haivision are: Marc Cymontkowski, Roman Diouskine,
Jean Dube, Mikolaj Malecki, Steve Matthews, Maria Sharabayko,
Maxim Sharabayko, Adam Yellen.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">The contributors to this specification at SK Telecom
are Jeongseok Kim and Joonwoong Kim.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">It is worth acknowledging also the contribution
of the following people in this document: Justus Rogmann.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">We cannot list all the contributors to the open-sourced implementation of SRT on GitHub.
But we appreciate the help, contribution, integrations and feedback of the
SRT and SRT Alliance community.<a href="#section-10-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-11">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-11-1">The basis of the SRT protocol and its implementation was
the UDP-based Data Transfer Protocol <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span>.
The authors thank Yunhong Gu and Robert Grossman,
the authors of the UDP-based Data Transfer Protocol <span>[<a href="#GHG04b" class="cite xref">GHG04b</a>]</span>.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">TODO acknowledge.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="GHG04b">[GHG04b]</dt>
        <dd>
<span class="refAuthor">Gu, Y.</span>, <span class="refAuthor">Hong, X.</span>, and <span class="refAuthor">R. L. Grossman</span>, <span class="refTitle">"Experiences in Design and Implementation of a High Performance Transport Protocol"</span>, <span class="seriesInfo">DOI 10.1109/SC.2004.24</span>, <time datetime="2004-12" class="refDate">December 2004</time>, <span>&lt;<a href="https://doi.org/10.1109/SC.2004.24">https://doi.org/10.1109/SC.2004.24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc768">https://www.rfc-editor.org/rfc/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AES">[AES]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"FIPS Pub 197: Advanced Encryption Standard (AES)"</span>, <time datetime="2001-11" class="refDate">November 2001</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="AV1">[AV1]</dt>
        <dd>
<span class="refAuthor">Rivaz, P. de.</span> and <span class="refAuthor">J. Haughton</span>, <span class="refTitle">"AV1 Bitstream &amp; Decoding Process Specification"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://aomediacodec.github.io/av1-spec/av1-spec.pdf">https://aomediacodec.github.io/av1-spec/av1-spec.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BBR">[BBR]</dt>
        <dd>
<span class="refAuthor">Cardwell, N.</span>, <span class="refAuthor">Cheng, Y.</span>, <span class="refAuthor">Gunn, C. S.</span>, <span class="refAuthor">Yeganeh, S. H.</span>, and <span class="refAuthor">V. Jacobson</span>, <span class="refTitle">"BBR: Congestion-Based Congestion Control"</span>, <span class="seriesInfo">ACM Queue, vol. 14 </span>, <time datetime="2016-10" class="refDate">October 2016</time>. </dd>
<dd class="break"></dd>
<dt id="GuAnAO">[GuAnAO]</dt>
        <dd>
<span class="refAuthor">Gu, Y.</span>, <span class="refAuthor">Hong, X.</span>, and <span class="refAuthor">R. L. Grossman</span>, <span class="refTitle">"An Analysis of AIMD Algorithm with Decreasing Increases"</span>, <span class="seriesInfo">Proceedings of the 1st International Workshop on Networks for Grid Applications (GridNets ’04) </span>, <time datetime="2004-10" class="refDate">October 2004</time>. </dd>
<dd class="break"></dd>
<dt id="H.265">[H.265]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"H.265 : High efficiency video coding"</span>, <span class="seriesInfo">ITU-T Recommendation H.265</span>, <time datetime="2019" class="refDate">2019</time>. </dd>
<dd class="break"></dd>
<dt id="ISO13818-1">[ISO13818-1]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Information technology — Generic coding of moving pictures and associated audio information: Systems"</span>, <span class="seriesInfo">ISO/IEC 13818-1</span>, <time datetime="2023-12" class="refDate">December 2023</time>. </dd>
<dd class="break"></dd>
<dt id="ISO23009">[ISO23009]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Information technology - Dynamic adaptive streaming over HTTP (DASH)"</span>, <span class="seriesInfo">ISO/IEC 23009:2019</span>, <time datetime="2023-12" class="refDate">December 2023</time>. </dd>
<dd class="break"></dd>
<dt id="PNPID">[PNPID]</dt>
        <dd>
<span class="refTitle">"PNP ID AND ACPI ID REGISTRY"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://uefi.org/PNP_ACPI_Registry">https://uefi.org/PNP_ACPI_Registry</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2104">https://www.rfc-editor.org/rfc/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3031">[RFC3031]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span>, <span class="refAuthor">Viswanathan, A.</span>, and <span class="refAuthor">R. Callon</span>, <span class="refTitle">"Multiprotocol Label Switching Architecture"</span>, <span class="seriesInfo">RFC 3031</span>, <span class="seriesInfo">DOI 10.17487/RFC3031</span>, <time datetime="2001-01" class="refDate">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3031">https://www.rfc-editor.org/rfc/rfc3031</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3394">https://www.rfc-editor.org/rfc/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4987">[RFC4987]</dt>
        <dd>
<span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"TCP SYN Flooding Attacks and Common Mitigations"</span>, <span class="seriesInfo">RFC 4987</span>, <span class="seriesInfo">DOI 10.17487/RFC4987</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4987">https://www.rfc-editor.org/rfc/rfc4987</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6528">[RFC6528]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span> and <span class="refAuthor">S. Bellovin</span>, <span class="refTitle">"Defending against Sequence Number Attacks"</span>, <span class="seriesInfo">RFC 6528</span>, <span class="seriesInfo">DOI 10.17487/RFC6528</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6528">https://www.rfc-editor.org/rfc/rfc6528</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8018">[RFC8018]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #5: Password-Based Cryptography Specification Version 2.1"</span>, <span class="seriesInfo">RFC 8018</span>, <span class="seriesInfo">DOI 10.17487/RFC8018</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8018">https://www.rfc-editor.org/rfc/rfc8018</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8216">[RFC8216]</dt>
        <dd>
<span class="refAuthor">Pantos, R., Ed.</span> and <span class="refAuthor">W. May</span>, <span class="refTitle">"HTTP Live Streaming"</span>, <span class="seriesInfo">RFC 8216</span>, <span class="seriesInfo">DOI 10.17487/RFC8216</span>, <time datetime="2017-08" class="refDate">August 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8216">https://www.rfc-editor.org/rfc/rfc8216</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8312">[RFC8312]</dt>
        <dd>
<span class="refAuthor">Rhee, I.</span>, <span class="refAuthor">Xu, L.</span>, <span class="refAuthor">Ha, S.</span>, <span class="refAuthor">Zimmermann, A.</span>, <span class="refAuthor">Eggert, L.</span>, and <span class="refAuthor">R. Scheffenegger</span>, <span class="refTitle">"CUBIC for Fast Long-Distance Networks"</span>, <span class="seriesInfo">RFC 8312</span>, <span class="seriesInfo">DOI 10.17487/RFC8312</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8312">https://www.rfc-editor.org/rfc/rfc8312</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9114">[RFC9114]</dt>
        <dd>
<span class="refAuthor">Bishop, M., Ed.</span>, <span class="refTitle">"HTTP/3"</span>, <span class="seriesInfo">RFC 9114</span>, <span class="seriesInfo">DOI 10.17487/RFC9114</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9114">https://www.rfc-editor.org/rfc/rfc9114</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RTMP">[RTMP]</dt>
        <dd>
<span class="refTitle">"Real-Time Messaging Protocol"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://www.adobe.com/devnet/rtmp.html">https://www.adobe.com/devnet/rtmp.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-38A">[SP800-38A]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation"</span>, <time datetime="2001-12" class="refDate">December 2001</time>. </dd>
<dd class="break"></dd>
<dt id="SRTSRC">[SRTSRC]</dt>
        <dd>
<span class="refTitle">"SRT fully functional reference implementation"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://github.com/Haivision/srt">https://github.com/Haivision/srt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRTTO">[SRTTO]</dt>
        <dd>
<span class="refAuthor">Dube, J.</span> and <span class="refAuthor">S. Matthews</span>, <span class="refTitle">"SRT Protocol Technical Overview"</span>, <time datetime="2019-12" class="refDate">December 2019</time>. </dd>
<dd class="break"></dd>
<dt id="VP9">[VP9]</dt>
      <dd>
<span class="refAuthor">WebM</span>, <span class="refTitle">"VP9 Video Codec"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://www.webmproject.org/vp9">https://www.webmproject.org/vp9</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="packet-seq-list-coding">
<section id="appendix-A">
      <h2 id="name-packet-sequence-list-coding">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-packet-sequence-list-coding" class="section-name selfRef">Packet Sequence List Coding</a>
      </h2>
<p id="appendix-A-1">For any single packet sequence number,
it uses the original sequence number in the field. The first bit
MUST start with "0".<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<span id="name-single-sequence-numbers-cod"></span><div id="single-sequence-number">
<figure id="figure-22">
        <div class="alignLeft art-text artwork" id="appendix-A-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                   Sequence Number                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-single-sequence-numbers-cod" class="selfRef">Single sequence numbers coding</a>
        </figcaption></figure>
</div>
<p id="appendix-A-3">For any consecutive packet sequence numbers that the difference between
the last and first is more than 1, only record the first (a) and the
the last (b) sequence numbers in the list field, and modify the
the first bit of a to "1".<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<span id="name-range-of-sequence-numbers-c"></span><div id="list-sequence-numbers">
<figure id="figure-23">
        <div class="alignLeft art-text artwork" id="appendix-A-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|                   Sequence Number a (first)                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|                   Sequence Number b (last)                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-range-of-sequence-numbers-c" class="selfRef">Range of sequence numbers coding</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-srt-access-control">
<section id="appendix-B">
      <h2 id="name-srt-access-control">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-srt-access-control" class="section-name selfRef">SRT Access Control</a>
      </h2>
<p id="appendix-B-1">One type of information that can be interchanged when a connection is being established in SRT
is the Stream ID, which can be used in a caller-listener connection layout.
This is a string of maximum 512 characters set on the caller side.
It can be retrieved at the listener side on the newly accepted connection.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">SRT listener can notify an upstream application about the connection attempt when a HS conclusion arrives,
exposing the contents of the Stream ID extension message.
Based on this information, the application can accept or reject the connection,
select the desired data stream, or set an appropriate passphrase for the connection.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">The Stream ID value can be used as free-form, but there is a recommended convention so that
all SRT users speak the same language. The intent of the convention is to:<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-4.1">
          <p id="appendix-B-4.1.1">promote readability and consistency among free-form names,<a href="#appendix-B-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-4.2">
          <p id="appendix-B-4.2.1">interpret some typical data in the key-value style.<a href="#appendix-B-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="general-syntax">
<section id="appendix-B.1">
        <h3 id="name-general-syntax">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-general-syntax" class="section-name selfRef">General Syntax</a>
        </h3>
<p id="appendix-B.1-1">This recommended syntax starts with the characters known as an executable specification in POSIX: <code>#!</code>.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">The next character defines the format used for the following key-value pair syntax.
At the moment, there is only one supported syntax identified by <code>:</code> and described below.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-3">Everything that comes after a syntax identifier is further referenced as the content of the Stream ID.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<p id="appendix-B.1-4">The content starts with a <code>:</code> or <code>{</code> character identifying its format:<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="appendix-B.1-5">
          <dt id="appendix-B.1-5.1"><code>:</code></dt>
          <dd style="margin-left: 1.5em" id="appendix-B.1-5.2">
            <p id="appendix-B.1-5.2.1">comma-separated key-value pairs with no nesting,<a href="#appendix-B.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="appendix-B.1-5.3"><code>{</code></dt>
          <dd style="margin-left: 1.5em" id="appendix-B.1-5.4">
            <p id="appendix-B.1-5.4.1">a nested block with one or several key-value pairs that must end with a <code>}</code> character. Nesting means that multiple level brace-enclosed parts are allowed.<a href="#appendix-B.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="appendix-B.1-6">The form of the key-value pair is<a href="#appendix-B.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-7">
<pre>
key1=value1,key2=value2,...
</pre><a href="#appendix-B.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="standard-keys">
<section id="appendix-B.2">
        <h3 id="name-standard-keys">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-standard-keys" class="section-name selfRef">Standard Keys</a>
        </h3>
<p id="appendix-B.2-1">Beside the general syntax, there are several top-level keys treated as standard keys.
All single letter key definitions, including those not listed in this section, are reserved for future use.
Users can additionally use custom key definitions with user_* or companyname_* prefixes,
where user and companyname are to be replaced with an actual user or company name.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">The existing key values MUST NOT be extended, and MUST NOT differ from those described in this section.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2-3">The following keys are standard:<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-4.1">
            <p id="appendix-B.2-4.1.1">u: User Name, or authorization name, that is expected to control which password should be used for the connection.
The application should interpret it to distinguish which user should be used by the listener party to set up the password.<a href="#appendix-B.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-4.2">
            <p id="appendix-B.2-4.2.1">r: Resource Name identifies the name of the resource and facilitates selection should the listener party be able to serve multiple resources.<a href="#appendix-B.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-4.3">
            <p id="appendix-B.2-4.3.1">h: Host Name identifies the hostname of the resource. For example, to request a stream with the URI somehost.com/videos/querry.php?vid=366
the hostname field should have somehost.com, and the resource name can have videos/querry.php?vid=366 or simply 366.
Note that this is still a key to be specified explicitly. Support tools that apply simplifications and URI extraction
are expected to insert only the host portion of the URI here.<a href="#appendix-B.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-4.4">
            <p id="appendix-B.2-4.4.1">s: Session ID is a temporary resource identifier negotiated with the server, used just for verification.
This is a one-shot identifier, invalidated after the first use. The expected usage is when details for the resource
and authorization are negotiated over a separate connection first, and then the session ID is used here alone.<a href="#appendix-B.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-4.5">
            <p id="appendix-B.2-4.5.1">t: Type specifies the purpose of the connection. Several standard types are defined:<a href="#appendix-B.2-4.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-4.5.2.1">
                <p id="appendix-B.2-4.5.2.1.1">stream (default, if not specified): for exchanging the user-specified payload for an application-defined purpose,<a href="#appendix-B.2-4.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.2-4.5.2.2">
                <p id="appendix-B.2-4.5.2.2.1">file: for transmitting a file where r is the filename,<a href="#appendix-B.2-4.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.2-4.5.2.3">
                <p id="appendix-B.2-4.5.2.3.1">auth: for exchanging sensible data. The r value states its purpose. No specific possible values for that are known so far (for future use).<a href="#appendix-B.2-4.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-B.2-4.6">
            <p id="appendix-B.2-4.6.1">m: Mode expected for this connection:<a href="#appendix-B.2-4.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-4.6.2.1">
                <p id="appendix-B.2-4.6.2.1.1">request (default): the caller wants to receive the stream data,<a href="#appendix-B.2-4.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.2-4.6.2.2">
                <p id="appendix-B.2-4.6.2.2.1">publish: the caller wants to send the stream data,<a href="#appendix-B.2-4.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.2-4.6.2.3">
                <p id="appendix-B.2-4.6.2.3.1">bidirectional: bidirectional data exchange is expected.<a href="#appendix-B.2-4.6.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="appendix-B.2-5">Note that "m" is not required in the case where Stream ID is not used to distinguish authorization or resources,
and the caller is expected to send the data. This is only for cases where the listener can handle various purposes of the connection
and is therefore required to know what the caller is attempting to do.<a href="#appendix-B.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples">
<section id="appendix-B.3">
        <h3 id="name-examples">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
        </h3>
<p id="appendix-B.3-1">The example content of the Stream ID is the following:<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-2">
<pre>
#!::u=admin,r=bluesbrothers1_hi
</pre><a href="#appendix-B.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-3">It specifies the username and the resource name of the stream to be served to the caller.<a href="#appendix-B.3-3" class="pilcrow">¶</a></p>
<p id="appendix-B.3-4">The next example specifies that the file is expected to be transmitted from the caller to the listener and its name is results.csv:<a href="#appendix-B.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-5">
<pre>
#!::u=johnny,t=file,m=publish,r=results.csv
</pre><a href="#appendix-B.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="changelog">
<section id="appendix-C">
      <h2 id="name-changelog">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-changelog" class="section-name selfRef">Changelog</a>
      </h2>
<div id="since-draft-sharabayko-mops-srt-00">
<section id="appendix-C.1">
        <h3 id="name-since-draft-sharabayko-mops">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-since-draft-sharabayko-mops" class="section-name selfRef">Since draft-sharabayko-mops-srt-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1">
            <p id="appendix-C.1-1.1.1">Improved and extended the description of "Encryption" section.<a href="#appendix-C.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.2">
            <p id="appendix-C.1-1.2.1">Improved and extended the description of "Round-Trip Time Estimation" section.<a href="#appendix-C.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.3">
            <p id="appendix-C.1-1.3.1">Extended the description of "Handshake" section with "Stream ID Extension Message", "Group Membership Extension" subsections.<a href="#appendix-C.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.4">
            <p id="appendix-C.1-1.4.1">Extended "Handshake Messages" section with the detailed description of handshake procedure.<a href="#appendix-C.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.5">
            <p id="appendix-C.1-1.5.1">Improved "Key Material" section description.<a href="#appendix-C.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.6">
            <p id="appendix-C.1-1.6.1">Changed packet structure formatting for "Packet Structure" section.<a href="#appendix-C.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.7">
            <p id="appendix-C.1-1.7.1">Did minor additions to the "Acknowledgement and Lost Packet Handling" section.<a href="#appendix-C.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.8">
            <p id="appendix-C.1-1.8.1">Fixed broken links.<a href="#appendix-C.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.9">
            <p id="appendix-C.1-1.9.1">Extended the list of references.<a href="#appendix-C.1-1.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-sharabayko-mops-srt-01">
<section id="appendix-C.2">
        <h3 id="name-since-draft-sharabayko-mops-">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-since-draft-sharabayko-mops-" class="section-name selfRef">Since draft-sharabayko-mops-srt-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1">
            <p id="appendix-C.2-1.1.1">Extended "Congestion Control" section with the detailed description of SRT packet pacing for both live streaming and file transmission cases.<a href="#appendix-C.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.2">
            <p id="appendix-C.2-1.2.1">Improved "Group Membership Extension" section.<a href="#appendix-C.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.3">
            <p id="appendix-C.2-1.3.1">Reworked "Security Consideration" section.<a href="#appendix-C.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.4">
            <p id="appendix-C.2-1.4.1">Added missing control packets: Drop Request, Peer Error, Congestion Warning.<a href="#appendix-C.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.5">
            <p id="appendix-C.2-1.5.1">Improved "Data Transmission Modes" section as well as added "Best Practices and Configuration Tips for Data Transmission via SRT" section describing the use cases of live streaming and file transmission via SRT.<a href="#appendix-C.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.6">
            <p id="appendix-C.2-1.6.1">Changed the workgroup from "MOPS" to "Network Working Group".<a href="#appendix-C.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.7">
            <p id="appendix-C.2-1.7.1">Changed the intended status of the document from "Standards Track" to "Informational".<a href="#appendix-C.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.8">
            <p id="appendix-C.2-1.8.1">Overall corrections throughout the document: fixed lists, punctuation, etc.<a href="#appendix-C.2-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-sharabayko-srt-00">
<section id="appendix-C.3">
        <h3 id="name-since-draft-sharabayko-srt-">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-since-draft-sharabayko-srt-" class="section-name selfRef">Since draft-sharabayko-srt-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">
            <p id="appendix-C.3-1.1.1">Message Drop Request control packet: added note about possible zero-valued message number.<a href="#appendix-C.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.2">
            <p id="appendix-C.3-1.2.1">Corrected an error in the formula for NAKInterval: changed min to max.<a href="#appendix-C.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.3">
            <p id="appendix-C.3-1.3.1">Added a note in "Best Practices and Configuration Tips for Data Transmission via SRT" section that Periodic NAK reports must be enabled in the case of live streaming.<a href="#appendix-C.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.4">
            <p id="appendix-C.3-1.4.1">Introduced the value of TLPKTDROP_THRESHOLD for Too-Late Packet Drop mechanism.<a href="#appendix-C.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.5">
            <p id="appendix-C.3-1.5.1">Improved the description of general syntax for SRT Access Control.<a href="#appendix-C.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.6">
            <p id="appendix-C.3-1.6.1">Updated the list of contributors.<a href="#appendix-C.3-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.7">
            <p id="appendix-C.3-1.7.1">Overall corrections throughout the document.<a href="#appendix-C.3-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-sharabayko-srt-01">
<section id="appendix-C.4">
        <h3 id="name-since-draft-sharabayko-srt-0">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-since-draft-sharabayko-srt-0" class="section-name selfRef">Since draft-sharabayko-srt-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.4-1.1">
            <p id="appendix-C.4-1.1.1">Improved the cookie contest description in the Rendezvous connection mode.<a href="#appendix-C.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.2">
            <p id="appendix-C.4-1.2.1">Described the key material negotiation error during the handshake.<a href="#appendix-C.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.3">
            <p id="appendix-C.4-1.3.1">Added AES-GCM mode to the key material message (SRT v1.6.0).<a href="#appendix-C.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.4">
            <p id="appendix-C.4-1.4.1">Improved handshake negotiation description.<a href="#appendix-C.4-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Maxim Sharabayko</span></div>
<div dir="auto" class="left"><span class="org">Haivision Network Video, GmbH</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:maxsharabayko@haivision.com" class="email">maxsharabayko@haivision.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Maria Sharabayko</span></div>
<div dir="auto" class="left"><span class="org">Haivision Network Video, GmbH</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:msharabayko@haivision.com" class="email">msharabayko@haivision.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jean Dube</span></div>
<div dir="auto" class="left"><span class="org">Haivision Systems, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jdube@haivision.com" class="email">jdube@haivision.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeongseok Kim</span></div>
<div dir="auto" class="left"><span class="org">SK Telecom Co., Ltd.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jeongseok.kim@sk.com" class="email">jeongseok.kim@sk.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Joonwoong Kim</span></div>
<div dir="auto" class="left"><span class="org">SK Telecom Co., Ltd.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:joonwoong.kim@sk.com" class="email">joonwoong.kim@sk.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
